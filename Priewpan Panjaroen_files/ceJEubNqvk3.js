/*!CK:2725286332!*//*1412893371,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["N1FoK"]); }

__d("PUWErrorCodes",[],function(a,b,c,d,e,f){e.exports={BAD_JPEG:9901,WORKER_TERMINATED:9902,UNKNOWN_RESIZE_ERROR:9903,WORKER_ABORT:9904};},null);
__d("StickerAssetType",[],function(a,b,c,d,e,f){e.exports={IMAGE:"BestEffortImage",SPRITE:"SpriteImage",PADDED_SPRITE:"PaddedSpriteImage"};},null);
__d("TypingDetector",["ArbiterMixin","Event","Input","Run","TypingStates","copyProperties","createObjectFrom","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(p,q){this._input=p;this._ignoreKeys={};this._getValueFn=q;}l(o.prototype,g,{_timeout:7000,_currentState:k.INACTIVE,init:function(){this.init=n;this.reset();h.listen(this._input,'keyup',this._update.bind(this));j.onUnload(this._onunload.bind(this));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=k.INACTIVE;},setIgnoreKeys:function(p){this._ignoreKeys=m(p);},_onunload:function(){if(this._currentState==k.TYPING)this._transition(k.QUITTING);},_update:function(event){var p=h.getKeyCode(event),q=this._currentState;if(!this._ignoreKeys[p]){var r=this._getValueFn?this._getValueFn():i.getValue(this._input);if(r.trim().length===0){if(q==k.TYPING)this._transition(k.INACTIVE);}else if(q==k.TYPING){this._recordKeystroke();}else if(q==k.INACTIVE){this._transition(k.TYPING);this._recordKeystroke();}}},_transition:function(p){this.reset();this._currentState=p;this.inform('change',p);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=setTimeout(this._checkTyping.bind(this),this._timeout);},_checkTyping:function(){var p=this._lastKeystrokeTime+this._timeout,q=Date.now();if(q>p){this._transition(k.INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=setTimeout(this._checkTyping.bind(this),p-q+10);}}});e.exports=o;},null);
__d("TypingDetectorController",["AsyncRequest","AvailableList","AvailableListConstants","ChannelConnection","ChatVisibility","Keys","PresencePrivacy","ShortProfiles","TypingDetector","TypingStates","copyProperties","emptyFunction","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(w){if(!k.isOnline())return false;if(w){var x=n.getNow(w);return x&&x.type=="friend"&&m.allows(w);}return true;}function v(w,x,y,z,aa,ba){"use strict";this.userID=w;this.input=x;this.source=y;this.threadID=aa;this.remoteState=p.INACTIVE;this.notifyTimer=null;z=z||{};this.notifyDelay=z.notifyDelay||this.notifyDelay;this._typingDetector=new o(x,ba);this._typingDetector.init(z);this._typingDetector.subscribe('change',this._stateChange.bind(this));}v.prototype.setUserAndThread=function(w,x){"use strict";if(this.userID!==w||this.threadID!==x){this.resetState();this.userID=w;this.threadID=x;}};v.prototype.setIgnoreEnter=function(w){"use strict";var x=w?[l.RETURN]:[];this._typingDetector.setIgnoreKeys(x);};v.prototype.resetState=function(){"use strict";this._notifyState(p.INACTIVE);this.remoteState=p.INACTIVE;this._typingDetector.reset();clearTimeout(this.notifyTimer);this.notifyTimer=null;};v.prototype._stateChange=function(w,x){"use strict";if(x!=p.QUITTING){clearTimeout(this.notifyTimer);this.notifyTimer=s(t(this._notifyState,this,x),this.notifyDelay);}else this._notifyState(x,true);};v.prototype._notifyState=function(w,x){"use strict";if(!this.userID&&!this.threadID)return;var y=this.userID,z=u(y);if(z&&w!=this.remoteState){this.remoteState=w;if(j.disconnected())return;var aa={typ:w,to:y,source:this.source,thread:this.threadID};new g().setHandler(this._onTypResponse.bind(this,y)).setErrorHandler(r).setData(aa).setURI('/ajax/messaging/typ.php').setAllowCrossPageTransition(true).setOption('asynchronous',!x).send();}};v.prototype._onTypResponse=function(w,x){"use strict";var y=x.getPayload()||{};if(y.offline)h.set(w,i.OFFLINE,'typing_response');};q(v.prototype,{notifyDelay:1000});e.exports=v;},null);
__d("VideoCallingTour",["Arbiter","ArbiterMixin","Chat","ChatSidebar","ChatVisibility","CSS","DOM","PresencePrivacy","Run","Toggler","Vector","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w=[],x=function(){};function y(){if(j.isVisible()){z();}else if(u)aa();}function z(){s.setContext(t.getBody());ba();s.show();ca();}function aa(){if(!v)v=p.createInstance(u.getRoot());var fa=m.scry(u.getRoot(),'div.fbNubFlyout')[0];if(fa){s.setContext(fa);ba();s.show();ca();}}function ba(){var fa=q.getElementDimensions(s.getContext()).y;s.setOffsetY(fa*.6);s.updatePosition();}function ca(){if(u)w.push(u.subscribe('hide',function(){da();if(!j.isVisible())s.hide();}),u.subscribe('show',function(){s.show();}),u.subscribe('resize',function(){ba();s.updatePosition();}));w.push(g.subscribe('sidebar/show',z),g.subscribe('sidebar/hide',aa),g.subscribe('sidebar/resized',ba));}function da(){if(v){v.setSticky(false);v=null;}}function ea(){while(w.length)w.pop().unsubscribe();if(u)da();s.hide();l.show('fbVideoCallingGetStarted');}r(x,h,{start:function(fa){s=fa;l.hide('fbVideoCallingGetStarted');k.goOnline(function(){w.push(n.subscribe('privacy-user-presence-changed',ea));o.onLeave(ea);i.openBuddyList();var ga=null;w.push(j.subscribe('sidebar/initialized',function(ha,ia){t=ia;clearTimeout(ga);ga=setTimeout(y,0);}),x.subscribe('videocallingtour/end',ea));w.push(g.subscribe('buddylist-nub/initialized',function(ha,ia){u=ia;clearTimeout(ga);ga=setTimeout(y,0);}));});x.inform('videocallingtour/start');}});e.exports=x;},null);
__d("ContentRollTypeaheadView.react",["BackgroundImage.react","ImageBlock.react","LegacyScrollableArea.react","React","TypeaheadViewItem","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=j.createClass({displayName:'ContentRollTypeaheadViewItem',mixins:[k.Mixin],propTypes:k.propTypes,render:function(){var p=this.props.entry,q=p.getSubtitle()?j.createElement(j.DOM.div,{className:"_599q"},p.getSubtitle()):null;if(q&&p.getAuxiliaryData()&&p.getAuxiliaryData().icon)q=j.createElement(h,{spacing:"small"},j.createElement(g,{width:16,height:16,src:p.getAuxiliaryData().icon}),q);var r=p.getPhoto()?j.createElement(g,{width:32,height:32,backgroundSize:"cover",src:p.getPhoto()}):j.createElement(j.DOM.span,null),s=(("_5yww")+(!q?' '+"_5mne":'')+(this.props.highlighted?' '+"_599n":''));return (j.createElement(j.DOM.li,{className:s,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight},j.createElement(h,{spacing:"medium"},r,j.createElement(j.DOM.div,null,j.createElement(j.DOM.div,{className:"_599p"},p.getTitle()),q))));}}),o=j.createClass({displayName:'ContentRollTypeaheadView',propTypes:{highlightedEntry:j.PropTypes.object,entries:j.PropTypes.array.isRequired,onSelect:j.PropTypes.func.isRequired,onHighlight:j.PropTypes.func,onRenderHighlight:j.PropTypes.func,scrollableAreaHeight:j.PropTypes.number.isRequired,scrollableAreaWidth:j.PropTypes.number.isRequired},_renderItem:function(p){var q=p===this.props.highlightedEntry;return (j.createElement(n,{key:p.getUniqueID(),entry:p,highlighted:q,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight}));},render:function(){var p=(("_2072")+(!this.props.entries.length?' '+"_599s":'')),q=this.props.entries,r={};q.forEach(function(v){r[v.getType()]=r[v.getType()]||[];r[v.getType()].push(v);});var s=[];for(var t in r){var u=null;switch(t){case 'recent':u="Recently Viewed Links";break;case 'saved':u="Saved Links";break;case 'bing':u="Bing Results";break;}if(u)s.push(j.createElement(j.DOM.div,{className:"_1opo"},u));r[t].forEach(function(v){s.push(this._renderItem(v));},this);}return (j.createElement(j.DOM.div,{className:p},j.createElement(i,{height:this.props.scrollableAreaHeight,width:this.props.scrollableAreaWidth},j.createElement(j.DOM.ul,null,s))));}});e.exports=o;},null);
__d("ContentRollTypeahead.react",["AbstractTypeahead.react","React","ReactPropTypes","WebAsyncSearchSource","ContentRollTypeaheadView.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=20,o='/ajax/metacomposer/attachment/og/typeahead/content_roll',p=h.createClass({displayName:'ContentRollTypeahead',propTypes:{className:i.string,onSelection:i.func.isRequired,scrollableAreaHeight:h.PropTypes.number.isRequired,scrollableAreaWidth:h.PropTypes.number.isRequired,userID:i.string.isRequired,useLayer:i.bool},getInitialState:function(){return {query:''};},_handleChange:function(event){this.setState({query:event.target.value});},_handleSelectAttempt:function(q){this.setState({query:''});var r={object_id:q.getUniqueID(),url:q.getURI(),source:q.getType(),query:q.getAuxiliaryData().query,subindex:q.getAuxiliaryData().subindex,subtotal:q.getAuxiliaryData().subtotal,index:q.getAuxiliaryData().index,total:q.getAuxiliaryData().total};this.props.onSelection(r);},_getSearchSource:function(){if(!this._searchSource)this._searchSource=new j({bootstrapRequests:[{uri:o,data:{viewer:this.props.userID}}],queryRequests:[{uri:o,data:{viewer:this.props.userID}}],getAllForEmptyQuery:true});return this._searchSource;},_getPlaceholder:function(){if(!this._placeholder)this._placeholder="Search for articles, videos, music, and more";return this._placeholder;},focusInput:function(){this.refs.typeahead.focusInput();},render:function(){var q={ViewRenderer:k,maxEntries:n,useLayer:this.props.useLayer,extraRendererProps:{scrollableAreaHeight:this.props.scrollableAreaHeight,scrollableAreaWidth:this.props.scrollableAreaWidth}};return (h.createElement(g,{autoHighlight:true,className:this.props.className,focusedOnInit:true,inputClassName:"_55r1",onChange:this._handleChange,onSelectAttempt:this._handleSelectAttempt,placeholder:this._getPlaceholder(),presenter:q,queryString:this.state.query,ref:"typeahead",searchSource:this._getSearchSource(),showEntriesOnFocus:true}));}});e.exports=p;},null);
__d("ContentRollFlyout.react",["ContentRollTypeahead.react","Parent","React","ReactPropTypes","Toggler","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.createClass({displayName:'ContentRollFlyout',propTypes:{onSelection:j.func.isRequired,userID:j.string.isRequired},getInitialState:function(){return {showFlyout:false};},componentDidMount:function(){var n=this._getParentToggler();if(n)k.listen('show',n,function(){this.setState({showFlyout:true});}.bind(this));},_getParentToggler:function(){return h.byClass(this.getDOMNode(),'uiToggle');},_hideParentToggler:function(){var n=this._getParentToggler();if(n)k.hide(n);},_handleSelection:function(n){this._hideParentToggler();this.props.onSelection(n);},render:function(){if(!this.state.showFlyout)return i.createElement(i.DOM.div,null);return (i.createElement(g,{className:"_5j11",onSelection:this._handleSelection,scrollableAreaHeight:288,scrollableAreaWidth:256,userID:this.props.userID,useLayer:false}));}});e.exports=m;},null);
__d("CroppedImage.react",["Image.react","React","ReactPropTypes","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'CroppedImage',propTypes:{center:i.shape({x:i.number.isRequired,y:i.number.isRequired}),crop:i.shape({height:i.number.isRequired,width:i.number.isRequired}).isRequired,size:i.shape({height:i.number.isRequired,width:i.number.isRequired}).isRequired,src:i.string.isRequired},getDefaultProps:function(){return {center:{x:.5,y:.5}};},_calculateMargin:function(l,m,n){return -1*Math.max(Math.min(((n*m)-(.5*l)),m-l),0);},render:function(){var l=this._calculateMargin(this.props.crop.width,this.props.size.width,this.props.center.x),m=this._calculateMargin(this.props.crop.height,this.props.size.height,this.props.center.y),n={left:l,height:this.props.size.height,top:m,width:this.props.size.width};return (h.createElement(h.DOM.div,{className:"_46-h",style:this.props.crop},h.createElement(g,{alt:this.props.alt||'',className:"_46-i",src:this.props.src,style:n})));}});e.exports=k;},null);
__d("getURLRanges",["URI","URLScraper"],function(a,b,c,d,e,f,g,h){"use strict";function i(j,k){k=k||0;var l=h.match(j);if(!l)return [];var m=l;if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(l)))m='http://'+l;if(!g.isValidURI(m))return [];k+=j.indexOf(l);var n=l.length,o=[{offset:k,length:l.length,entity:{url:m}}];return o.concat(i(j.substr(k+n),k+n));}e.exports=i;},null);
__d("MercuryMessageBody.react",["React","Link.react","TextWithEntities.react","ReactComponentWithPureRenderMixin","cx","fbt","getURLRanges"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=g.createClass({displayName:'MercuryMessageBody',mixins:[j],propTypes:{body:g.PropTypes.string},render:function(){var o=this.props.body||'';if(o.startsWith('?OTR'))return (g.createElement(g.DOM.span,{className:"_89h"},"[\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e17\u0e35\u0e48\u0e40\u0e02\u0e49\u0e32\u0e23\u0e2b\u0e31\u0e2a]"));o=o.replace(/\s+$/,'');if(o.length===0)return null;return (g.createElement(i,{interpolator:this._getInterpolator(),text:o,ranges:m(o),renderEmoticons:true,renderEmoji:true}));},_getInterpolator:function(){return function(o,p){return (g.createElement(h,{target:"_blank",href:p.entity},o));};}});e.exports=n;},null);
__d("MercuryAudioPlayer",["Event","Arbiter","DOM","Flash","UserAgent_DEPRECATED","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=200;function n(){if(k.webkit()&&!k.chrome())return false;var w=i.create('audio'),x=false;try{if(!!w.canPlayType)if(w.canPlayType('video/mp4;').replace(/^no$/,''))x=true;}finally{return x;}}function o(){return j.isAvailable();}var p=function(){this.interval=null;this.arbiterInstance=null;this.audio=i.create('audio');g.listen(this.audio,'playing',function(){this.informAttachment('playing',this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment('playing',this.audio.currentTime);}.bind(this),m);}.bind(this));g.listen(this.audio,'ended',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(p.prototype,{setAudio:function(w,x){this.audio.setAttribute('src',w);this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.audio.play();this.informAttachment('played');},resume:function(){this.audio.play();this.informAttachment('played');},pause:function(){this.audio.pause();clearInterval(this.interval);this.informAttachment('paused');},getType:function(){return 'html5';}});var q=function(){this.src=null;this.arbiterInstance=null;var w=i.create('div');document.body.appendChild(w);this.swf=j.embed('/swf/SoundStreamPlayer.swf',w,null,{});this.interval=null;h.subscribe('soundstream/finished',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(q.prototype,{setAudio:function(w,x){this.src=w;this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.swf.playSound(this.src);this.interval=setInterval(function(){var w=this.swf.getCurrentTime();this.informAttachment('playing',w);}.bind(this),m);this.informAttachment('played');},resume:function(){this.swf.resume();this.informAttachment('played');},pause:function(){clearInterval(this.interval);this.swf.pause();this.informAttachment('paused');},getType:function(){return 'flash';}});function r(){if(n()){return new p();}else if(o())return new q();return false;}var s=null,t=null,u=0;function v(w,x){this.src=w;this.arbiterInstance=x;this.audio_id=++u;s!==null||(s=r());if(!s)return false;}l(v.prototype,{getType:function(){if(!s){return false;}else return s.getType();},play:function(w){if(w&&t==this.audio_id){s.resume();}else{this.pause();t=this.audio_id;s.setAudio(this.src,this.arbiterInstance);s.play();}},pause:function(){s.pause();}});e.exports=v;},null);
__d("MercuryAttachmentAudioClip.react",["Arbiter","ArbiterMixin","MercuryAudioPlayer","CurrentUser","JSLogger","LeftRight.react","React","cx","shield","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q='MercuryAttachmentAudioClip/play',r=k.create('mercury_audio_clip'),s=m.createClass({displayName:'AudioClip',mixins:[h],getInitialState:function(){this.subscribe('playing',this.updateTime);this.subscribe('played',o(this.setState,this,{playing:true,started:true}));this.subscribe('paused',o(this.setState,this,{playing:false}));this.subscribe('finished',o(this.setState,this,{playing:false,started:false,time:this.props.duration}));this.logged=false;var t=this.props.downloadOnly?false:new i(this.props.src,this);g.subscribe(q,function(u,v){if(this.props.src!=v)this.setState({time:0});}.bind(this));return {time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:t};},updateTime:function(t,u){this.setState({time:u});},play:function(){if(this.state.playing){this.state.audioPlayer.pause();}else{this.state.audioPlayer.play(this.state.started);g.inform(q,this.props.src);if(!this.logged){this.logged=true;r.log('play',{uid:j.getID(),duration:this.props.duration});}}},_formatSeconds:function(t){if(t){t=Math.ceil(t);var u=t%60;if(u<10)u='0'+u;var v=Math.floor(t/60);return v+':'+u;}else return null;},_renderPlayer:function(t,u){return (m.createElement(m.DOM.a,{className:"_1miz",href:"#",style:{width:t},onClick:this.play},m.createElement(m.DOM.span,{className:"_1mi-"},m.createElement(m.DOM.i,{className:"_1mi_"})),m.createElement(m.DOM.span,{className:"_1mj0"},u),m.createElement(m.DOM.div,{className:"_1mj1"})));},render:function(){var t=this.state.time,u=this.state.playing,v=this._formatSeconds(this.state.duration),w=this.props.width||170,x=null,y=Math.ceil((t*(w+2))/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var z=this._renderPlayer(w,v),aa=this._renderPlayer(w,v),ba=(("_1mj2")+(u&&(t!==0)?' '+"_1mj3":'')+(u&&(t===0)?' '+"_4g4x":''));x=(m.createElement(m.DOM.div,{className:ba},z,m.createElement(m.DOM.div,{className:"_1mj4",style:{width:y}},aa)));}else x=(m.createElement(m.DOM.div,{className:"_1mj2"},m.createElement(m.DOM.div,{className:"_1miz"},m.createElement(l,null,m.createElement(m.DOM.a,{className:"_1mj5",href:this.props.src},m.createElement(m.DOM.span,{className:"_3qi6"},m.createElement(m.DOM.i,{className:"_1mj6"})),m.createElement(m.DOM.span,{className:"_1mj7"},"\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e40\u0e2a\u0e35\u0e22\u0e07"),m.createElement(m.DOM.span,{className:"_1mj8"},v)),m.createElement(m.DOM.a,{href:this.props.src,className:"_1mj9"},m.createElement(m.DOM.i,{className:"_1mja"}))))));return (m.createElement(m.DOM.div,{className:"_1mjb"},x));}});e.exports=s;},null);
__d("XMessagingVideoAttachmentControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/mercury\/attachments\/video\/",{video_id:{type:"Int",required:true},window_width:{type:"Int",required:true}});},null);
__d("MercuryAttachmentVideo.react",["CroppedImage.react","Image.react","React","ReactPropTypes","XMessagingVideoAttachmentControllerURIBuilder","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=i.createClass({displayName:'MercuryAttachmentVideo',propTypes:{duration:j.number.isRequired,name:j.string.isRequired,size:j.shape({height:j.number,width:j.number}),thumbnailSize:j.shape({height:j.number,width:j.number}),thumbnail:j.string,videoID:j.string},_formatDuration:function(){var o=this.props.duration,p=Math.floor(o/60),q=o%60;if(q<10)return p+':0'+q;return p+':'+q;},render:function(){var o=!!this.props.thumbnail,p=(("_zow")+(' '+"_59go")+(!o?' '+"_59gq":'')),q=((!o?"_3l6h":'')+(!o?' '+"uiIconText":'')),r=new k().setInt('video_id',this.props.videoID).setInt('window_width',document.body.clientWidth).getURI();if(this.props.thumbnail)return (i.createElement(i.DOM.div,{className:p,style:this.props.size},i.createElement(i.DOM.a,{className:q,href:r,role:"button",rel:"async"},i.createElement(g,{crop:this.props.size,size:this.props.thumbnailSize,src:this.props.thumbnail}),i.createElement(i.DOM.div,{className:"_zox"}),i.createElement(i.DOM.div,{className:"_zoy"},i.createElement(h,{src:m('/images/chat/chat_play_icon.png')})),i.createElement(i.DOM.span,{className:"_zoz"},this._formatDuration()))));return (i.createElement(i.DOM.div,{className:p},i.createElement(i.DOM.a,{className:q,href:r,role:"button",rel:"async"},i.createElement(h,{src:m('/images/icons/video.gif')}),i.createElement(i.DOM.span,{className:"_59gp"},this.props.name))));}});e.exports=n;},null);
__d("XUIAmbientNUX.react",["HasLayerContextMixin","React","ReactLayer","ReactAbstractContextualDialog","XUIAmbientNUXTheme","XUICloseButton.react","XUIContextualDialogBody.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.PropTypes,p=300,q=380,r=i.createClass(j.createSpec({displayName:'XUIAmbientNUX',theme:k})),s=h.createClass({displayName:'XUIAmbientNUX',mixins:[g],propTypes:{alignment:o.oneOf(['left','center','right']),behaviors:o.object,context:o.object,contextRef:o.string,customwidth:o.number,offsetX:o.number,offsetY:o.number,onCloseButtonClick:o.func,position:o.oneOf(['above','below','left','right']),shown:o.bool,width:o.oneOf(['wide','normal','auto','custom'])},_getWidth:function(){switch(this.props.width){case 'wide':return q;case 'custom':return this.props.customwidth;case 'auto':return null;default:return p;}},render:function(){return (h.createElement(r,{alignment:this.props.alignment,autoFocus:false,behaviors:this.props.behaviors,context:this.getContextNode(),focusContextOnHide:false,offsetX:this.props.offsetX,offsetY:this.props.offsetY,position:this.props.position,shown:this.props.shown,width:this._getWidth(this.props)},h.createElement(h.DOM.div,{className:"_53iv"},h.createElement(m,null,h.createElement(l,{shade:"light",className:"_36gl",onClick:this.props.onCloseButtonClick}),h.createElement(h.DOM.div,{className:"_36gn"},this.props.children)))));}});e.exports=s;},null);
__d("updatePhotoProgressBar",[],function(a,b,c,d,e,f){'use strict';function g(h,event){if(event.loaded!=event.total){h.setPosition(50*event.loaded/event.total);}else{h.setPosition(50);h.setTarget(100,2000);}}e.exports=g;},null);
__d("DataViewPolyfill",["copyProperties"],function(a,b,c,d,e,f,g){"use strict";function h(i,j,k){if(j===undefined){this._ba=new Uint8Array(i);}else if(k===undefined){this._ba=new Uint8Array(i,j);}else this._ba=new Uint8Array(i,j,k);this.byteLength=this._ba.byteLength;}g(h,{isSupported:function(){return !!a.Uint8Array;}});g(h.prototype,{getUint8:function(i){if(i>=this._ba.length)throw new Error('Trying to read beyond bounds of DataViewPolyfill');return this._ba[i];},getUint16:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1);return j?(l*256)+k:(k*256)+l;},getUint32:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1),m=this.getUint8(i+2),n=this.getUint8(i+3);return j?(((n*256+m)*256+l)*256)+k:(((k*256+l)*256+m)*256)+n;}});e.exports=h;},null);
__d("Emscripten",[],function(a,b,c,d,e,f){e.exports={isSupported:function(){return (typeof Int32Array!=='undefined'&&typeof Float64Array!=='undefined'&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set);}};},null);
__d("XHRHttpError",[],function(a,b,c,d,e,f){var g='HTTP_CLIENT_ERROR',h='HTTP_PROXY_ERROR',i='HTTP_SERVER_ERROR',j='HTTP_TRANSPORT_ERROR',k='HTTP_UNKNOWN_ERROR';function l(m,n){if(n===0){var o=m.getProtocol();if(o==='file'||o==='ftp')return null;return j;}else if(n>=100&&n<200){return h;}else if(n>=200&&n<300){return null;}else if(n>=400&&n<500){return g;}else if(n>=500&&n<600){return i;}else if(n>=12001&&n<12156){return j;}else return k;}e.exports={getErrorCode:l,HTTP_CLIENT_ERROR:g,HTTP_PROXY_ERROR:h,HTTP_SERVER_ERROR:i,HTTP_TRANSPORT_ERROR:j,HTTP_UNKNOWN_ERROR:k};},null);
__d("xhrSimpleDataSerializer",[],function(a,b,c,d,e,f){function g(h){var i=[],j;for(j in h)i.push(encodeURIComponent(j)+'='+encodeURIComponent(h[j]));return i.join('&');}e.exports=g;},null);
__d("XHRRequest",["ErrorUtils","URI","XHRHttpError","getSameOriginTransport","invariant","xhrSimpleDataSerializer"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={errorCode:null,errorMsg:null,errorType:null},n={loadedBytes:null,totalBytes:null};function o(p){"use strict";this.setURI(p);this.setMethod('POST');this.setIsAsynchronous(true);this.setTransportBuilder(j);this.setDataSerializer(l);this.$XHRRequest0=this.$XHRRequest0.bind(this);}o.prototype.setURI=function(p){"use strict";this.$XHRRequest1=new h(p);return this;};o.prototype.getURI=function(){"use strict";return this.$XHRRequest1;};o.prototype.setMethod=function(p){"use strict";this.$XHRRequest2=p;return this;};o.prototype.getMethod=function(){"use strict";return this.$XHRRequest2;};o.prototype.setData=function(p){"use strict";this.$XHRRequest3=p;return this;};o.prototype.getData=function(){"use strict";return this.$XHRRequest3;};o.prototype.setRawData=function(p){"use strict";this.$XHRRequest4=p;return this;};o.prototype.setRequestHeaderField=function(p,q){"use strict";if(!this.$XHRRequest5)this.$XHRRequest5={};this.$XHRRequest5[p]=q;return this;};o.prototype.setTimeout=function(p){"use strict";this.$XHRRequest6=p;return this;};o.prototype.setResponseHandler=function(p){"use strict";this.$XHRRequest7=p;return this;};o.prototype.setErrorHandler=function(p){"use strict";this.$XHRRequest8=p;return this;};o.prototype.setAbortHandler=function(p){"use strict";this.$XHRRequest9=p;return this;};o.prototype.setTimeoutHandler=function(p){"use strict";this.$XHRRequesta=p;return this;};o.prototype.setUploadProgressHandler=function(p){"use strict";this.$XHRRequestb=p;return this;};o.prototype.setIsAsynchronous=function(p){"use strict";this.$XHRRequestc=p;return this;};o.prototype.setTransportBuilder=function(p){"use strict";this.$XHRRequestd=p;return this;};o.prototype.setDataSerializer=function(p){"use strict";this.$XHRRequeste=p;return this;};o.prototype.send=function(){"use strict";var p=this.$XHRRequest6,q=this.$XHRRequestd(),r=this.getURI();this.$XHRRequestf=q;var s;k(this.$XHRRequest2==='POST'||!this.$XHRRequest4);if(this.$XHRRequest2==='GET'||this.$XHRRequest4){r.addQueryData(this.$XHRRequest3);s=this.$XHRRequest4;}else s=this.$XHRRequeste(this.$XHRRequest3);q.onreadystatechange=this.$XHRRequest0;if(q.upload&&this.$XHRRequestb)q.upload.onprogress=this.$XHRRequestg.bind(this);if(p)this.$XHRRequesth=setTimeout(this.$XHRRequesti.bind(this),p);q.open(this.$XHRRequest2,r.toString(),this.$XHRRequestc);if(this.$XHRRequest5)for(var t in this.$XHRRequest5)q.setRequestHeader(t,this.$XHRRequest5[t]);q.send(s);if(!this.$XHRRequestc)q.onreadystatechange(null,true);};o.prototype.abort=function(){"use strict";this.$XHRRequestj();if(this.$XHRRequest9)g.applyWithGuard(this.$XHRRequest9,null,null,null,'XHRRequest:_abortHandler');};o.prototype.$XHRRequestj=function(){"use strict";var p=this.$XHRRequestf;if(p){p.onreadystatechange=null;p.abort();}this.$XHRRequestk();};o.prototype.$XHRRequesti=function(){"use strict";this.$XHRRequestj();if(this.$XHRRequesta)g.applyWithGuard(this.$XHRRequesta,null,null,null,'XHRRequest:_abortHandler');};o.prototype.$XHRRequest0=function(p,q){"use strict";if(!this.$XHRRequestc&&q!==true)return;var r=this.$XHRRequestf,s=r,t=s.readyState;if(t>=2){var u=t===4,v=this.getURI(),w=i.getErrorCode(v,r.status),x=this.$XHRRequest7;if(w!==null){if(u){m.errorCode=w;m.errorMsg=r.responseText;m.errorType='HTTP';if(this.$XHRRequest8)g.applyWithGuard(this.$XHRRequest8,null,[m],null,'XHRRequest:_errorHandler');}}else if(x){var y=null;if(x.includeHeaders)y=r.getAllResponseHeaders();if(u||(x.parseStreaming&&t===3))g.applyWithGuard(x,null,[r.responseText,y,u],null,'XHRRequest:handler');}if(u)this.$XHRRequestk();}};o.prototype.$XHRRequestg=function(p){"use strict";n.loadedBytes=p.loaded;n.totalBytes=p.total;if(this.$XHRRequestb)g.applyWithGuard(this.$XHRRequestb,null,[n],null,'XHRRequest:_uploadProgressHandler');};o.prototype.$XHRRequestk=function(){"use strict";clearTimeout(this.$XHRRequesth);delete this.$XHRRequestf;};e.exports=o;},null);
__d("getCrossOriginTransport",["ex","invariant"],function(a,b,c,d,e,f,g,h){function i(){try{var k=new XMLHttpRequest();if(!('withCredentials' in k)&&typeof XDomainRequest!=='undefined')k=new XDomainRequest();return k;}catch(j){throw new Error(g('getCrossOriginTransport: %s',j.message));}}i.withCredentials=function(){var j=i();h('withCredentials' in j);var k=j.open;j.open=function(){k.apply(this,arguments);this.withCredentials=true;};return j;};e.exports=i;},null);
__d("WebWorkerPool",["PooledWebWorker","emptyFunction"],function(a,b,c,d,e,f,g,h){i.isSupported=function(){"use strict";return g.isSupported();};function i(j,k){"use strict";this.$WebWorkerPool0=[];for(var l=0;l<k;l++)this.$WebWorkerPool0.push(new g(this,l,j).setErrorHandler(this.$WebWorkerPool1).setMessageHandler(this.$WebWorkerPool2).execute());this.$WebWorkerPool3=0;}i.prototype.setMessageHandler=function(j){"use strict";this.$WebWorkerPool4=j||h;return this;};i.prototype.setAllowCrossPageTransition=function(j){"use strict";this.$WebWorkerPool0.forEach(function(k){return k.setAllowCrossPageTransition(j);});return this;};i.prototype.setErrorHandler=function(j){"use strict";this.$WebWorkerPool5=j||h;return this;};i.prototype.postMessage=function(){"use strict";var j=Array.prototype.slice.call(arguments,0),k=this.getWorker();k.postMessage.apply(k,j);return k;};i.prototype.$WebWorkerPool2=function(){"use strict";var j=Array.prototype.slice.call(arguments,0);j.unshift(this);this.getPool().$WebWorkerPool4.apply(this.getPool(),j);};i.prototype.$WebWorkerPool1=function(){"use strict";var j=Array.prototype.slice.call(arguments,0);j.unshift(this);return this.getPool().$WebWorkerPool5.apply(this.getPool(),j);};i.prototype.getWorker=function(){"use strict";var j=this.$WebWorkerPool0[this.$WebWorkerPool3];this.$WebWorkerPool3=(this.$WebWorkerPool3+1)%this.$WebWorkerPool0.length;return j;};e.exports=i;},null);
__d("JpegResizer",["Emscripten","JpegResizerConfig","JpegResizeWorkerResource","WebWorker","WebWorkerPool","PUWErrorCodes"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=null;n.isSupported=function(){"use strict";return k.isSupported()&&g.isSupported()&&!h.isGKBlacklisted;};n.getSingleton=function(){"use strict";if(!m)m=new n(n.DEFAULT_POOL_SIZE).setAllowCrossPageTransition(true);return m;};n.prepareResource=function(o){"use strict";j.prepareResource(i,o);};function n(o){"use strict";o=o||n.DEFAULT_POOL_SIZE;j.prepareResource(i);this.$JpegResizer0=(new k(i,o)).setErrorHandler(this.$JpegResizer1.bind(this)).setMessageHandler(this.$JpegResizer2.bind(this));this.$JpegResizer3={};this.$JpegResizer4=n.DEFAULT_RESIZE_HEIGHT;this.$JpegResizer5=n.DEFAULT_RESIZE_WIDTH;}n.prototype.setHighQuality=function(o){"use strict";if(o){this.$JpegResizer4=n.DEFAULT_RESIZE_HEIGHT;this.$JpegResizer5=n.DEFAULT_RESIZE_WIDTH;}else{this.$JpegResizer4=n.LOW_QUALITY_RESIZE_HEIGHT;this.$JpegResizer5=n.LOW_QUALITY_RESIZE_WIDTH;}return this;};n.prototype.setAllowCrossPageTransition=function(o){"use strict";this.$JpegResizer0.setAllowCrossPageTransition(o);return this;};n.prototype.resizeBlob=function(o,p,q){"use strict";var r=this.$JpegResizer0.getWorker();if(r.isCurrentState('terminated')){var s=new Error('Worker terminated');s.code=l.WORKER_TERMINATED;p(s);return this;}var t=r.postMessage({blob:o,height:this.$JpegResizer4,width:this.$JpegResizer5}).getIndex();this.$JpegResizer6(t).unshift({done:p,progress:q});return this;};n.prototype.$JpegResizer6=function(o){"use strict";if(!this.$JpegResizer3.hasOwnProperty(o))this.$JpegResizer3[o]=[];return this.$JpegResizer3[o];};n.prototype.$JpegResizer1=function(o,p){"use strict";o.terminate();var q=this.$JpegResizer6(o.getIndex());this.$JpegResizer7(p);q.forEach(function(r){return r.done(p);});q.length=0;};n.prototype.$JpegResizer2=function(o,p){"use strict";if(p.error)this.$JpegResizer7(p.error);if(p.done){this.$JpegResizer6(o.getIndex()).pop().done(p.error,p.blob,p.skipped);}else{var q=this.$JpegResizer6(o.getIndex()),r=q[q.length-1].progress;if(r)r({written:p.written,total:p.total});}};n.prototype.$JpegResizer7=function(o){"use strict";var p=o.message;if(p.indexOf('Not a JPEG file')!==-1){o.code=l.BAD_JPEG;}else if(p.indexOf('abort()')!==-1){o.code=l.WORKER_ABORT;}else o.code=l.UNKNOWN_RESIZE_ERROR;};n.DEFAULT_POOL_SIZE=3;n.DEFAULT_RESIZE_HEIGHT=2048;n.DEFAULT_RESIZE_WIDTH=2048;n.LOW_QUALITY_RESIZE_HEIGHT=720;n.LOW_QUALITY_RESIZE_WIDTH=720;e.exports=n;},null);
__d("MercuryFileUploader",["ArbiterMixin","CSS","Dialog","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","MercuryAttachment","MercuryAttachmentTemplates","MercuryConstants","PhotosUploadID","SubscriptionsHandler","csx","fbt","getObjectValues","mixin","shield","startsWith","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){var ba=x(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(ga,ha,ia,ja){"use strict";this.$MercuryFileUploader0=ga;this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader6={};this.$MercuryFileUploader7={};this.$MercuryFileUploader8={};this.updateElements(ha,ia,ja);}ea.prototype.updateElements=function(ga,ha,ia){"use strict";this.$MercuryFileUploader9&&this.$MercuryFileUploader9.release();this.$MercuryFileUploader9=new t();this.$MercuryFileUploadera&&this.$MercuryFileUploadera.destroy();this.$MercuryFileUploadera=new l(ga,[o,m]);this.$MercuryFileUploadera.setAllowCrossOrigin(true);this.$MercuryFileUploadera.setUploadInParallel(true);var ja=j.find(ga,"._4q60"),ka=j.find(ja,"._4q61");new n(ja,ka,ha);this.$MercuryFileUploader9.addSubscriptions(this.$MercuryFileUploadera.subscribe('submit',function(){var la={count:0,file_sizes:[]};if(ha.files){for(var ma=0;ma<ha.files.length;ma++)if(ha.files[ma].size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var na={};for(var oa=0;oa<ha.files.length;oa++){var pa=this.$MercuryFileUploaderb();this.$MercuryFileUploaderc(pa,ha.files[oa].name);la.count++;la.file_sizes.push(ha.files[oa].size);na[pa]=ha.files[oa];}this.$MercuryFileUploadera.setFiles(na);}else{ia.value=this.$MercuryFileUploaderb();this.$MercuryFileUploaderc(ia.value,ha.value);la.count=1;}this.inform('submit',la);}.bind(this)),this.$MercuryFileUploadera.subscribe('success',this.$MercuryFileUploaderd.bind(this)),this.$MercuryFileUploadera.subscribe('failure',this.$MercuryFileUploadere.bind(this)),k.listen(ka,'click',y(this.inform,this,'open')));};ea.prototype.showAttachmentSizeErrorDialog=function(){"use strict";this.$MercuryFileUploadera.abort();this.$MercuryFileUploadera.clear();new i().setTitle("The file you have selected is too large").setBody("The file you have selected is too large. The maximum size is 25MB.").setButtons(i.OK).setSemiModal(true).show();};ea.prototype.addDroppedFiles=function(ga){"use strict";if(!this.$MercuryFileUploadera||!this.$MercuryFileUploadera.canUseXHR())return;var ha={},ia={count:0,file_sizes:[]};for(var ja=0;ja<ga.length;ja++){var ka=ga[ja];if(ka.size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var la=this.$MercuryFileUploaderb();this.$MercuryFileUploaderc(la,ka.name);ha[la]=ka;ia.file_sizes.push(ka.size);ia.count++;}this.$MercuryFileUploadera.setFiles(ha);this.$MercuryFileUploadera.forceSendViaXHR();this.inform('submit',ia);};ea.prototype.isUploading=function(){"use strict";return !!Object.keys(this.$MercuryFileUploader6).length;};ea.prototype.addCachedAttachments=function(ga){"use strict";ga.forEach(function(ha){var ia=this.$MercuryFileUploaderb();this.$MercuryFileUploaderc(ia,ha.filename);this.$MercuryFileUploaderf(ia,ha);}.bind(this));};ea.prototype.addCachedImageFiles=function(ga){"use strict";var ha="\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e";ga.forEach(function(ia){var ja=this.$MercuryFileUploaderb();this.$MercuryFileUploaderc(ja,ha);this.$MercuryFileUploaderf(ja,{filename:ia,image_id:ia,filetype:'image/jpeg'});}.bind(this));};ea.prototype.getAttachments=function(){"use strict";return w(this.$MercuryFileUploader1);};ea.prototype.getImageFiles=function(){"use strict";var ga=Object.keys(this.$MercuryFileUploader2).sort(),ha=[];ga.forEach(function(ia){return ha.push(this.$MercuryFileUploader2[ia]);}.bind(this));return ha;};ea.prototype.getVideoFiles=function(){"use strict";return w(this.$MercuryFileUploader3);};ea.prototype.getAudioFiles=function(){"use strict";return w(this.$MercuryFileUploader4);};ea.prototype.getFiles=function(){"use strict";return w(this.$MercuryFileUploader5);};ea.prototype.removeAttachments=function(){"use strict";j.empty(this.$MercuryFileUploader0);this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader7={};this.$MercuryFileUploader6={};this.$MercuryFileUploader8={};h.hide(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.destroy=function(){"use strict";this.$MercuryFileUploader9&&this.$MercuryFileUploader9.release();this.$MercuryFileUploadera&&this.$MercuryFileUploadera.destroy();this.removeAttachments();};ea.prototype.$MercuryFileUploaderc=function(ga,ha){"use strict";var ia=q[':fb:mercury:upload-file-row'].build();this.$MercuryFileUploader7[ga]=ia;this.$MercuryFileUploader6[ga]=true;this.$MercuryFileUploader8[ga]=Date.now();j.appendContent(ia.getNode('iconText'),fa(ha));k.listen(ia.getNode('closeFileUpload'),'click',this.$MercuryFileUploaderg.bind(this,ga));j.appendContent(this.$MercuryFileUploader0,ia.getRoot());h.show(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.$MercuryFileUploaderg=function(ga,event){"use strict";if(this.$MercuryFileUploader6[ga]){this.inform('upload-canceled-during-upload');}else if(this.$MercuryFileUploader1[ga]||this.$MercuryFileUploader2[ga]||this.$MercuryFileUploader3[ga]||this.$MercuryFileUploader4[ga]||this.$MercuryFileUploader5[ga])this.inform('upload-canceled-after-uploaded');delete this.$MercuryFileUploader1[ga];delete this.$MercuryFileUploader2[ga];delete this.$MercuryFileUploader3[ga];delete this.$MercuryFileUploader4[ga];delete this.$MercuryFileUploader5[ga];delete this.$MercuryFileUploader6[ga];delete this.$MercuryFileUploader8[ga];var ha=this.$MercuryFileUploader7[ga];delete this.$MercuryFileUploader7[ga];if(ha){j.remove(ha.getRoot());this.inform('dom-updated');}this.inform('upload-canceled');return false;};ea.prototype.$MercuryFileUploaderh=function(ga,ha){"use strict";var ia=this.$MercuryFileUploader7[ga],ja=p.getAttachIconClassByMime(ha);h.addClass(ia.getNode('iconText'),ja);h.addClass(ia.getRoot(),'done');};ea.prototype.$MercuryFileUploaderf=function(ga,ha){"use strict";if(this.$MercuryFileUploader6[ga]){delete this.$MercuryFileUploader6[ga];if(ha.image_id){this.$MercuryFileUploader2[ga]=ha.image_id;}else if(ha.video_id){this.$MercuryFileUploader3[ga]=ha.video_id;}else if(ha.audio_id){this.$MercuryFileUploader4[ga]=ha.audio_id;}else if(ha.file_id){this.$MercuryFileUploader5[ga]=ha.file_id;}else this.$MercuryFileUploader1[ga]=ha;this.$MercuryFileUploaderh(ga,ha.filetype);this.inform('one-upload-completed',{upload_time_ms:Date.now()-this.$MercuryFileUploader8[ga]});}if(!this.isUploading())this.inform('all-uploads-completed',{count:this.getAttachments().length});};ea.prototype.$MercuryFileUploaderd=function(event,ga){"use strict";var ha=ga.response.getPayload();this.$MercuryFileUploaderf(this.$MercuryFileUploaderi(ga),ha.metadata[0]);};ea.prototype.$MercuryFileUploadere=function(event,ga){"use strict";this.inform('one-upload-failed');this.$MercuryFileUploaderg(this.$MercuryFileUploaderi(ga),event);};ea.prototype.$MercuryFileUploaderb=function(){"use strict";return 'upload_'+s.getNewID();};ea.prototype.$MercuryFileUploaderi=function(ga){"use strict";var ha=ga.response.getPayload();if(ga.upload){return ga.upload.getName();}else return ha.uploadID;};function fa(ga){if(ga&&z(ga,'C:\\fakepath\\'))return ga.substring(12);return ga;}e.exports=ea;},null);
__d("MercuryShareLinkUploader",["ArbiterMixin","AsyncRequest","CSS","DOM","Event","Form","URLScraper","WebMessengerEvents","mixin","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=o(g);for(var r in q)if(q.hasOwnProperty(r))t[r]=q[r];var s=q===null?null:q.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=q;function t(u,v,w,x,y){"use strict";this.$MercuryShareLinkUploader0=u;this.$MercuryShareLinkUploader1=v;this.$MercuryShareLinkUploader2=w;this.$MercuryShareLinkUploader3=y;this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;k.listen(x,'click',this.close.bind(this));k.listen(y,'keyup',function(){!y.value.length&&this.$MercuryShareLinkUploader7.enable();}.bind(this));this.$MercuryShareLinkUploader7=new m(y);this.$MercuryShareLinkUploader7.subscribe('match',function(z,aa){this.loadShare(aa&&aa.url);}.bind(this));}t.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$MercuryShareLinkUploader4,this.$MercuryShareLinkUploader0,this.$MercuryShareLinkUploader3);};t.prototype.loadAttachData=function(u,v,w,x){"use strict";if(u){var y=l.serialize(v),z=y.attachment&&y.attachment.params,aa=y.link_metrics?y.link_metrics.no_image:true;if(!z||p(z))return null;var ba=x?x():w.value;if(ba.indexOf(z.url)===-1)return y;if(!z.summary&&!z.favicon&&aa&&z.title&&z.url&&z.url.substr(0,z.title.length)===z.title)return null;return y;}return null;};t.prototype.check=function(){"use strict";this.$MercuryShareLinkUploader7.check();};t.prototype.close=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.disable();this.inform('closed');};t.prototype.clear=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.enable();};t.prototype.enable=function(){"use strict";this.$MercuryShareLinkUploader7.enable();};t.prototype.disable=function(){"use strict";this.$MercuryShareLinkUploader7.disable();};t.prototype.loadShare=function(u){"use strict";this.$MercuryShareLinkUploader5=u;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=new h().setMethod('POST').setURI('/ajax/share_scrape.php').setData({u:u}).setHandler(this.$MercuryShareLinkUploader9.bind(this).bind(null,u)).setStatusElement(this.$MercuryShareLinkUploader2);this.$MercuryShareLinkUploader6.send();this.inform('link-detected');};t.prototype.$MercuryShareLinkUploader9=function(u,v){"use strict";if(this.$MercuryShareLinkUploader5!==u)return;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;i.show(this.$MercuryShareLinkUploader0);j.empty(this.$MercuryShareLinkUploader1);j.setContent(this.$MercuryShareLinkUploader1,v.payload);this.$MercuryShareLinkUploader4=true;if(!this.getAttachData()){this.close();return;}n.detailDOMChanged();};t.prototype.$MercuryShareLinkUploader8=function(){"use strict";i.hide(this.$MercuryShareLinkUploader0);this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=null;this.$MercuryShareLinkUploader7.reset();n.detailDOMChanged();};e.exports=t;},null);
__d("FBRTCLogger",["Log","LogHistory","MarauderLogger","UserAgentData","formatDate","pageID"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m='webrtc',n='sent_message',o='received_message',p='send_succeeded',q='send_failed',r='info',s='call_action',t='client_event',u='client_error',v='type',w='msg_id',x='ack_msg_id',y='call_id',z='from',aa='to',ba='content',ca='tag',da='peer_id',ea='error_code',fa='trigger',ga='endcallstats',ha='device_info',ia=null;ja.getInstance=function(ka){"use strict";if(!ia)ia=new ja();return ia;};function ja(ka){"use strict";this.$FBRTCLogger0=h.getInstance(m);}ja.prototype.logToConsole=function(ka){"use strict";var la='Console';this.$FBRTCLogger1(null,null,la,ka);this.$FBRTCLogger0.log(la,ka);};ja.prototype.logReceivedMessage=function(ka,la,ma){"use strict";var na={};na[z]=ka;na[y]=la;na[v]=ma.type;na[w]=ma.msg_id;if(ma.sdp)na[ba]=ma.sdp;if(ma.ack_id)na[x]=ma.ack_id;this.$FBRTCLogger2(o,na);this.$FBRTCLogger1(ka,la,'Received',ma.type+', '+ma.msg_id);};ja.prototype.logSentMessage=function(ka,la,ma){"use strict";var na={};na[aa]=ka;na[y]=la;na[v]=ma.type;na[w]=ma.msg_id;if(ma.sdp)na[ba]=ma.sdp;if(ma.ack_id)na[x]=ma.ack_id;this.$FBRTCLogger2(n,na);this.$FBRTCLogger1(ka,la,'Sent',ma.type+', '+ma.msg_id);};ja.prototype.logSentMessageSuccess=function(ka,la,ma,na){"use strict";var oa={};oa[da]=ka;oa[y]=la;oa[v]=ma;oa[w]=na;this.$FBRTCLogger2(p,oa);};ja.prototype.logSentMessageFailure=function(ka,la,ma,na,oa){"use strict";var pa={};pa[da]=ka;pa[y]=la;pa[v]=ma;pa[w]=na;pa[ea]=oa;this.$FBRTCLogger2(q,pa);this.$FBRTCLogger1(ka,la,'Send Failed',ma+', '+oa);};ja.prototype.logCallAction=function(ka,la,ma,na,oa){"use strict";var pa={};pa[da]=ka;pa[y]=la;pa[s]=ma;pa[ba]=na;if(oa)pa[fa]=oa;this.$FBRTCLogger2(s,pa);this.$FBRTCLogger1(ka,la,'CallAction',ma+', '+na);};ja.prototype.logEvent=function(ka,la,event){"use strict";var ma={};ma[da]=ka;ma[y]=la;ma[ba]=event;this.$FBRTCLogger2(t,ma);this.$FBRTCLogger1(ka,la,'Event',event);};ja.prototype.logInfo=function(ka,la,ma){"use strict";var na={};na[da]=ka;na[y]=la;na[ba]=ma;this.$FBRTCLogger2(r,na);this.$FBRTCLogger1(ka,la,'Info',ma);};ja.prototype.logError=function(ka,la,ma){"use strict";var na={};na[da]=ka;na[y]=la;na[ba]=ma;this.$FBRTCLogger2(u,na);this.$FBRTCLogger1(ka,la,'Error',ma);};ja.prototype.logErrorWithoutID=function(ka){"use strict";this.logError(null,null,ka);};ja.prototype.logEndCallSummary=function(ka){"use strict";if(!ka)return;var la={};la[da]=ka.peerID;la[y]=ka.callID;la[ca]=ga;la[ba]=ka.toString();la[ha]=this.$FBRTCLogger3();this.$FBRTCLogger2(r,la);this.$FBRTCLogger1(ka.peerID,ka.callID,'Call Summary',la);};ja.prototype.$FBRTCLogger3=function(){"use strict";return {device:j.deviceName,os:j.platformName,os_version:j.platformFullVersion,browser:j.browserName,browser_version:j.browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth};};ja.prototype.$FBRTCLogger2=function(ka,la){"use strict";la.page_id=l;this.$FBRTCLogger0.log(ka,la);i.log(ka,m,la);};ja.prototype.$FBRTCLogger1=function(ka,la,ma,na){"use strict";};ja.CallAction={START_CALL:'start_call',RECEIVED_CALL:'received_call',ANSWER_CALL:'answer_call',END_CALL:'end_call',SET_MUTE:'set_mute',SET_VIDEO_ON:'set_video_on',SET_SELF_VIEW_ON:'set_self_view_on',SET_FULLSCREEN_ON:'set_fullscreen_on'};ja.Trigger={ADMIN_MESSAGE:'admin_message',CHAT_TAB_ICON:'chat_tab_icon',CHAT_TAB_ICON_TOUR:'chat_tab_icon_tour',REDIAL_BUTTON:'redial_button'};e.exports=ja;},null);
__d("VideoCallRecordMessageDialog",["AsyncDialog","AsyncRequest","Dialog","URI","tx"],function(a,b,c,d,e,f,g,h,i,j,k){var l={get:function(m,n){var o="\u0e04\u0e38\u0e13\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e1d\u0e32\u0e01\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48",p="\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e43\u0e2b\u0e21\u0e48";return new i().setTitle(k._("{firstname} \u0e44\u0e21\u0e48\u0e27\u0e48\u0e32\u0e07",{firstname:n})).setBody(o).setButtons([{name:'record-message',label:p},i.CANCEL]).setHandler(function(){var q=j('/ajax/messaging/composer.php').setQueryData({ids:[m],autoloadvideo:true}).toString();g.send(new h(q));});}};e.exports=l;},null);
__d("VideoCallCore",["Event","Arbiter","AsyncRequest","AvailableList","AvailableListConstants","Bootloader","ChannelConstants","Cookie","CSS","Dialog","FBRTCLogger","UserAgent_DEPRECATED","VideoCallSupport","emptyFunction","ge","PresenceStatus","randomInt","VideoCallUI","VideoCallIncomingCallController","VideoCallTemplates","ShortProfiles","VideoCallRecordMessageDialog"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=b('VideoCallUI').module,y=b('VideoCallIncomingCallController').module;b('VideoCallTemplates');var z=[],aa=[],ba=null,ca={mightReloadPostInstall:function(){return r.windows();},onVideoMessage:function(ga){z.push(ga);l.loadModules(["VideoCallController"],t);},onRTCMessage:function(ga){if(s.isReceiveWebrtcSupported()&&y){aa.push(ga);da();}},setMessageHandler:function(ga){this.onVideoMessage=ga;if(ga)while(z.length)ga(z.shift());},setRTCMessageHandler:function(ga){this.onRTCMessage=ga;if(ga)while(aa.length)ga(aa.shift());},availableForCall:function(ga){var ha=j.get(ga);return ha==k.ACTIVE||ha==k.IDLE;},attachListenerToProfileButton:function(ga){var ha=u('videoCallProfileButton');if(ha){if(!s.isVideoCallSupported()){o.hide(ha);return;}g.listen(ha,'click',function(event){ca.startCallOrLeaveMessage(ga,'profile_button_click_timeline');});}},startCallOrLeaveMessage:function(ga,ha){if(this.availableForCall(ga)){ca.showOutgoingCallDialog(ga,ha);}else b('ShortProfiles').get(ga,function(ia){b('VideoCallRecordMessageDialog').get(ga,ia.firstName).show();});},showOutgoingCallDialog:function(ga,ha){var ia=ha||'unknown';ca.logClick(ga,ia);if(s.isReceiveWebrtcSupported()&&x){var ja=v.getCapabilities(ga),ka=m.CAPABILITY_VOIP_INTEROP|m.CAPABILITY_VIDEO,la=ja&ka;if(la!==0){var ma=parseInt(ga,10);da();var na=q.Trigger.CHAT_TAB_ICON,oa=ea();ba.startingCallTo(ma,oa);x.openAsCaller(ga,oa,na);return;}}ca.makeSkypeCall(ga);},makeSkypeCall:function(ga){var ha=s.isPluginInstalled()?'outgoing_dialog.php':'intro.php',ia='/ajax/chat/video/'+ha+'?idTarget='+ga;new p().setAllowCrossPageTransition(true).setAsync(new i(ia).setHandler(t).setServerDialogCancelHandler(t)).show();},logClick:function(ga,ha){new i().setURI('/ajax/chat/video/log_click.php').setData({targetUserID:ga,clickSource:ha}).setAllowCrossPageTransition(true).setErrorHandler(t).send();}};function da(){if(!ba)ba=new y(ca);}function ea(){return w(0,4294967295);}function fa(){if(!ca.mightReloadPostInstall())return;var ga=n.get('vcpwn');if(ga){n.clear('vcpwn');var ha=n.get('vctid');if(ha){n.clear('vctid');if(n.get('vctid'))return;if(ha&&ca.isInstalled()){var ia='/ajax/chat/video/outgoing_dialog.php?idTarget='+ha;new p().setAllowCrossPageTransition(true).setAsync(new i(ia)).show();}}}}h.subscribe(m.getArbiterType('video'),function(ga,ha){ca.onVideoMessage(ha.obj);});h.subscribe(m.getArbiterType('webrtc'),function(ga,ha){ca.onRTCMessage(ha.obj);});h.subscribe(m.getArbiterType('chat_event'),function(ga,ha){if(ha.obj.event_name=="missed-call")l.loadModules(["VideoCallController"],function(ia){ia.onMissedCallEvent(ha.obj);});});fa();e.exports=ca;},null);
__d("ChatActivity",["Event","Arbiter","AvailableList","AvailableListConstants","JSLogger","MercuryConfig","PresenceState","UserActivity","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=l.activity_limit||60000,q=l.idle_limit||1800000,r=l.idle_poll_interval||300000,s=k.create('chat_activity'),t=Date.now(),u=t,v=true;function w(){var aa=Date.now();return !!(v&&(aa-t<p));}var x=o(new h(),{isActive:w});function y(){var aa=t;t=Date.now();if(t-aa>q){s.debug('idle_to_active',aa);m.doSync();}x.inform('activity');}i.subscribe(j.ON_AVAILABILITY_CHANGED,function(){if(!i.isUserIdle())u=Date.now();});g.listen(window,'focus',function(){v=true;y();});g.listen(window,'blur',function(){v=false;});n.subscribe(function(){y();});function z(aa){var ba=aa&&aa.at&&m.verifyNumber(aa.at);if(typeof ba!=='number')ba=null;return ba||0;}setInterval(function(){var aa=Date.now(),ba=z(m.get()),ca=Math.max(t,ba,u);if(aa-ca>q){s.debug('idle',{cookie:ba,local:t,presence:u});x.inform('idle',aa-ca);}},r);m.registerStateStorer(function(aa){var ba=z(aa);if(ba<t)aa.at=t;return aa;});h.subscribe(k.DUMP_EVENT,function(aa,ba){ba.chat_activity={activity_limit:p,idle_limit:q,idle_poll_interval:r,last_active_time:t,last_global_active_time:u};});e.exports=x;},null);
__d("ChatTabModel",["Arbiter","ArbiterMixin","ChatBehavior","ChatConfig","LogHistory","JSLogger","MercuryAssert","PresenceInitialData","PresenceState","PresenceUtil","areJSONRepresentationsEqual","arrayContains","copyProperties","MercuryServerRequests","MercuryMessages","MercuryThreads","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=b('MercuryServerRequests').get(),u=b('MercuryMessages').get(),v=b('MercuryThreads').get(),w=b('MercuryTimestampTracker').get(),x=[],y=null,z=null,aa=null;function ba(){return parseInt(n.serverTime,10);}var ca=j.get('tab_max_load_age')||3600000,da=ba()-ca,ea=0,fa=20,ga=k.getInstance('chat_tab_model'),ha=false;function ia(bb){var cb=o.verifyNumber(bb.uct2);if(!cb||typeof cb!=='number'){ga.warn('bad_cookie_version',bb);return null;}if(cb<ea||cb<da)return null;return cb;}function ja(bb){var cb=ia(bb),db={};if(!cb){db.old_tabs=bb&&bb.t2&&JSON.stringify(bb.t2);db.old_promoted=bb&&bb.lm2;db.old_time=bb&&bb.uct2;db.old_reason=bb&&bb.tr;db.old_window=bb&&bb.tw;var eb=[];x.forEach(function(fb){if(!fb.fragile){var gb={i:fb.id,si:fb.server_id};if(fb.raised)gb.r=1;eb.push(gb);}});bb.t2=eb;bb.lm2=y;bb.uct2=ea;bb.tr=aa;bb.tw=p.getSessionID();db.new_tabs=JSON.stringify(bb.t2);db.new_promoted=bb.lm2;db.new_time=bb.uct2;db.new_reason=bb.tr;db.new_window=bb.tw;ga.debug('store',db);}else{db.tabs=bb&&bb.t2&&JSON.stringify(bb.t2);db.promoted=bb&&bb.lm2;db.time=bb&&bb.uct2;db.reason=bb&&bb.tr;db.window=bb&&bb.tw;db.last_change_time=ea;db.last_change_reason=aa;db.min_change_time=da;ga.warn('store_bad_state',db);}return bb;}function ka(bb){if(bb){var cb=ia(bb);if(cb&&cb!==ea){var db={};db.old_tabs=JSON.stringify(x);db.old_promoted=y;db.old_time=ea;db.old_reason=aa;db.window_id=p.getSessionID();db.cookie_tabs=bb&&bb.t2&&JSON.stringify(bb.t2);db.cookie_promoted=bb&&bb.lm2;db.cookie_time=bb&&bb.uct2;db.cookie_reason=bb&&bb.tr;db.cookie_window=bb&&bb.tw;ea=cb;aa='load';var eb=la(bb.t2,bb.lm2||null);db.load_result=eb;db.new_tabs=JSON.stringify(x);db.new_promoted=y;db.new_time=ea;db.new_reason=aa;var event='load';if(!ha)event+='_init';ga.log(event,db);return eb;}}else ga.warn('load_bad_state',bb);return false;}function la(bb,cb){if(ma(bb,cb)){var db=x.filter(function(gb){return gb.fragile;}),eb={};y=null;x=bb.map(function(gb){var hb={id:gb.i,server_id:gb.si};if(hb.id==cb)y=hb.id;if(gb.r)hb.raised=true;eb[hb.id]=hb;return hb;});x=x.filter(function(gb){return gb!=null;});if(z)for(var fb in z)if(!eb[fb]||!eb[fb].raised)delete z[fb];db=db.filter(function(gb){return !eb[gb.id];});x=x.concat(db);qa();return true;}return false;}function ma(bb,cb){if(cb!=y)return true;var db=x.filter(function(gb){return !gb.fragile;});if(bb.length!=db.length)return true;for(var eb=0,fb=bb.length;eb<fb;eb++)if(!q(bb[eb],db[eb]))return true;return false;}function na(bb,cb,db){var eb=ka(o.get());if(cb===undefined||cb>ea){if(bb()){eb=true;aa=db||null;pa(cb);}}else ga.error('rejected',{change_time:cb,state_time:ea});eb&&oa();}function oa(){if(ha)za.inform('chat/tabs-changed',za.get());}function pa(bb){if(bb===undefined)bb=Math.max(w.getLastUserMessageTimestamp()||1,ea+1);ea=bb;o.doSync();}function qa(bb){var cb=x.length-fa;if(cb>0)x=x.filter(function(db){return db.raised||db.id==bb||cb--<=0;});if(cb>0)x=x.filter(function(db){return db.id==y||db.id==bb||cb--<=0;});}function ra(bb){for(var cb=0;cb<x.length;cb++)if(x[cb].id==bb)return cb;return -1;}function sa(bb,cb){var db=v.getThreadMetaNow(bb);if(!db)return false;if(db.is_canonical_user){return va(bb,cb);}else{var eb=ta(bb);if(eb)t.getServerThreadID(bb,function(fb){if(xa(bb,fb)){pa();oa();}});return eb;}}function ta(bb){if(ra(bb)===-1){x.push({id:bb,fragile:true});ga.log('open_fragile_tab',{tabs:JSON.stringify(x),opened:bb,window_id:p.getSessionID()});return true;}return false;}function ua(bb){var cb=[];bb.forEach(function(db){var eb=ra(db);if(eb!==-1)cb.push(x[eb]);});x.forEach(function(db){if(!r(bb,db.id))cb.push(db);});na(function(){if(ma(cb,y)){x=cb;return true;}return false;});}function va(bb,cb){var db=ra(bb);if(db!=-1)if(x[db].fragile){x.splice(db,1);}else{cb&&(x[db].signatureID=cb);return true;}for(var eb=0;eb<=x.length;eb++)if(eb==x.length||x[eb].fragile){x.splice(eb,0,{id:bb,signatureID:cb});qa(bb);ga.log('open_tab',{tabs:JSON.stringify(x),opened:bb,window_id:p.getSessionID()});return true;}}function wa(bb){var cb=ra(bb);if(cb!=-1&&(!x[cb].raised||y!==bb)){x[cb].raised=true;y=bb;return true;}return false;}function xa(bb,cb){var db=ra(bb);if(db!=-1&&x[db].fragile){var eb=x[db];eb.fragile=false;eb.server_id=cb;var fb=[];x.forEach(function(gb){if(gb.id!=bb){if(eb&&gb.fragile){fb.push(eb);eb=null;}fb.push(gb);}});if(eb)fb.push(eb);x=fb;ga.log('make_permanent',{tabs:JSON.stringify(x),tab_id:bb,window_id:p.getSessionID()});return true;}return false;}function ya(bb){var cb=ra(bb);if(bb==y)y=null;if(cb!=-1){x.splice(cb,1);ga.log('close_tab',{tabs:JSON.stringify(x),closed:bb,window_id:p.getSessionID()});return true;}return false;}o.registerStateStorer(ja);o.registerStateLoader(function(bb){if(ka(bb))oa();});function za(){}s(za,h,{isTabPromoted:function(bb){if(bb)return bb==y;return false;},indexOf:function(bb){return ra(bb);},getTab:function(bb){m.isThreadID(bb);var cb=this.indexOf(bb);if(cb>-1){var db=x[cb];return s({},db);}return null;},getEmptyTab:function(){var bb;for(var cb=0;cb<x.length;cb++){bb=x[cb].id;if(v.isNewEmptyLocalThread(bb))return bb;}bb='root:'+u.generateNewClientMessageID(Date.now());v.createNewLocalThread(bb,[]);return bb;},getServerTime:function(){return ba();},changeShowingTabs:function(bb){return ua(bb);},closeAllTabs:function(){if(x.length){ga.log('close_all_tabs',{closed_tabs:JSON.stringify(x),window_id:p.getSessionID()});x=[];y=null;if(z)z={};pa();oa();}},closeFragileTabs:function(){var bb=[];for(var cb=0;cb<x.length;cb++)if(x[cb].fragile&&!v.isNewEmptyLocalThread(x[cb].id)){bb.push(x[cb]);x.splice(cb);oa();break;}ga.log('close_fragile_tabs',{tabs:JSON.stringify(x),fragile_closed:bb,window_id:p.getSessionID()});},closeTab:function(bb,cb){m.isThreadID(bb);var db=false;if(z){delete z[bb];db=true;}na(function(){if(ya(bb))db=true;return db;},undefined,cb);},raiseTab:function(bb,cb,db){m.isThreadID(bb);var eb=false;if(z&&cb){z[bb]=true;eb=true;}na(function(){if(sa(bb,db))eb=true;var fb=ra(bb);if(fb!=-1&&!x[fb].raised){x[fb].raised=true;eb=true;ga.log('raise_tab',{tabs:JSON.stringify(x),raised:bb,window_id:p.getSessionID()});}return eb;});},get:function(){var bb=x.map(function(cb){var db=s({},cb);delete db.fragile;if(z)db.raised=z[db.id];return db;});return {tabs:bb,promoted:y};},openFragileTab:function(bb){m.isThreadID(bb);if(ta(bb))oa();},openTab:function(bb){m.isThreadID(bb);na(sa.bind(null,bb));},lowerTab:function(bb){m.isThreadID(bb);var cb=false;if(z){delete z[bb];cb=true;}na(function(){var db=ra(bb);if(db!=-1&&x[db].raised){delete x[db].raised;ga.log('lower_tab',{tabs:JSON.stringify(x),lowered:bb,window_id:p.getSessionID()});cb=true;}return cb;});},raiseAndPromoteTab:function(bb,cb,db,eb,fb){m.isThreadID(bb);var gb=false;if(z&&cb){z[bb]=true;gb=true;}na(function(){if(sa(bb,db))gb=true;if(wa(bb)){gb=true;ga.log('raise_and_promote_tab',{tabs:JSON.stringify(x),promoted:bb,window_id:p.getSessionID()});}return gb;},eb,fb);},setPromotedTab:function(bb){m.isThreadID(bb);na(wa.bind(null,bb));},promoteThreadInPlaceOfThread:function(bb,cb,db,eb){m.isThreadID(bb);m.isThreadID(cb);na(function(){var fb=ra(bb),gb=ra(cb);if(eb){y=bb;}else if(y===cb)return true;var hb=x[fb];if(db){m.isThreadID(db);var ib=ra(db),jb=x[gb];x[gb]=hb;x.splice(fb,1);x.splice(ib,0,jb);}else{x[fb]=x[gb];x[gb]=hb;}return true;});},persistLocalRaised:function(){if(z){na(function(){var bb=false;x.forEach(function(cb){if(cb.raised!=z[cb.id]){bb=true;if(z[cb.id]){cb.raised=true;}else delete cb.raised;}});return bb;});ga.log('persist_local_raise',{tabs:JSON.stringify(x),window_id:p.getSessionID()});}}});g.subscribe(l.DUMP_EVENT,function(bb,cb){cb.chat_tabs={promoted:y,tabs:x.map(function(db){return s({},db);}),time:ea,max_load_age:ca};});function ab(){var bb=i.ignoresRemoteTabRaise();if(bb&&!z){ga.log('start_ignore_remote_raise');z={};oa();}else if(!bb&&z){ga.log('stop_ignore_remote_raise');z=null;oa();}}i.subscribe(i.ON_CHANGED,ab);ab();ka(o.getInitial(),true);if(ea===0)ea=ba()-600000;ha=true;e.exports=za;},null);
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areJSONRepresentationsEqual","copyProperties","csx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=175,v=269,w=0;function x(){return u;}function y(){return v;}function z(aa){this._root=aa;var ba=this._recalculateWidth.bind(this);m.listen(window,'resize',ba);j.subscribe('resize',ba);g.subscribeOnce('sidebar/initialized',ba,g.SUBSCRIBE_NEW);i.subscribe('chat/tabs-changed',t(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}r(z.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var aa=z._getAvailableDockWidth(this._root),ba=Math.max(1,Math.floor(aa/y())),ca=ba!=this._maxShown;if(!this._viewState||ca||aa<=this._viewState.usedWidth||aa>this._viewState.widthToShowNext){this._availableWidth=aa;this._maxShown=ba;this._viewState=null;this._recalculateTabs(ca);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(aa){var ba=z._getTabsToShow(i.get(),this._availableWidth);if(aa||!q(this._viewState,ba)){this._viewState=ba;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>y();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var aa=i.get(),ba=this._viewState.tabsToShow;return aa.tabs.filter(function(ca){return ba[ca.id];});},getRightmostHiddenTab:function(){var aa=i.get(),ba=this._viewState.tabsToShow,ca=aa.tabs.filter(function(ea){return !ba[ea.id];}),da=ca.shift();return da?da.id:null;},getLeftmostVisibleTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.pop();return ba?ba.id:null;},getRightmostRaisedTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(i.getTab(aa[ca].id).raised)return aa[ca].id;return null;},getRaisedVisibleTabs:function(){var aa=[],ba=this.getShowingTabsOrder(),ca=ba.length;for(var da=0;da<ca;da++)if(i.getTab(ba[da].id).raised)aa.push(ba[da].id);return aa;},shouldPromoteOnRaise:function(aa){if(!this._viewState.tabsToShow[aa])return true;if(this._viewState.nextToHide!=aa)return false;var ba=i.getTab(aa),ca=ba&&ba.raised;return !ca&&(this._availableWidth-this._viewState.usedWidth<y()-x());}});r(z,{_getAvailableDockWidth:function(aa){var ba=l.getViewportWithoutScrollbarDimensions().width;ba-=p.getLeft()+p.getRight();ba-=50;var ca=n.byClass(aa,'fbDock'),da=k.find(ca,"._56ox"),ea=o.getElementDimensions(da).x;ba-=ea;var fa=k.scry(ca,"._56oy");ea+=o.getElementDimensions(fa.pop()).x;var ga=o.getElementDimensions(ca),ha=ga.x-ea;if(ha>w)w=ha;ba-=w;ba-=15;return Math.max(ba,0);},_getTabsToShow:function(aa,ba){ba=Math.max(ba,y()+1);function ca(sa,ta){return (sa.raised||!ta)?y():x();}var da=JSON.parse(JSON.stringify(aa.tabs)),ea=-1,fa=null;if(aa.promoted)da.forEach(function(sa,ta){if(sa.id===aa.promoted){ea=ta;fa=sa;}});var ga=0,ha=false,ia=0,ja=!fa;da.forEach(function(sa,ta){var ua=ca(sa,ha);ha=ha||!sa.raised;sa.leftmostOffset=ga+ua;ga+=ua;if(sa.leftmostOffset<ba)ia++;ja|=ta==ea;sa.alreadyPlacedPromoted=ja;});function ka(sa,ta,ua){var va={};for(var wa=0;wa<ta;wa++){var xa=sa[wa];if(!xa.alreadyPlacedPromoted&&wa==ta-1){va[ua]=true;}else va[xa.id]=true;}return va;}var la=ka(da,ia,aa.promoted),ma=ka(da,ia-1,aa.promoted),na=null;for(var oa in la)if(!ma[oa])na=oa;var pa=da[ia-1],qa=pa?pa.leftmostOffset:0,ra=Infinity;if(ia<da.length)ra=da[ia].leftmostOffset;return {nextToHide:na,tabsToShow:la,usedWidth:qa,widthToShowNext:ra};}});e.exports=z;},null);
__d("ChatTabPresence",["AvailableList","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={};function k(l){var m=i.getCanonicalUserInThread(l);if(m)g.updateForID(m);}h.subscribe('chat/tabs-changed',function(event,l){l.tabs.forEach(function(m){if(m.raised&&!j[m.id])k(m.id);});j={};l.tabs.forEach(function(m){if(m.raised)j[m.id]=true;});});e.exports={};},null);
__d("ChatMentionsNotifications",["fbt","CurrentUser","MercuryParticipants"],function(a,b,c,d,e,f,g,h,i){var j={notifyIfMessageToMe:function(k){var l='fbid:'+h.getID(),m=k.body;i.get(l,function(n){var o=new RegExp(n.short_name,"i");if(o.test(m))j._notify(k);});},_notify:function(k){var l=48,m=k.body;if(m.length>l)m=m.substr(0,l-3)+"...";new Notification("\"You were tagged in a message!\"",{body:m,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};e.exports=j;},null);
__d("ChatAddToThreadButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.createClass({displayName:'ChatAddToThreadButton',mixins:[h],propTypes:{onClick:i.PropTypes.func,shown:i.PropTypes.bool},render:function(){var n="\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e08\u0e30\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e14\u0e49\u0e27\u0e22\u0e2d\u0e35\u0e01",o=j.getTrackingInfo(j.types.ADD_TO_THREAD);return (i.createElement(g,{'aria-label':n,className:(("addToThread")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),'data-ft':o,'data-hover':"tooltip",'data-tooltip-alignv':"top",onClick:this.props.onClick}));}});e.exports=m;},null);
__d("ChatArchiveWarning.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k){var l=i.createClass({displayName:'ChatArchiveWarning',mixins:[h],propTypes:{isFBAtWork:i.PropTypes.bool,shown:i.PropTypes.bool},render:function(){var m=this.props.isFBAtWork?k('images/chat/tab/archive-grey.png'):k('images/chat/tab/archive.png');return (i.createElement(g,{src:m,className:(("titanArchiveWarning")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),'data-hover':"tooltip",'data-tooltip-alignh':"center",'aria-label':"All employee-to-employee conversations will be archived"}));}});e.exports=l;},null);
__d("VideoCallTourDialog",["ArbiterMixin","LegacyContextualDialog","CSS","ChatTabTemplates","VideoCallCore","VideoCallingTour","copyProperties","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=b('MercuryThreads').get();function o(){this._dialog=null;}m(o.prototype,g);m(o.prototype,{render:function(p,q){var r=n.getCanonicalUserInThread(q);if(!r||!k.availableForCall(r))return;var s=j[':fb:mercury:call:tour'].build();this._dialog=new h();this._dialog.init(s.getRoot()).setWidth(250).setAlignH('center').setContext(p).show();i.addClass(this._dialog.getRoot(),'uiContextualDialogWithFooterArrowBottom');i.addClass(p,'video_call_tour');this.inform('chat/dialog-rendered',{dialog:this,thread_id:q});l.inform('videocallingtour/end');},updatePosition:function(){if(this._dialog&&this._dialog.isShown())this._dialog.updatePosition();},hide:function(){if(this._dialog&&this._dialog.isShown()){this._dialog.hide();this._dialog=null;}}});e.exports=o;},null);
__d("ChatContextualDialogController",["Event","ArbiterMixin","ChatTabModel","VideoCallingTour","VideoCallTourDialog","copyProperties","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=60000,o=false,p=function(w,x){this._videoCallTour=new k();this._threadID=w;this._tabMainElement=x;this._openDialog=null;this._subscriptionTokens=[];this._scrollListener=null;this._timeout=null;};function q(w,event,x){if(w._openDialog)w._openDialog.updatePosition();}function r(w){if(w._openDialog)w._openDialog.updatePosition();}function s(w){if(w._openDialog){w._openDialog.hide();w._openDialog=null;}if(w._timeout){clearTimeout(w._timeout);w._timeout=null;}while(w._subscriptionTokens.length)w._subscriptionTokens.pop().unsubscribe();if(w._scrollListener){w._scrollListener.remove();w._scrollListener=null;}}function t(w,event,x){if(x.thread_id===w._threadID){w._openDialog=x.dialog;v(w);w._timeout=m(w.destroy.bind(w,w._threadID),n);w._scrollListener=g.listen(window,'scroll',r.bind(null,w));}}function u(w,x){if(!w._openDialog){w._subscriptionTokens.push(x.subscribe('chat/dialog-rendered',t.bind(null,w)));x.render(w._tabMainElement,w._threadID);}}function v(w){w._subscriptionTokens.push(i.subscribe('chat/tabs-changed',q.bind(null,w)),p.subscribe('dialog/close-all',s.bind(null,w)));}l(p,h);l(p.prototype,{destroy:function(){s(this);},tabFocused:function(){if(o){u(this,this._videoCallTour);return;}},tabNotActive:function(){s(this);},hideVideoCallouts:function(){s(this);}});j.subscribe('videocallingtour/start',function(){o=true;p.inform('dialog/close-all');});j.subscribe('videocallingtour/end',function(){o=false;});e.exports=p;},null);
__d("StickerTriggerHighlightSpan.react",["React","Toggler","cx"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=g.createClass({displayName:'StickerTriggerHighlightSpan',getInitialState:function(){return {activated:false};},propTypes:{offsetKey:g.PropTypes.string,stickersFlyoutToggler:g.PropTypes.object,searchStickersFn:g.PropTypes.func},componentDidMount:function(){this._togglerSub=h.listen('hide',this.props.stickersFlyoutToggler,function(){return this.isMounted()&&this.setState({activated:false});}.bind(this));},componentWillUnmount:function(){this._togglerSub&&this._togglerSub.unsubscribe();},_onClick:function(){if(this.state.activated)return;h.show(this.props.stickersFlyoutToggler);this.props.searchStickersFn(this.props.triggeredWord);this.setState({activated:true});},render:function(){return (g.createElement(g.DOM.span,{onClick:this._onClick,'data-offset-key':this.props.offsetKey,className:(("_29dt")+(this.state.activated?' '+"_1t57":'')),spellCheck:false},this.props.children));}});e.exports=j;},null);
__d("ChatInput.react",["AbstractTextEditor.Experimental.react","DocumentCompositeDecorator.Experimental","DocumentDecorator","DocumentModifierExperimental","DOMVector","EditorChangeType","EditorState","StickerTriggerHighlightSpan.react","React","createContentStateFromBlocks","createPlainBlocksFromText","createInitialEditorState","emptyFunction","getDefaultKeyBinding","isSoftNewlineEvent","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";var w=s.thatReturnsNull,x=' ',y=o.createClass({displayName:'ChatInput',propTypes:{blockStyleFn:o.PropTypes.func,getTriggeredWordFn:o.PropTypes.func,initializeThingsWithInputFn:o.PropTypes.func,inlineStyleFn:o.PropTypes.func,inputChanged:o.PropTypes.func,inputKeyDown:o.PropTypes.func,isTriggerValid:o.PropTypes.func,keyBindingFn:o.PropTypes.func,onBlur:o.PropTypes.func,onEscape:o.PropTypes.func,onFocus:o.PropTypes.func,onTab:o.PropTypes.func,resizeFn:o.PropTypes.func,stickersFlyoutToggler:o.PropTypes.object,searchStickersFn:o.PropTypes.func},getDefaultProps:function(){return {blockStyleFn:w,inlineStyleFn:w,keyBindingFn:t};},componentDidMount:function(){this.props.resizeFn();this._oldHeight=this.getDOMNode().getBoundingClientRect().height;this.props.initializeThingsWithInputFn(this.refs.input.getDOMNode(),this.getValue);this.setState({triggeredWord:this.props.triggeredWord});},componentWillReceiveProps:function(z){if(this.state.triggeredWord!==z.triggeredWord)this.setState({triggeredWord:z.triggeredWord},this._updateDecorator);},componentDidUpdate:function(){var z=k.getScrollPosition();v(function(){var aa=this.getDOMNode().getBoundingClientRect().height;if(this._oldHeight!==aa){window.scrollTo(z.x,z.y);this.props.resizeFn();}this._oldHeight=aa;}.bind(this));},getInitialState:function(){return {editorState:this._createEmptyEditorState()};},_createEmptyEditorState:function(){var z=q(['']);return r(p(z));},resetState:function(){this.setState({editorState:m.moveFocusToEnd(this._createEmptyEditorState()),triggeredWord:null});},_updateDecorator:function(){var z=this._getStickerTagDecorator();v(function(){var aa=m.set(this.state.editorState,{decorator:z});this.setState({editorState:aa});}.bind(this));},_getStickerTagDecorator:function(){var z=this.state.triggeredWord,aa=function(ba,ca){if(!z)return;var da,ea,fa;if(z.match(/\W/)){fa=new RegExp(z.replace(/(\W)/g,'\\$1'),'gi');}else fa=new RegExp('\\b'+z+'\\b','gi');while((da=fa.exec(ba.getText()))!==null){ea=da.index;ca(ea,ea+z.length);}};return new h([new i(aa,n,{openFlyoutFn:this.props.openFlyoutFn,stickersFlyoutToggler:this.props.stickersFlyoutToggler,searchStickersFn:this.props.searchStickersFn,triggeredWord:z})]);},onChange:function(z){if(z.getCurrentContent()!==this.state.editorState.getCurrentContent())this.props.inputChanged(this.getValueFromEditorState(z));this.setState({editorState:z});},onReturn:function(event){if(u(event))return false;this.props.inputKeyDown(event,this.getValue());this.resetState();return true;},getValueFromEditorState:function(z){return z.getCurrentContent().getPlainText();},getValue:function(){return this.getValueFromEditorState(this.state.editorState);},focus:function(){this.refs.input.focus();},_onPasteFiles:function(z){var aa=/^image\//,ba=z.filter(function(ca){return aa.test(ca.type);});if(ba.length){this.props.uploadPhotoFn(ba[0]);return true;}return false;},insertEmoticon:function(z){var aa=this.state.editorState,ba=aa.getSelection(),ca=aa.getCurrentContent(),da=ba.getStartOffset(),ea=ba.getEndOffset(),fa=ca.getBlockForKey(ba.getStartKey()).getText(),ga=ca.getBlockForKey(ba.getEndKey()).getText();if(da>0&&fa[da-1]!==x)z=x+z;if(ea<=ga.length&&ga[ea]!==x)z=z+x;var ha=j.replaceText(ca,ba,z,aa.getCurrentInlineStyle(),null),ia=m.push(aa,ha,l.INSERT_CHARACTERS);this.setState({editorState:ia});},render:function(){return (o.createElement(g,Object.assign({ref:"input"},this.props,{editorState:this.state.editorState,onChange:this.onChange,handlePastedFiles:this._onPasteFiles,handleReturn:this.onReturn,spellCheck:true})));}});e.exports=y;},null);
__d("getImageSize",["DataViewPolyfill"],function(a,b,c,d,e,f,g){var h=a.DataView||g;function i(m){return {width:m.getUint16(6,true),height:m.getUint16(8,true)};}function j(m){return {width:m.getUint32(16,false),height:m.getUint32(20,false)};}function k(m){var n=m.byteLength,o=2;while(o<n){var p=m.getUint16(o,false);o+=2;if(p==65472||p==65474){return {width:m.getUint16(o+5,false),height:m.getUint16(o+3,false)};}else o+=m.getUint16(o,false);}return null;}function l(m){var n=new h(m);if(n.getUint8(0)==255&&n.getUint8(1)==216)return k(n);if(n.getUint8(0)==71&&n.getUint8(1)==73&&n.getUint8(2)==70)return i(n);if(n.getUint8(0)==137&&n.getUint8(1)==80&&n.getUint8(2)==78&&n.getUint8(3)==71)return j(n);return null;}e.exports=l;l.gif=i;l.png=j;l.jpeg=k;},null);
__d("ChatPhotoUploader.react",["ChatAutoSendPhotoUploader","Image.react","InlineBlock.react","Link.react","MercuryConfig","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r=l.createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:l.PropTypes.string,onSubmit:l.PropTypes.func,onAllUploadsComplete:l.PropTypes.func,onLastUploadFail:l.PropTypes.func,onLastUploadCancel:l.PropTypes.func},getDefaultProps:function(){return {actionURI:k.upload_url,onSubmit:o,onAllUploadsComplete:o,onLastUploadFail:o,onLastUploadCancel:o};},componentDidMount:function(){this._uploader=new g(this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this._subscriptions=new m();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled));},shouldComponentUpdate:function(s,t){return s.actionURI!=this.props.actionURI;},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},render:function(){return (l.createElement(l.DOM.form,{action:this.props.actionURI,method:"post",ref:"form"},l.createElement(l.DOM.input,{type:"hidden",name:"attach_id",ref:"attachID"}),l.createElement(l.DOM.input,{type:"hidden",name:"images_only",value:true}),l.createElement(i,{className:"_m _4q60 _3rzn"},l.createElement(j,{className:"_4q61 _509v"},l.createElement(h,{className:"_509w",src:q('/images/chat/chat_camera_icon.png'),alt:"\u0e01\u0e25\u0e49\u0e2d\u0e07"})),l.createElement(l.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:"image/*",ref:"input"}))));},_handleSubmit:function(s,t){this.props.onSubmit(s,t);},_handleAllUploadsCompleted:function(s,t){this.props.onAllUploadsComplete(s,t);},_handleLastUploadFailed:function(s,t){this.props.onLastUploadFail(s,t);},_handleLastUploadCanceled:function(s,t){this.props.onLastUploadCancel(s,t);},isUploading:function(){return this._uploader&&this._uploader.isUploading();},uploadFile:function(s){this._uploader.uploadFile(s);}});e.exports=r;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){var k=function(l,m){this._userID=l;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case k.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var n=function(){m&&m(this._getState());}.bind(this);n();this._subscribeToken=i.subscribe('privacy-changed',n);}.bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';j(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&i.unsubscribe(this._subscribeToken);}});e.exports=k;},null);
__d("ChatShareLinkUploader",["AsyncRequest","CSS","DOM","URLScraper","MercuryShareLinkUploader","MercuryAttachmentTemplates","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in k)if(k.hasOwnProperty(n))p[n]=k[n];var o=k===null?null:k.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=k;function p(q,r,s,t){"use strict";this.$ChatShareLinkUploader0=q;this.$ChatShareLinkUploader1=r;this.$ChatShareLinkUploader2=s;this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader6=t;m.listen(r,'keyup',function(){var u=t?t():r.value;!u.length&&this.$ChatShareLinkUploader7.enable();}.bind(this));this.$ChatShareLinkUploader7=new j(r,t);this.$ChatShareLinkUploader7.subscribe('match',function(u,v){this.loadShare(v&&v.url);}.bind(this));this.$ChatShareLinkUploader8=null;}p.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$ChatShareLinkUploader3,this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader1,this.$ChatShareLinkUploader6);};p.prototype.close=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.disable();this.inform('closed');};p.prototype.clear=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.enable();};p.prototype.$ChatShareLinkUploader9=function(){"use strict";var q=this.$ChatShareLinkUploader8;delete this.$ChatShareLinkUploader8;if(q){i.remove(q);this.inform('dom-updated');}this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader7&&this.$ChatShareLinkUploader7.reset();};p.prototype.loadShare=function(q,r){"use strict";this.$ChatShareLinkUploader4=q;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();var s=l[':fb:mercury:share-link-row'].build();if(this.$ChatShareLinkUploader8)i.remove(this.$ChatShareLinkUploader8);this.$ChatShareLinkUploader8=s.getRoot();m.listen(s.getNode('closeFileUpload'),'click',function(event){this.close();event.kill();}.bind(this));i.appendContent(this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader8);h.show(this.$ChatShareLinkUploader0);this.inform('dom-updated');var t={u:q,chat:true,extra_params:JSON.stringify(r)};this.$ChatShareLinkUploader5=new g().setMethod('POST').setURI('/ajax/share_scrape.php').setData(t).setHandler(this.$ChatShareLinkUploadera.bind(this).bind(null,q));this.$ChatShareLinkUploader5.send();this.inform('link-detected');};p.prototype.$ChatShareLinkUploadera=function(q,r){"use strict";if(this.$ChatShareLinkUploader4!==q)return;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;i.appendContent(this.$ChatShareLinkUploader8,r.payload);this.$ChatShareLinkUploader2();this.$ChatShareLinkUploader3=true;if(!this.getAttachData()){this.close();return;}h.addClass(this.$ChatShareLinkUploader8,'done');};e.exports=p;},null);
__d("StickerContextualDialog.react",["ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=47,k=h.createClass(g.createSpec({displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:j,length:16}}}));k.WIDTH={NORMAL:312,WIDE:400};e.exports=k;},null);
__d("MessagesEmoticons.react",["Grid.react","React","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.GridItem,m=8,n={smile:"\u0e22\u0e34\u0e49\u0e21",frown:"\u0e2b\u0e19\u0e49\u0e32\u0e1a\u0e36\u0e49\u0e07",tongue:"\u0e25\u0e34\u0e49\u0e19",grin:"\u0e22\u0e34\u0e49\u0e21\u0e01\u0e27\u0e49\u0e32\u0e07",gasp:"\u0e2d\u0e49\u0e32\u0e1b\u0e32\u0e01\u0e04\u0e49\u0e32\u0e07",wink:"\u0e02\u0e22\u0e34\u0e1a\u0e15\u0e32",pacman:"\u0e41\u0e1e\u0e47\u0e04\u0e41\u0e21\u0e19",grumpy:"\u0e1a\u0e39\u0e14\u0e1a\u0e36\u0e49\u0e07",unsure:"\u0e44\u0e21\u0e48\u0e41\u0e19\u0e48\u0e43\u0e08",cry:"\u0e23\u0e49\u0e2d\u0e07\u0e44\u0e2b\u0e49",kiki:"kiki",glasses:"\u0e41\u0e01\u0e49\u0e27",sunglasses:"\u0e41\u0e27\u0e48\u0e19\u0e01\u0e31\u0e19\u0e41\u0e14\u0e14",heart:"\u0e2b\u0e31\u0e27\u0e43\u0e08",devil:"\u0e1b\u0e35\u0e28\u0e32\u0e08",angel:"\u0e19\u0e32\u0e07\u0e1f\u0e49\u0e32",squint:"\u0e0a\u0e33\u0e40\u0e25\u0e37\u0e2d\u0e07",confused:"\u0e2a\u0e31\u0e1a\u0e2a\u0e19",upset:"\u0e44\u0e21\u0e48\u0e1e\u0e2d\u0e43\u0e08",colonthree:"\u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e2b\u0e21\u0e32\u0e22\u0e2d\u0e31\u0e12\u0e20\u0e32\u0e04 3",like:"\u0e16\u0e39\u0e01\u0e43\u0e08"},o=h.createClass({displayName:'MessagesEmoticons',propTypes:{onEmoticonSelect:h.PropTypes.func},getDefaultProps:function(){return {onEmoticonSelect:j};},getEmoticons:function(){return Object.keys(n).map(function(p){return (h.createElement(l,{key:p},h.createElement(h.DOM.div,{className:"panelCell"},h.createElement(h.DOM.a,{'aria-label':n[p],className:'emoticon emoticon_'+p,onClick:function(){return this.props.onEmoticonSelect(p);}.bind(this)}))));}.bind(this));},render:function(){return (h.createElement(h.DOM.div,{className:"emoticonsTable"},h.createElement(g,{cols:m,alignv:"middle",alignh:"center",spacing:"pam"},this.getEmoticons())));}});e.exports=o;},null);
__d("XStickerPackImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int"}});},null);
__d("XStickersRemovePackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"}});},null);
__d("XStickerStateInitialDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/store\/",{});},null);
__d("XStickerSearchPromotePackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/search\/promotePack\/",{sticker_id:{type:"Int",required:true}});},null);
__d("XStickerSearchNUXSeenControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/searchNUX\/seen\/",{tooltip_only:{type:"Bool"}});},null);
__d("XStickerTagImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tag\/images\/",{tag_ids:{type:"IntVector",required:true}});},null);
__d("XStickerTagDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tag\/data\/",{});},null);
__d("XStickerQueryImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/query\/images\/",{query:{type:"String",required:true}});},null);
__d("StickerServerRequests",["AsyncRequest","Promise","XStickerPackImagesControllerURIBuilder","XStickersAddPackControllerURIBuilder","XStickersRemovePackControllerURIBuilder","XStickerStateInitialDataControllerURIBuilder","XStickerStatePackDataControllerURIBuilder","XStickerStateStoreDataControllerURIBuilder","XStickerSearchPromotePackControllerURIBuilder","XStickerSearchNUXSeenControllerURIBuilder","XStickerTagImagesControllerURIBuilder","XStickerTagDataControllerURIBuilder","XStickerQueryImagesControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';var t={addPack:function(v,w,x){var y=new j().setInt('pack_id',v).setBool('is_promoted',w).getURI();new g(y).setHandler(function(z){return x(z.payload);}).send();},removePack:function(v,w){var x=new k().setInt('pack_id',v).getURI();new g(x).setHandler(function(y){return w(y.payload);}).send();},getStickersForPack:function(v,w){var x=new i().setInt('pack_id',v).setInt('sticker_size',w).getURI();return new h(function(y,z){return new g().setURI(x).setMethod("POST").setHandler(function(aa){return y(aa.payload);}).send();});},getStickersForTags:function(v,w){new g().setURI(new q().setIntVector('tag_ids',v).getURI()).setMethod("POST").setHandler(function(x){return w(x);}).send();},getStickersForQuery:function(v,w){new g().setURI(new s().setString('query',v).getURI()).setMethod("POST").setHandler(function(x){return w(x);}).send();},fetchTrayData:function(v){return u(new l().getURI(),v,true);},fetchStoreData:function(v){return u(new n().getURI(),v);},fetchPackData:function(v,w){return u(new m().setInt('pack_id',v).getURI(),w);},fetchTagData:function(v){return u(new r().getURI(),v,true);},markSeenSearchNUX:function(){new g(new p().setBool('tooltip_only',false).getURI().toString()).send();},markSeenSearchTooltipNUX:function(){new g(new p().setBool('tooltip_only',true).getURI().toString()).send();},promotePackSentFromSearch:function(v,w){var x=new o().setInt('sticker_id',v).getURI();u(x,w,true);}};function u(v,w,x){return new h(function(y,z){return new g(v).setHandler(function(aa){return y(aa.getPayload());}).setAllowCrossPageTransition(x).send();}).then(w);}e.exports=t;},null);
__d("DialogFitHeight",["CSS","DOM","Event","Style","SubscriptionsHandler","Vector","csx","cx","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=450,q=100,r=67,s=67;function t(u){"use strict";this.$DialogFitHeight0=u;}t.prototype.enable=function(){"use strict";this.$DialogFitHeight1=new k();this.$DialogFitHeight1.addSubscriptions(this.$DialogFitHeight0.subscribe('beforeshow',this.$DialogFitHeight2.bind(this)),i.listen(window,'resize',o(this.$DialogFitHeight2.bind(this))));this.$DialogFitHeight3=h.find(this.$DialogFitHeight0.getRoot(),"._4-i2");g.addClass(this.$DialogFitHeight3,"_5pfh");this.$DialogFitHeight4=q;if(h.scry(this.$DialogFitHeight0.getRoot(),"._4-i0").length)this.$DialogFitHeight4+=r;if(h.scry(this.$DialogFitHeight0.getRoot(),"._5a8u").length)this.$DialogFitHeight4+=s;};t.prototype.disable=function(){"use strict";this.$DialogFitHeight1.release();this.$DialogFitHeight1=null;g.removeClass(this.$DialogFitHeight3,"_5pfh");};t.prototype.$DialogFitHeight2=function(){"use strict";var u=l.getViewportDimensions().y,v=u-this.$DialogFitHeight4;j.set(this.$DialogFitHeight3,'height',Math.max(p,v)+'px');this.$DialogFitHeight0.updatePosition();};e.exports=t;},null);
__d("StickersFlyoutPackSelector.react",["Animation","ImmutableObject","Locale","React","Image.react","StickerActions","StickerConfig","StickerConstants","StickerState","StickerStoreController","XUIBadge.react","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';var v=4,w=200,x="\u0e2a\u0e15\u0e34\u0e01\u0e40\u0e01\u0e2d\u0e23\u0e4c\u0e2a\u0e42\u0e15\u0e23\u0e4c",y=j.createClass({displayName:'StickersFlyoutPackSelector',propTypes:{isComments:j.PropTypes.bool,numNewPacks:j.PropTypes.number,packs:j.PropTypes.arrayOf(j.PropTypes.instanceOf(h)).isRequired,onPackClick:j.PropTypes.func,selectedPackID:j.PropTypes.string,resetTagSelectorFunc:j.PropTypes.func},getInitialState:function(){return {animating:false,page:0};},getDefaultProps:function(){return {isComments:false,numNewPacks:0};},shouldComponentUpdate:function(aa,ba){return !ba.animating;},onFlyoutShown:function(){if(this.props.packs.length>0){var aa=this._calculatePageForPack(this.props.selectedPackID);if(this.state.page!==aa)this._setPage(aa,0);}},_calculatePageForPack:function(aa){for(var ba=0;ba<this.props.packs.length;ba++)if(this.props.packs[ba].id==aa)return ba<=v?0:Math.floor((ba-1)/v);return 0;},_setPage:function(aa,ba){if(this.state.animating)return;this.setState({animating:true,page:aa},function(){var ca=this.refs.positioner.getDOMNode(),da=this._calculatePosition(aa);new g(ca).to(da.reference,da.offset+'px').ondone(function(){return this.setState({animating:false});}.bind(this)).duration(ba).go();});},_calculatePosition:function(aa){var ba=this.refs.positioner.getDOMNode(),ca=ba.childNodes[aa].offsetLeft;if(i.isRTL()){var da=ba.offsetWidth,ea=ba.childNodes[aa].offsetWidth;return {reference:'right',offset:ca+ea-da};}return {reference:'left',offset:-ca};},_numPages:function(){return Math.max(1,Math.ceil((this.props.packs.length-1)/v));},_canGoPrev:function(){return this.state.page>0;},_canGoNext:function(){return this.state.page+1<this._numPages();},_goPrev:function(){this._canGoPrev()&&this._setPage(this.state.page-1,w);},_goNext:function(){this._canGoNext()&&this._setPage(this.state.page+1,w);},_openStore:function(){l.resetNumNewPacks();p.showStore();},render:function(){return (j.createElement(j.DOM.div,{className:"_5r85"},this._renderStoreButton(),this._renderPrevArrow(),this._renderNextArrow(),j.createElement(j.DOM.div,{className:"_5r88"},j.createElement(j.DOM.div,{className:"_5r89",ref:"positioner"},this._renderPages()))));},_selectPack:function(aa){var ba=o.getPack(aa);if(ba&&ba.isPromoted)l.addPack(aa);if(aa===n.SEARCH_PACK_ID)this.props.resetTagSelectorFunc();if(this.props.onPackClick){this.props.onPackClick(aa);}else l.selectPack(aa);},_renderPages:function(){var aa=this.props.packs.map(function(ea,fa){return j.createElement(z,{key:ea.id,onClick:function(){return this._selectPack(ea.id);}.bind(this),pack:ea,selected:this.props.selectedPackID===ea.id,index:fa,isComments:this.props.isComments});}.bind(this)),ba=[];for(var ca=0;ca<aa.length;ca+=v){var da=ca;ca===0&&ca++;ba.push(j.createElement(j.DOM.div,{className:"_5r81",key:ca},aa.slice(da,ca+v)));}return ba;},_renderStoreButton:function(){var aa=m.WebStickerTrayPlusSign?u('/images/messaging/stickers/selector/sticker_store.png'):u('/images/messaging/stickers/selector/store.png');return (j.createElement(j.DOM.a,{'aria-label':x,className:(("_5r86")+(' '+"rfloat")+(m.WebStickerTrayPlusSign?' '+"_5qci":'')),'data-hover':"tooltip",onClick:this._openStore},j.createElement(k,{className:"_5r87",src:aa}),this._renderJewel()));},_renderJewel:function(){var aa=this.props.numNewPacks;if(!aa)return null;return (j.createElement(q,{className:"rfloat _3fhs",count:aa,maxcount:9,type:"special"}));},_renderPrevArrow:function(){if(!this._canGoPrev())return null;return (j.createElement(j.DOM.a,{className:(("_37wu")+(' '+"lfloat")),onClick:this._goPrev},j.createElement(k,{className:"_5r84",src:u('/images/messaging/stickers/selector/left.png')})));},_renderNextArrow:function(){if(!this._canGoNext())return null;return (j.createElement(j.DOM.a,{className:(("_37wv")+(' '+"rfloat")),onClick:this._goNext},j.createElement(k,{className:"_5r84",src:u('/images/messaging/stickers/selector/right.png')})));}}),z=j.createClass({displayName:'PackIcon',propTypes:{index:j.PropTypes.number,isComments:j.PropTypes.bool,onClick:j.PropTypes.func,pack:j.PropTypes.instanceOf(h).isRequired,selected:j.PropTypes.bool},getDefaultProps:function(){return {isComments:false,onClick:s};},_getPackIcon:function(aa){if(aa.id==n.SEARCH_PACK_ID)return u('/images/messaging/stickers/icons/search.png');if(aa.id==n.MRU_STICKER_PACK)return u('/images/messaging/stickers/icons/recent.png');if(aa.id==n.EMOTICON_PACK_ID)return u('/images/messaging/stickers/icons/emoji.png');return aa.icon;},render:function(){var aa=this.props.pack,ba=m.WebStickerSearch?this.props.index===1||this.props.index===2:this.props.index===1,ca=(("_5r8a")+(this.props.selected?' '+"_5r8b":'')+(aa.id==n.MRU_STICKER_PACK?' '+"_5qcj":'')+(aa.id==n.SEARCH_PACK_ID?' '+"_5qck":'')+(ba?' '+"_eb3":'')),da=this.props.isComments&&aa.isMessengerOnly,ea="\u0e0a\u0e38\u0e14\u0e19\u0e35\u0e49\u0e43\u0e0a\u0e49\u0e44\u0e14\u0e49\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e01\u0e32\u0e23\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19",fa=da?s:function(){return this.props.onClick(aa.id);}.bind(this);return (j.createElement(j.DOM.a,{'aria-label':da?ea:aa.name,className:ca,'data-id':aa.id,'data-hover':"tooltip",ref:"search_icon",onClick:fa,tabIndex:"0"},j.createElement(k,{className:((da?"_2ji6":'')+(' '+"_5r8c")+(m.WebStickerSearch?' '+"_1viy":'')),src:this._getPackIcon(aa)})));}});e.exports=y;},null);
__d("StickerSearch",["StickerImages","StickerServerRequests","StickerState","createObjectFrom","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k){'use strict';var l=100,m=1000,n=10000,o,p,q,r=null,s={},t={requestStickersForTags:function(u,v,w,x){p=w;var y=u,z=v.length>1;if(z)y=y.concat(v);g.requestStickersForTags(y,function(){if(p===w)x(this._getSortedStickersForTags(u,v,w,z));}.bind(this));},requestStickersForQuery:function(u,v){p=u;h.getStickersForQuery(u,function(w){return p===u&&v(w.payload);});},_getSortedStickersForTags:function(u,v,w,x){var y={},z=this._getTypeaheadStickers(u,w,y),aa=k(z);if(x){var ba=this._getIntersectionStickers(v,y);aa=aa.concat(ba.filter(function(ca){return !z.hasOwnProperty(ca.id);}));}aa.map(function(ca){return g.cacheSticker(ca);});aa.sort(function(ca,da){return y[da.id]-y[ca.id];});return aa;},_getTypeaheadStickers:function(u,v,w){var x={},y=g.getStickerTagsData();o=j(i.getPackIDsInTray());u.forEach(function(z){y[z.id].forEach(function(aa){var ba=aa.score+l;if(o[aa.packID])ba+=m;if(z.name===v)ba+=n;if(!x[aa.id]||ba>w[aa.id]){x[aa.id]=aa;w[aa.id]=ba;}});});return x;},_getIntersectionStickers:function(u,v){var w=g.getStickerTagsData(),x=u.map(function(z){return w[z.id].map(function(aa){return aa.id;});}),y=w[u[0].id].filter(function(z){v[z.id]=z.score;for(var aa=1;aa<x.length;aa++)if(x[aa].indexOf(z.id)===-1){return false;}else v[z.id]+=w[u[aa].id].score;return true;});return y;},prepareTagsData:function(){if(!q)q=h.fetchTagData(function(u){r=u;r.map(function(v){return s[v.name]=v;});});return q;},getTagByName:function(u){return s[u];},getTags:function(){return r;},getTagsIndex:function(){return s;}};e.exports=t;},null);
__d("StickerUtils",[],function(a,b,c,d,e,f){var g=64,h={getScaledDimensions:function(i,j){var k,l,m;if(j>i){m=g/j;k=i*m;l=j*m;}else{m=g/i;k=i*m;l=j*m;}return {height:Math.round(k),width:Math.round(l)};},capitalizeWords:function(i){var j=i.split(" ");for(var k=0;k<j.length;k++){var l=j[k].charAt(0).toUpperCase();j[k]=l+j[k].substr(1);}return j.join(" ");}};e.exports=h;},null);
__d("StickersFlyoutStickerSelector.react",["BanzaiLogger","Grid.react","Image.react","LegacyScrollableArea.react","React","Sticker.react","StickerConstants","StickerImages","StickerSearch","StickerState","StickerUtils","XUISpinner.react","areEqual","cx","debounce","emptyFunction","fbt","ix","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';var z=h.GridItem,aa=320,ba=278,ca=m.MRU_STICKER_PACK,da=64,ea=44,fa=112,ga=u(function(ia,ja){if(!ia)return;g.log('StickersLoggerConfig',{event:'search_sticker',searchtoken:ia,numsearchresults:ja.length});},1000),ha=k.createClass({displayName:'StickersFlyoutStickerSelector',propTypes:{height:k.PropTypes.number,onScroll:k.PropTypes.func,packID:k.PropTypes.string,userInput:k.PropTypes.string,typeaheadTags:k.PropTypes.array,singleWordTags:k.PropTypes.array},getDefaultProps:function(){return {isComments:false,onScroll:v};},getInitialState:function(){return {loading:false,stickers:[]};},componentDidMount:function(){if(this.props.packID){this.requestStickersForPack(this.props.packID);return;}if((this.props.typeaheadTags&&this.props.typeaheadTags.length>0)||(this.props.singleWordTags&&this.props.singleWordTags.length>0)){this.requestStickersForTags(this.props.typeaheadTags,this.props.singleWordTags,this.props.userInput);return;}if(this.props.userInput)this.requestStickersForQuery(this.props.userInput);},componentWillReceiveProps:function(ia){if(ia.packID&&ia.packID!==this.props.packID){this.requestStickersForPack(ia.packID);}else if(!s(ia.typeaheadTags,this.props.typeaheadTags)||!s(ia.singleWordTags,this.props.singleWordTags)){this.requestStickersForTags(ia.typeaheadTags,ia.singleWordTags,ia.userInput);}else if(!o.getTags()&&ia.userInput!==this.props.userInput)this.requestStickersForQuery(ia.userInput);},requestStickersForTags:function(ia,ja,ka){this.setState({loading:true});o.requestStickersForTags(ia,ja,ka,function(la){if(!this.props.tagChosen)ga(ka,la);if(this.props.isComments)la=la.filter(function(ma){return !ma.isMessengerOnly;});this.isMounted()&&this.setState({loading:false,stickers:la.slice(0,40)});}.bind(this));},requestStickersForQuery:function(ia){this.setState({loading:true});o.requestStickersForQuery(ia,function(ja){ja.map(function(ka){return n.cacheSticker(ka);});if(!this.props.tagChosen)ga(ia,ja);if(this.props.isComments)ja=ja.filter(function(ka){return !ka.isMessengerOnly;});this.isMounted()&&this.setState({loading:false,stickers:ja});}.bind(this));},requestStickersForPack:function(ia){this.setState({loading:true});n.requestStickersForPack(ia,da,function(ja){if(ia==ca){ja=p.getMRUStickerPack(ja);if(this.props.isComments)ja=ja.filter(function(ka){return !ka.isMessengerOnly;});}this.setState({loading:false,stickers:ja});}.bind(this));},renderStickers:function(){var ia=this.state.stickers.map(function(ja){var ka=q.getScaledDimensions(ja.height,ja.width);return (k.createElement(z,{key:ja.id},k.createElement(k.DOM.div,{className:"_5r8h",'data-id':ja.id},k.createElement(l,{animationTrigger:"hover",className:"_5r8i",frameCount:ja.frameCount,frameRate:ja.frameRate||83,framesPerCol:ja.framesPerCol,framesPerRow:ja.framesPerRow,sourceHeight:ka.height,sourceURI:ja.sourceURI,sourceWidth:ka.width,spriteURI:ja.spriteURI,paddedSpriteURI:ja.paddedSpriteURI,stickerID:ja.id,style:{cursor:'pointer'}}))));});return ia;},_onScroll:function(){var ia=this.refs.stickerScrollable;if(ia){var ja=ia.getArea().getScrollTop();this.props.onScroll(ja);}},render:function(){if(this.state.loading){return (k.createElement(k.DOM.div,{className:"_e0r"},k.createElement(r,{size:"large"})));}else if(this.state.stickers.length===0){var ia=(aa-ea*2-fa)/2+"px";return (k.createElement(k.DOM.div,{className:"_5jdt",style:{marginTop:ia}},k.createElement(i,{src:x("/images/messaging/stickers/icons/sad_face.png")}),k.createElement(k.DOM.p,null,"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2a\u0e15\u0e34\u0e01\u0e40\u0e01\u0e2d\u0e23\u0e4c\u0e43\u0e2b\u0e49\u0e41\u0e2a\u0e14\u0e07")));}return (k.createElement(j,{ref:"stickerScrollable",height:this.props.height||aa,onScroll:y(this._onScroll,200),width:ba,fade:true},k.createElement(k.DOM.div,{className:"_5r8k"},k.createElement(h,{cols:4,fixed:true},this.renderStickers()))));}});e.exports=ha;},null);
__d("StickersFlyoutTagSelector.react",["BanzaiLogger","Grid.react","LegacyScrollableArea.react","Parent","React","Image.react","StickerConfig","StickerConstants","StickersFlyoutStickerSelector.react","StickerSearch","StickerState","StickerUtils","Toggler","XUIButton.react","XUICloseButton.react","XUITextInput.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';var z=h.GridItem,aa=320,ba=278,ca=44,da=k.createClass({displayName:'StickersFlyoutTagSelector',propTypes:{trigger:k.PropTypes.string,isComments:k.PropTypes.bool,resetTrigger:k.PropTypes.func},getInitialState:function(){return {input:'',isScrolling:false,tagChosen:false,typeaheadTags:[],singleWordTags:[]};},getDefaultProps:function(){return {trigger:null,isComments:false,resetTrigger:x};},componentDidMount:function(){var ea=j.byClass(this.getDOMNode(),'uiToggle');if(ea)this._togglerSub=s.listen('show',ea,function(){this.isMounted()&&this.focusInput();}.bind(this));this.focusInput();this.selectTrigger(this.props.trigger);},componentWillUnmount:function(){this._togglerSub&&this._togglerSub.unsubscribe();},componentWillReceiveProps:function(ea){this.selectTrigger(ea.trigger);},focusInput:function(){this.refs.inputField.focusInput&&this.refs.inputField.focusInput();},_inputChanged:function(ea){var fa=this._normalizeInput(ea.target.value),ga=p.getTags();if(ga){var ha=ga.filter(function(ka){return ka.name.indexOf(fa)===0;}),ia=fa.split(/\s+/),ja=ia.map(function(ka){return p.getTagByName(ka);}).filter(function(ka){return ka!==undefined;});if(ja.length!==ia.length)ja=[];this.setState({input:ea.target.value,tagChosen:false,typeaheadTags:ha,singleWordTags:ja,isScrolling:false});}else this.setState({input:ea.target.value,tagChosen:false,isScrolling:false});},_normalizeInput:function(ea){return ea.trim().replace(/\s+/,' ').toLowerCase();},_handleResetButtonClick:function(ea){ea.preventDefault();this.reset();},reset:function(){this.setState(this.getInitialState());},renderContentArea:function(){if(this.state.tagChosen||this._normalizeInput(this.state.input).length>1){return this.renderStickers();}else return m.StickerSearchInRecent?this.renderRecentStickers():this.renderTags();},render:function(){return (k.createElement(k.DOM.div,{className:(("_217a")+(this.state.isScrolling?' '+"_1hg1":''))},k.createElement(k.DOM.div,{className:"_5jdr"},k.createElement(k.DOM.span,{className:"_5jds"}),k.createElement(v,{onChange:this._inputChanged,ref:"inputField",placeholder:"\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e2a\u0e15\u0e34\u0e01\u0e40\u0e01\u0e2d\u0e23\u0e4c",value:this.state.input}),k.createElement(u,{size:"small",onClick:this._handleResetButtonClick,className:((this.state.input.length===0?"hidden_elem":''))})),this.renderContentArea()));},selectTag:function(ea){g.log('StickersLoggerConfig',{event:'select_tag',tagid:ea.id});this.setState({tagChosen:true,typeaheadTags:[ea],singleWordTags:[],input:r.capitalizeWords(ea.name)});this.focusInput();},selectTrigger:function(ea){if(ea!==null){var fa=p.getTagByName(ea);this.setState({tagChosen:true,typeaheadTags:[fa],singleWordTags:[],input:r.capitalizeWords(fa.name)});this.props.resetTrigger();}},_onScroll:function(ea){this.setState({isScrolling:!!ea});},renderStickers:function(){var ea=this._normalizeInput(this.state.input);return (k.createElement(o,{ref:"selector",height:aa-ca,userInput:ea,typeaheadTags:this.state.typeaheadTags,singleWordTags:this.state.singleWordTags,onScroll:this._onScroll,isComments:this.props.isComments,tagChosen:this.state.tagChosen}));},renderRecentStickers:function(){if(this._normalizeInput(this.state.input).length===1)return k.createElement(k.DOM.div,null);return (k.createElement(o,{ref:"selector",height:aa-ca,packID:n.MRU_STICKER_PACK,onScroll:this._onScroll,isComments:this.props.isComments}));},renderTags:function(){var ea=q.getFeaturedTags().filter(function(fa){return fa.sourceURI!==null;}).sort(function(fa,ga){return fa.order-ga.order;}).map(function(fa,ga){return k.createElement(z,{key:ga},k.createElement(k.DOM.div,{className:(("_t5c")+(ga<2?' '+"_1b27":'')+(ga%2===0?' '+"_t5d":'')+(ga%2!==0?' '+"_t5e":''))},k.createElement(t,{image:k.createElement(l,{src:fa.sourceURI}),label:fa.name,onClick:this.selectTag.bind(this,fa),className:"_5jdu",style:{background:'#'+fa.color_code},disabled:this._normalizeInput(this.state.input).length===1})));}.bind(this));return (k.createElement(i,{height:aa-ca,width:ba-16,shadow:true,fade:true,className:"_5jei"},k.createElement(h,{spacing:"pas",cols:2,fixed:true,ref:"grid"},ea)));}});e.exports=da;},null);
__d("StickersFlyout.react",["BanzaiLogger","Event","Keys","MessagesEmoticons.react","Parent","React","StickersFlyoutPackSelector.react","StickersFlyoutStickerSelector.react","StickerActions","StickerConstants","StickerConfig","StickersFlyoutTagSelector.react","StickerSearch","StickerState","SubscriptionsHandler","Toggler","XUISpinner.react","arrayContains","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';var z=p.SEARCH_PACK_ID,aa=l.createClass({displayName:'StickersFlyout',propTypes:{isComments:l.PropTypes.bool,onStickerSelect:l.PropTypes.func.isRequired,onEmoticonSelect:l.PropTypes.func,onShown:l.PropTypes.func,onHidden:l.PropTypes.func,onEscKeyDown:l.PropTypes.func,onPackSelect:l.PropTypes.func,packID:l.PropTypes.string,shown:l.PropTypes.bool,trigger:l.PropTypes.string},getDefaultProps:function(){return {isComments:false,packID:t.getTrayPackID(),shown:false,trigger:null};},getInitialState:function(){return {dataReady:false,numNewPacks:0};},componentDidMount:function(){if(q.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();var ba=k.byClass(this.getDOMNode(),'uiToggle');this._subscriptions=new u();if(ba){this._subscriptions.addSubscriptions(v.listen('show',ba,this._onShownWrapper),v.listen('hide',ba,this._onHidden));}else if(!q.LoadStickerEarly&&this.props.shown&&!this.state.dataReady)this.loadTrayData();this._subscriptions.addSubscriptions(h.listen(this.getDOMNode(),'keydown',this._onKeyDown),t.addListener(t.PACKS_CHANGED,this.packsUpdated),t.addListener(t.NUM_NEW_PACKS_CHANGED,function(ca){this.setState({numNewPacks:ca});}.bind(this)));},_onShownWrapper:function(){if(this.props.onShown){this.props.onShown(this._onShown);}else this._onShown();},_onShown:function(){g.log('StickersLoggerConfig',{event:'open_tray'});if(!q.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();if(this.props.packID===z)this.refs.tagSelector&&this.refs.tagSelector.focusInput();this.refs.packSelector.onFlyoutShown();},_onHidden:function(){this.resetTagSelector();this.props.onHidden&&this.props.onHidden();},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(ba){if(!this.state.dataReady&&ba.shown)this.loadTrayData();},componentDidUpdate:function(ba){if(!ba.shown&&this.props.shown){this._onShown();}else if(ba.shown&&!this.props.shown)this._onHidden();},_onKeyDown:function(event){if(event.keyCode===i.ESC&&this.props.onEscKeyDown){this.props.onEscKeyDown();event.kill();}},resetTagSelector:function(){this.refs.tagSelector&&this.refs.tagSelector.reset();},loadTrayData:function(){t.onTrayDataReady(function(){var ba=t.getNumNewPacks();this.setState({dataReady:true,numNewPacks:ba});var ca=t.getPacksInTray()[0].id,da=this.props.packID;if(!da||!x(t.getPackIDsInTray(),da))o.selectPack(ca,true);}.bind(this));if(q.WebStickerSearch&&!q.StickerSearchOnServer)s.prepareTagsData();},loadPack:function(){if(!this.state.dataReady)return (l.createElement(l.DOM.div,{className:"_e0r"},l.createElement(w,{size:"large"})));if(this.props.packID===p.EMOTICON_PACK_ID)return (l.createElement(l.DOM.div,{className:"_5r8l",'data-id':this.props.packID},l.createElement(j,{onEmoticonSelect:this.props.onEmoticonSelect})));if(this.props.packID===z&&q.WebStickerSearch)return (l.createElement(l.DOM.div,{className:"_5r8l"},l.createElement(r,{ref:"tagSelector",className:"fbStickersFlyoutTagSelector",trigger:this.props.trigger,resetTrigger:function(){return this.setProps({trigger:null});}.bind(this),isComments:this.props.isComments})));return (l.createElement(l.DOM.div,{className:"_5r8l",'data-id':this.props.packID},l.createElement(n,{ref:"selector",packID:this.props.packID,isComments:this.props.isComments})));},packsUpdated:function(){var ba=t.getPackIDsInTray();if(!x(ba,this.props.packID)){o.selectPack(ba[0]);return;}this.forceUpdate(null);},selectedSticker:function(event){var ba=k.byClass(event.target,"_5r8h");if(ba){var ca=ba.getAttribute('data-id');t.updateRecentlyUsed(ca);this.props.onStickerSelect(ca,event);if(q.PromotePackFromSearch&&this.props.packID===p.SEARCH_PACK_ID)t.promotePackSentFromSearch(ca);t.clearShowStickerReplyNUX();}},render:function(){var ba=this.props.isComments?t.getPacksInCommentsTray():t.getPacksInTray();return (l.createElement(l.DOM.div,{className:"_5r8f"},l.createElement(l.DOM.div,{className:"_5r8e"},l.createElement(m,{ref:"packSelector",numNewPacks:this.state.numNewPacks,onPackClick:this.props.onPackSelect,selectedPackID:this.props.packID,packs:ba,isComments:this.props.isComments,resetTagSelectorFunc:this.resetTagSelector})),l.createElement(l.DOM.div,{className:"_5r8m",onClick:this.selectedSticker},this.loadPack())));}});e.exports=aa;},null);
__d("ChatStickerButton.react",["BanzaiODS","React","ReactLayeredComponentMixin","StickerContextualDialog.react","StickersFlyout.react","StickerState","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p=278,q=h.createClass({displayName:'ChatStickerButton',propTypes:{onStickerSelect:h.PropTypes.func,onEmoticonSelect:h.PropTypes.func,onFlyoutShown:h.PropTypes.func,onFlyoutHidden:h.PropTypes.func,packID:h.PropTypes.string},getInitialState:function(){return {shown:false};},mixins:[i],getDefaultProps:function(){return {onStickerSelect:n,onEmoticonSelect:n};},componentDidMount:function(){g.bumpEntityKey('chat.web','sticker_button.mounted');this._subscription=l.addListener(l.PACK_SELECTED,function(r){return this.setProps({packID:r});}.bind(this));},shouldComponentUpdate:function(r,s){return (r.packID!=this.props.packID||s.shown!=this.state.shown);},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){return (h.createElement(h.DOM.a,{className:"_4vuh",onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2a\u0e15\u0e34\u0e01\u0e40\u0e01\u0e2d\u0e23\u0e4c\u0e2b\u0e23\u0e37\u0e2d\u0e2d\u0e35\u0e42\u0e21\u0e15\u0e34\u0e04\u0e2d\u0e19",ref:"link"},h.createElement(h.DOM.div,{className:(("_4vui")+(this.state.shown?' '+"open":''))})));},renderLayers:function(){return {contextualDialog:h.createElement(j,{alignment:"left",className:"_5e-r",contextRef:"link",onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:p},h.createElement(h.DOM.div,null,h.createElement(k,{onShown:function(r){return this.props.onFlyoutShown&&this.props.onFlyoutShown(r);}.bind(this),onHidden:function(){return this.props.onFlyoutHidden&&this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,packID:this.props.packID,shown:this.state.shown})))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(){!this._clickGuard&&this.setState({shown:true});},_hideFlyout:function(){this.setState({shown:false});},_handleStickerSelected:function(r){this.props.onStickerSelect(r);},_handleEmoticonSelected:function(r){this._hideFlyout();this.props.onEmoticonSelect(r);}});e.exports=q;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){var i={propTypes:{attachmentsShelf:h.PropTypes.object,onFileUploaderMounted:h.PropTypes.func,onUploadFinished:h.PropTypes.func,onUpdateAttachmentsShelf:h.PropTypes.func,onSubmit:h.PropTypes.func},setUpSubscriptionsHandler:function(j){this._uploader=j;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();if(!this.props.uploaderIsFromHigherLevel)this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=i;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){'use strict';var m=j.createClass({displayName:'ChatFileUploader',mixins:[g],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){var n=this.props.initFileUploaderFn(this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this.setUpSubscriptionsHandler(n);},render:function(){return (j.createElement(j.DOM.form,{ref:"form",action:i.upload_url,method:"post"},j.createElement(j.DOM.input,{type:"hidden",ref:"attachID",name:"attach_id"}),j.createElement(h,{className:"_m _4q60 itemLabel"},j.createElement(j.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),j.createElement(j.DOM.span,{className:"_4q61 itemAnchor"},"\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e44\u0e1f\u0e25\u0e4c..."))));}});e.exports=m;},null);
__d("ChatTabMenu.react",["ChatFileUploader.react","ChatPrivacyActionController","ChatConfig","MercuryConfig","MercuryFileUploader","MercuryThreadMuter","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Toggler","TrackingNodes","WebMessengerThreadPermalinks","cx","fbt","goURI","MercuryThreads","MercuryThreadActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){'use strict';var w=b('MercuryThreads').get(),x=b('MercuryThreadActions').get(),y=o.Item,z=m.createClass({displayName:'ChatTabMenu',propTypes:{onFileUploaderMounted:m.PropTypes.func,updatePrivacyLinkFunc:m.PropTypes.func,nameConversationFunc:m.PropTypes.func,leaveConversationFunc:m.PropTypes.func,showParticipantsFunc:m.PropTypes.func,clearHistoryFunc:m.PropTypes.func,reportSpamFunc:m.PropTypes.func,createGroupFunc:m.PropTypes.func,isMultichat:m.PropTypes.bool,isEmptyChat:m.PropTypes.bool,showAddFriend:m.PropTypes.func,threadID:m.PropTypes.string,attachmentsShelf:m.PropTypes.object,onUploadFinished:m.PropTypes.func,onUpdateAttachmentsShelf:m.PropTypes.func,onSubmit:m.PropTypes.func,enableDesktopNotif:m.PropTypes.func},getDefaultProps:function(){return {show:true};},componentWillMount:function(){if(!this.props.isMultiChat)this._privacyActionController=new h(w.getCanonicalUserInThread(this.props.threadID),this.props.updatePrivacyLinkFunc);},componentDidMount:function(){if(!this.props.fullURL)s.getThreadURI(this.props.threadID,function(aa){this.isMounted()&&this.setProps({fullURL:aa});}.bind(this));},_initFileUploader:function(aa,ba,ca){if(this._fileUploader){this._fileUploader.updateElements(aa,ba,ca);}else this._fileUploader=new k(this.props.attachmentsShelf,aa,ba,ca);return this._fileUploader;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploader&&this._fileUploader.destroy();},_unmuteThread:function(){x.unmute(this.props.threadID);q.hide();},_renderFileUploader:function(){return (m.createElement(y,{className:"_37_x"},m.createElement(g,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.props.fullURL)return (m.createElement(y,{onclick:function(){return v(this.props.fullURL);}.bind(this)},"\u0e14\u0e39\u0e1a\u0e17\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (m.createElement(y,{onclick:this.props.showAddFriend},"\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32..."));},_renderTogglePrivacy:function(){if(!this.props.isMultichat){var aa=this._privacyActionController.togglePrivacy.bind(this._privacyActionController);return (m.createElement(y,{onclick:aa},this.props.privacyText));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var aa=l.showMuteChangeDialog.bind(null,this.props.threadID);return (m.createElement(y,{onclick:aa},"\u0e1b\u0e34\u0e14\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32..."));}else return (m.createElement(y,{onclick:this._unmuteThread},"\u0e40\u0e1b\u0e34\u0e14\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32"));},_renderClearConversation:function(){if(!this.props.isMultichat)return (m.createElement(y,{onclick:this.props.clearHistoryFunc},"\u0e25\u0e49\u0e32\u0e07\u0e2b\u0e19\u0e49\u0e32\u0e15\u0e48\u0e32\u0e07"));return null;},_renderReportSpam:function(){if(!this.props.isMultichat)return (m.createElement(y,{onclick:this.props.reportSpamFunc},"\u0e23\u0e32\u0e22\u0e07\u0e32\u0e19\u0e27\u0e48\u0e32\u0e40\u0e1b\u0e47\u0e19\u0e2a\u0e41\u0e1b\u0e21\u0e2b\u0e23\u0e37\u0e2d\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e43\u0e19\u0e17\u0e32\u0e07\u0e17\u0e35\u0e48\u0e1c\u0e34\u0e14"));return null;},_renderCreateGroup:function(){if(this.props.isMultichat)return (m.createElement(y,{onclick:this.props.createGroupFunc},"\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e01\u0e25\u0e38\u0e48\u0e21"));return null;},_renderConversationName:function(){if(this.props.isMultichat&&this.props.fullURL)return (m.createElement(y,{onclick:this.props.nameConversationFunc},"\u0e41\u0e01\u0e49\u0e44\u0e02\u0e0a\u0e37\u0e48\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32"));return null;},_renderLeaveConversation:function(){if(this.props.isMultichat)return (m.createElement(y,{onclick:this.props.leaveConversationFunc},"\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32..."));return null;},_renderEnableDesktopNotifications:function(){if(j.DesktopNotificationsGK&&"Notification" in window&&Notification.permission!=="granted")return (m.createElement(y,{onclick:this.props.enableDesktopNotif},"Enable Desktop Notifications"));return null;},_renderPeopleList:function(){if(this.props.isMultichat&&this.props.fullURL&&i.get('chat_remove_participants'))return (m.createElement(y,{onclick:this.props.showParticipantsFunc},"\u0e41\u0e01\u0e49\u0e44\u0e02\u0e1c\u0e39\u0e49\u0e21\u0e35\u0e2a\u0e48\u0e27\u0e19\u0e23\u0e48\u0e27\u0e21..."));return null;},render:function(){var aa=this._renderReportSpam(),ba=this._renderCreateGroup(),ca=m.createElement(o,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),m.createElement(p,null),this._renderMuteConversation(),this._renderClearConversation(),this._renderLeaveConversation(),aa?(m.createElement(p,null)):null,aa,ba?(m.createElement(p,null)):null,ba,this._renderEnableDesktopNotifications()),da="\u0e15\u0e31\u0e27\u0e40\u0e25\u0e37\u0e2d\u0e01",ea=r.getTrackingInfo(r.types.DROPDOWN_BUTTON);return (m.createElement(n,{menu:ca},m.createElement(m.DOM.a,{'data-ft':ea,'data-hover':"tooltip",'aria-label':da,'data-tooltip-alignh':"center",className:(("button")+(this.props.isEmptyChat?' '+"hidden_elem":''))})));}});e.exports=z;},null);
__d("ChatDateBreak.react",["React","ReactPropTypes","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'ChatDateBreak',propTypes:{date:h.instanceOf(Date).isRequired},shouldComponentUpdate:function(n){return this.props.date.getTime()!==n.date.getTime();},render:function(){var n=this.props.date,o=k(n,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'}),p=Math.round(n.getTime()/1000);return (g.createElement(g.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5w-5")}),g.createElement(g.DOM.div,{className:"_5w-6"},g.createElement(i,{time:p,verbose:o,text:o}))));}});e.exports=m;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","ReactPropTypes","React","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=86400000,n=i.createClass({displayName:'ChatAuthorPhotoBlock',propTypes:{authorID:h.string.isRequired,hideName:h.bool,hidePhoto:h.bool,timestamp:h.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(o){if(o.authorID!=this.state.author.id)this.updateAuthor(o.authorID);},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (i.createElement(i.DOM.div,{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var o=null;if(this.props.timestamp){var p=(Date.now()-this.props.timestamp>m)?'M jS, g:ia':'g:ia';o=k(new Date(this.props.timestamp),p);}return (i.createElement(i.DOM.a,{'aria-label':o,className:"_5ys_",'data-hover':"tooltip",'data-tooltip-position':"left",href:this.state.author.href,ref:"link"},i.createElement(i.DOM.img,{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(o){g.get(o,function(p){this.isMounted()&&this.setState({author:p});}.bind(this));}});e.exports=n;},null);
__d("ChatBubble.react",["DOMDimensions","MercuryMessageBody.react","ReactPropTypes","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=null,n=j.createClass({displayName:'ChatBubble',propTypes:{attachments:i.renderable,body:i.string,maxWidth:i.number.isRequired},getInitialState:function(){return {bubbleWidth:this.props.maxWidth};},componentDidMount:function(){this.shrinkBubble();},componentWillReceiveProps:function(o){if(o.body!=this.props.body)this.setState({bubbleWidth:this.props.maxWidth});},componentDidUpdate:function(o,p){if(o.body!=this.props.body)this.shrinkBubble();},render:function(){return (j.createElement(j.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5w1r"),ref:"bubble",style:Object.assign({},(this.props.style||{}),{maxWidth:this.state.bubbleWidth})}),j.createElement(j.DOM.div,null,j.createElement(j.DOM.span,{className:"_5yl5",ref:"content"},j.createElement(h,{body:this.props.body}))),this.props.attachments));},shrinkBubble:function(){var o=this.refs.bubble.getDOMNode(),p=this.refs.content.getDOMNode(),q=g.getElementDimensions(o).width,r=g.getElementDimensions(p).width;if(this.contentWraps()&&r>0&&r<this.props.maxWidth&&q-r-this.getBoxWidth()>0&&r!=this.state.bubbleWidth)this.setState({bubbleWidth:r});},contentWraps:function(){var o=this.refs.content.getDOMNode(),p=o.getClientRects(),q=g.getElementDimensions(o).height;return (p&&p.length>1&&p[0].height<q);},getBoxWidth:function(){if(!m)m=g.measureElementBox(this.refs.bubble.getDOMNode(),'width',true,true,false);return m;}});e.exports=n;},null);
__d("XStickerAssetControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/asset\/",{sticker_id:{type:"Int",required:true},image_type:{type:"Enum"}});},null);
__d("MercuryAttachmentRenderer",["MercuryAttachmentTemplates","MercuryAttachmentAudioClip.react","Bootloader","ChatAnimatedGifs","SyncRequest.react","CSS","MercuryConstants","DOM","Event","MercuryAttachment","MercuryAttachmentType","MercuryAttachmentVideo.react","MercuryIDs","MercuryParticipants","ProgressBar","React","Sticker.react","StickerAssetType","Style","URI","UserAgent_DEPRECATED","cx","endsWith","invariant","tx","updatePhotoProgressBar","XStickerAssetControllerURIBuilder","OrionMercuryAttachment","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){"use strict";var ha=b('OrionMercuryAttachment').module,ia=b('MercuryMessages').get(),ja=aa.ie()<=8;function ka(na,oa){var pa=g[oa].build().setNodeContent('filename',na.name),qa=pa.getNode('link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);l.addClass(pa.getRoot(),p.getAttachIconClass(na.icon_type));return pa;}function la(na,oa){var pa=g[oa].build().setNodeContent('filename',na.name);l.addClass(pa.getRoot(),p.getAttachIconClass(na.icon_type));return pa;}var ma={renderAttachment:function(na,oa,pa,qa,ra,sa){var ta=100,ua=na?160:400,va=null,wa=null,xa=m.MercurySupportedShareType;if(this.isErrorAttachment(oa))va=ma.renderError(oa);if(this.isShareAttachment(oa)&&oa.share_xhp)if(oa.share_data_type===xa.FB_BROWSE_QUERY||!na)wa=ma.renderShareXHP(oa,pa.id);if(this.isStickerAttachment(oa))wa=ma.renderSticker(oa,pa,na,sa);if(!wa&&this.isShareAttachment(oa)){var ya=oa.share_data_type;switch(ya){case xa.FB_PHOTO:wa=ma.renderPreview(oa,pa,qa,ra);break;case xa.FB_VIDEO:wa=ma.renderVideoThumb(oa);break;case xa.FB_MUSIC_ALBUM:case xa.FB_SONG:case xa.FB_PLAYLIST:case xa.FB_MUSICIAN:case xa.FB_RADIO_STATION:wa=ma.renderMusic(oa);break;case xa.EXTERNAL:case xa.FB_TEMPLATE:case xa.FB_SOCIAL_REPORT_PHOTO:wa=ma.renderExternalLink(oa);break;case xa.FB_COUPON:case xa.FB_EVENT:case xa.FB_SHOERACK_INVITATION:wa=ma.renderChatXHP(oa);break;case xa.FB_SOCIAL_RESOLUTION:case xa.FB_STATUS:wa=ma.renderSocialResolution(oa);break;case xa.FB_SYNC_REQUEST:wa=ma.renderSyncRequest(oa);break;case xa.FB_OPEN_GRAPH:wa=ma.renderOpenGraph(oa);break;case xa.FB_ORION:if(ha)wa=ma.renderOrionMercuryAttachment(oa);break;default:if(oa.name)wa=ma.renderShareLink(oa,pa&&pa.id,na);break;}}if(!wa&&oa.preview_loading)wa=ma.renderPreview(oa,pa,qa,ra);if(!wa&&this.isVideoAttachment(oa)){wa=n.create('div');v.renderComponent(ma.renderVideo(oa,na),wa);}if(!wa&&oa.preview_url)wa=ma.renderPreview(oa,pa,qa,ra);if(!wa&&this.isFileAttachment(oa))if(oa.metadata&&oa.metadata.type==m.MercuryAttachmentAudioClip){wa=n.create('div');var za=ma.renderAudioClip(oa,pa.message_id,ta,ua);v.renderComponent(za,wa);}else wa=na?ma.renderFileLink(oa):ma.renderExtendedFileLink(oa);return {error:va,content:wa,bubblePreferred:this.isBubblePreferred(oa)};},isBubblePreferred:function(na){return !this.isStickerAttachment(na)&&!this.isSyncRequestAttachment(na);},renderError:function(na){var oa=g[':fb:mercury:attachment:error'].build();n.appendContent(oa.getNode('error'),na.error_msg);return oa.getRoot();},renderSocialResolution:function(na){var oa=g[':fb:mercury:attachment:social-resolution'].build();oa.setNodeContent('post',na.share_xhp);return oa.getRoot();},renderChatXHP:function(na){var oa=g[':fb:mercury:attachment:social-resolution'].build();oa.setNodeContent('post',na.chat_xhp);return oa.getRoot();},renderOpenGraph:function(na){var oa=na.share_xhp.cloneNode(true);if(aa.firefox())y.set(oa,'minWidth','180px');return oa;},renderExternalLink:function(na){var oa=g[':fb:mercury:attachment:external-link'].build().setNodeContent('name',na.name);na.base_url&&oa.setNodeContent('shortLink',na.base_url);var pa=oa.getNode('preview'),qa=oa.getNode('image-link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);if(na.preview_url){var ra=oa.getNode('preview-image'),sa=na.preview_url,ta=z(j.getRawUrlFromSafeUrl(sa));if(ca(ta.getPath(),'.gif')){sa=z('/animated.php').setSecure(true).setDomain('www.fbsbx.com').addQueryData('url',ta.toString());l.addClass(pa,"_dri");if(na.name&&na.name.__html==ta.toString())oa.setNodeContent('name','');}ra.setAttribute('src',sa);l.addClass(pa,na.preview_class);l.show(ra);}else{l.addClass(oa.getRoot(),'noMedia');l.hide(pa);}oa.getNode('name').setAttribute('href',na.url);d(['LinkshimHandler'],function(ua){ua.setUpLinkshimHandling(oa.getNode('name'));ua.setUpLinkshimHandling(oa.getNode('image-link'));});if(na.rel)oa.getNode('name').setAttribute('rel',na.rel);return oa.getRoot();},renderFileLink:function(na){var oa=null;if(na.url===''){oa=':fb:mercury:attachment:file-name';return la(na,oa).getRoot();}else{oa=':fb:mercury:attachment:file-link';return ka(na,oa).getRoot();}},renderAudioClip:function(na,oa,pa,qa){var ra=na.metadata.duration/1000,sa=200;if(pa&&qa)if(ra<5){sa=pa;}else sa=(1-Math.pow(10,(ra-5)/-30))*(qa-pa)+pa;return v.createElement(h,{src:na.url,duration:na.metadata.duration/1000,showHelp:false,width:sa});},renderVideo:function(na,oa){var pa={height:na.preview_height,width:na.preview_width},qa=oa?{width:160,height:120}:{width:266,height:200};return v.createElement(r,{duration:na.metadata.duration,name:na.name,size:qa,thumbnailSize:pa,thumbnail:na.thumbnail_url,videoID:na.metadata.fbid});},renderExtendedFileLink:function(na){var oa=null;if(na.url===''){oa=':fb:mercury:attachment:file-name';return la(na,oa).getRoot();}oa=':fb:mercury:attachment:extended-file-link';var pa=ka(na,oa);if(na.open_url){var qa=pa.getNode('openLinkContainer');l.show(qa);var ra=pa.getNode('openFile');ra.setAttribute('href',na.open_url);}var sa=pa.getNode('downloadFile');sa.setAttribute('href',na.url);na.rel&&sa.setAttribute('rel',na.rel);return pa.getRoot();},renderMusic:function(na){var oa=g[':fb:mercury:attachment:music'].build().setNodeContent('filename',na.name),pa=oa.getNode('link');pa.setAttribute('href',na.url);pa.setAttribute('target','_blank');na.rel&&pa.setAttribute('rel',na.rel);var qa=oa.getNode('image-link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);var ra=oa.getNode('preview-image');ra.setAttribute('src',na.preview_url);l.show(ra);l.addClass(oa.getNode('icon_link'),'MercuryMusicIcon');return oa.getRoot();},renderSyncRequest:function(na){var oa=k(na.metadata),pa=n.create('div');v.renderComponent(oa,pa);return pa;},renderOrionMercuryAttachment:function(na){var oa=v.createElement(ha,Object.assign({},na.metadata)),pa=n.create('div');v.renderComponent(oa,pa);return pa;},resizeContain:function(na,oa){var pa=na.width/na.height,qa=oa.width/oa.height;if(qa<pa){return {width:Math.min(na.height*qa,oa.width),height:Math.min(na.height,oa.height)};}else return {width:Math.min(na.width,oa.width),height:Math.min(na.width/qa,oa.height)};},renderPreview:function(na,oa,pa,qa){var ra=g[':fb:mercury:attachment:preview'].build(),sa=ra.getNode('image-link');if(na){if(na.url){var ta=new z(na.url).getQueryData().uri;if(ta&&na.rel==='async'){sa.setAttribute('href',ta);sa.setAttribute('ajaxify',na.url);}else sa.setAttribute('href',na.url);}na.rel&&sa.setAttribute('rel',na.rel);var ua;if(na.preview_uploading){var va=ra.getNode('cancel-button-container');l.show(va);var wa=ra.getNode('cancel-button'),xa=o.listen(wa,'click',function(){na.upload_canceled(na.upload_id);l.hide(ra.getRoot());xa.remove();});na.on_success(function(event,fb){if(fb.upload_id==na.upload_id){l.hide(va);xa.remove();}});var ya=ra.getNode('progress-bar'),za=new u(ya),ab=ra.getNode('progress-bar-container');da(na.upload_id);na.on_progress(function(event,fb){if(fb.upload_id==na.upload_id){l.removeClass(ab,"_395w");l.show(ab);fa(za,fb.event);}});if(na.on_resizing_progress)na.on_resizing_progress(function(event,fb){if(fb.upload_id==na.upload_id){l.addClass(ab,"_395w");l.show(ab);za.setPosition(100*fb.event.written/fb.event.total);}});l.addClass(sa,"_57jm");if(pa>=176){ua='/images/photos/dots_large.png';}else if(pa>=86){ua='/images/photos/dots_medium.png';}else ua='/images/photos/dots_small.png';y.set(sa,'width',pa+'px');y.set(sa,'max-width',pa+'px');if(na.preview_width&&na.preview_height)y.set(sa,'padding-bottom',((na.preview_height/na.preview_width)*100)+'%');}else if(na.preview_loading){l.addClass(sa,"_5xdv");if(qa==='contain'&&na.preview_width&&na.preview_height){y.set(sa,'width',na.preview_width+'px');y.set(sa,'height',na.preview_height+'px');}if(qa==='cover'&&!ja)l.addClass(sa,"_55pj");}else if(na.metadata&&na.metadata.fbid){ua=z('/ajax/mercury/attachments/photo.php').addQueryData({fbid:na.metadata.fbid,request_user_id:na.metadata.pageid,mode:qa,width:pa,height:pa}).toString();var bb=sa.getAttribute('ajaxify');sa.removeAttribute('ajaxify');sa.removeAttribute('rel');o.listen(sa,'click',function(event){event.prevent();i.loadModules(["MessagesViewer"],function(fb){fb.bootstrapWithConfig({src:ua,endpoint:bb,fbid:na.metadata.fbid,dimensions:na.metadata.dimensions,disablePaging:oa&&oa.attachments.length==1},sa);});});}else{var cb=z(na.preview_url);qa&&cb.addQueryData({mode:qa});pa&&cb.addQueryData({width:pa,height:pa});ua=cb.toString();}var db=ra.getNode('preview-image');if(ua){if(qa==='contain'&&na.preview_width&&na.preview_height){var eb=ma.resizeContain({width:pa,height:pa},{width:na.preview_width,height:na.preview_height});db.setAttribute('width',eb.width);db.setAttribute('height',eb.height);}if(na.preview_uploading||(qa==='cover'&&!ja)){l.addClass(sa,"_55pj");y.set(sa,'backgroundImage','url('+ua+')');}else{db.onload=function(){db.removeAttribute('width');db.removeAttribute('height');};db.setAttribute('src',ua);}}if(oa)this.renderReportRespondLink(ra.getRoot(),na,oa.message_id);}return ra.getRoot();},renderShareLink:function(na,oa,pa){var qa=g[':fb:mercury:attachment:share-link'].build().setNodeContent('name',na.name),ra=qa.getNode('link');ra.setAttribute('href',na.url);na.rel&&ra.setAttribute('rel',na.rel);return qa.getRoot();},renderVideoThumb:function(na){var oa=g[':fb:mercury:attachment:video-thumb'].build(),pa=oa.getNode('thumb');pa.setAttribute('href',na.url);pa.setAttribute('rel',na.rel);var qa=n.find(oa.getRoot(),'img');qa.src=na.preview_url;return oa.getRoot();},renderShareXHP:function(na,oa){var pa=n.create('div');if(na){n.appendContent(pa,na.share_xhp);this.renderReportRespondLink(pa,na,oa);}return pa;},renderSticker:function(na,oa,pa,qa){var ra=pa?'chatScrolled/':'messengerScrolled/';ra+=oa.thread_id;var sa=n.create('div');l.addClass(sa,'stickerContainer');var ta=null;if(na.metadata.stickerID)ta=na.metadata.stickerID.toString();var ua=null;if(na.metadata.packID)ua=na.metadata.packID.toString();var va=new ga().setInt('sticker_id',ta),wa=null,xa=null;if(window.devicePixelRatio&&window.devicePixelRatio>1){xa=na.metadata.paddedSpriteURI2x;wa=na.metadata.spriteURI2x;}else{xa=na.metadata.paddedSpriteURI;wa=na.metadata.spriteURI;}var ya=v.createElement(w,{animationTrigger:"hover",className:"mvs",frameCount:na.metadata.frameCount||1,frameRate:na.metadata.frameRate||83,framesPerCol:na.metadata.framesPerCol||1,framesPerRow:na.metadata.framesPerRow||1,onStickerClick:qa,packID:ua,paddedSpriteURI:xa,sourceHeight:na.metadata.height,sourceURI:va.setEnum('image_type',x.IMAGE).getURI().toString(),sourceWidth:na.metadata.width,spriteURI:wa,stickerID:ta,subscribedThreadID:ra});v.renderComponent(ya,sa);return sa;},renderReportRespondLink:function(na,oa,pa){if(!oa.is_social_report_attachment)return null;switch(oa.share_data_type){case m.MercurySupportedShareType.FB_PHOTO:break;case m.MercurySupportedShareType.FB_SOCIAL_REPORT_PHOTO:return null;default:return null;}var qa=null;if(pa)qa=ia.getMessagesFromIDs([pa])[0];if(!qa)return null;if(qa.author===t.user)return null;var ra=null;t.get(qa.author,function(sa){ra=n.create('a',{rel:'dialog-post',className:"_z6l",id:'respond-link',ajaxify:z('/ajax/report/social_resolution/post/').setQueryData({attachment_fbid:oa.attach_id,post_fbid:oa.shared_object_id,sender_id:s.getUserIDFromParticipantID(sa.id)}).toString()});n.setContent(ra,ea._("\u0e15\u0e2d\u0e1a\u0e23\u0e31\u0e1a\u0e04\u0e33\u0e23\u0e49\u0e2d\u0e07\u0e02\u0e2d\u0e02\u0e2d\u0e07 {name}",{name:sa.name}));n.appendContent(na,ra);});},renderPhotoAttachments:function(na,oa,pa,qa){var ra=na.length;if(!ra)return null;var sa=n.create('div',{className:"_55pk"});if(ra===1){var ta=ma.renderPreview(na[0],oa,pa,'contain');n.appendContent(sa,ta);return sa;}var ua=(ra==2||ra==4)?2:3,va=(pa-(ua-1)*qa)/ua,wa=Math.ceil(ra/ua),xa=wa*va+(wa-1)*qa,ya=n.create('div',{className:"_55pm",style:'padding-bottom: '+(xa/pa*100)+'%;'});n.appendContent(sa,ya);for(var za=0;za<ra;++za){var ab=ma.renderPreview(na[za],oa,va,'cover'),bb=za%ua,cb=Math.floor(za/ua);l.addClass(ab,"_55pn");y.apply(ab,{width:(va/pa*100)+'%',left:((bb*(va+qa))/pa*100)+'%',top:((cb*(va+qa))/xa*100)+'%'});n.appendContent(ya,ab);}return sa;},isPhotoAttachment:function(na){return na.attach_type==q.PHOTO||(na.attach_type==q.FILE&&na.preview_url);},isVideoAttachment:function(na){return na.attach_type==q.VIDEO;},isShareAttachment:function(na){return na.attach_type==q.SHARE;},isFileAttachment:function(na){return na.attach_type==q.FILE;},isErrorAttachment:function(na){return na.attach_type==q.ERROR;},isStickerAttachment:function(na){return na.attach_type==q.STICKER;},isSyncRequestAttachment:function(na){var oa=m.MercurySupportedShareType;return this.isShareAttachment(na)&&na.share_data_type==oa.FB_SYNC_REQUEST;},booleanLexicographicComparator:function(na){return function(oa,pa){for(var qa=0;qa<na.length;++qa){var ra=na[qa](oa),sa=na[qa](pa);if(ra&&!sa){return -1;}else if(!ra&&sa)return 1;}return 0;};}};e.exports=ma;},null);
__d("MercuryAttachments.react",["MercuryAttachmentRenderer","DOM","Event","ImmutableObject","React","SubscriptionsHandler","arraySort","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=176,r=4,s=k.createClass({displayName:'MercuryAttachments',propTypes:{message:k.PropTypes.instanceOf(j).isRequired,attachments:k.PropTypes.array.isRequired,isChat:k.PropTypes.bool,onImageLoad:k.PropTypes.func,onStickerClick:k.PropTypes.func},getDefaultProps:function(){return {isChat:false,onImageLoad:o,onStickerClick:o};},componentDidMount:function(){this._subscriptionsHandler=new l();this.renderAttachments();},componentDidUpdate:function(){this.renderAttachments();},componentWillUnmount:function(){this._subscriptionsHandler.release();},render:function(){var t=this.props.attachments.filter(g.isPhotoAttachment).length>0;return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:p(this.props.className,(("_5h9y")+(t?' '+"_zl6":'')))})));},renderAttachments:function(){var t=this.getDOMNode();h.empty(t);var u=this.props.message,v=m(this.props.attachments,g.booleanLexicographicComparator([g.isPhotoAttachment,g.isShareAttachment,g.isFileAttachment,g.isErrorAttachment])),w=g.renderPhotoAttachments(v.filter(g.isPhotoAttachment),u,q,r);w&&h.appendContent(t,w);for(var x=0;x<v.length;x++){var y=v[x];if(g.isPhotoAttachment(y))continue;var z=g.renderAttachment(this.props.isChat,y,u,null,null,this.props.onStickerClick);z.error&&h.appendContent(t,z.error);z.content&&h.appendContent(t,z.content);}h.scry(t,'img').forEach(function(aa){this._subscriptionsHandler.addSubscriptions(i.listen(aa,'load',function(){this.props.onImageLoad(aa);}.bind(this)));}.bind(this));}});e.exports=s;},null);
__d("MercurySpoofWarning.react",["MercuryParticipants","ReactPropTypes","React","fbt"],function(a,b,c,d,e,f,g,h,i,j){var k=i.createClass({displayName:'MercurySpoofWarning',propTypes:{authorID:h.string.isRequired},getInitialState:function(){return {author:{name:''}};},componentWillMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(l){g.get(l.authorID,function(m){return this.setState({author:m});}.bind(this));},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props),j._("Unable to confirm {name_or_email} as the sender.",[j.param("name_or_email",this.state.author.name)])));}});e.exports=k;},null);
__d("ChatMessage.react",["ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","ChatConfig","CSS","ImmutableObject","MercuryAttachment","MercuryAttachments.react","MercuryAttachmentRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercurySpoofWarning.react","React","ReactPropTypes","cx","fbt","formatDate","isRTL","joinClasses","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){'use strict';var aa=b('MercuryMessages').get(),ba=t.createClass({displayName:'ChatMessage',propTypes:{message:u.instanceOf(l).isRequired,maxBubbleWidth:u.number.isRequired,onImageLoad:u.func,onStickerClick:u.func},componentDidMount:function(){k.conditionClass(this.getDOMNode(),"_2cnu",this.isOneLine());},isOneLine:function(){var ca=this.props.message;return aa.isInbound(ca)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps();},shouldComponentUpdate:function(ca,da){return ca.message!==this.props.message;},render:function(){var ca=this.props.message,da=aa.isInbound(ca),ea=q.isMultichat(ca.thread_id),fa=y(ca.body),ga=j.get('chat_fading_bubbles')&&!da&&aa.isSending(ca),ha=p.hasErrorStatus(ca),ia=(("_5wd4")+(da?' '+"_1nc7":'')+(!da?' '+"_1nc6":'')+(da&&ea?' '+"_5ysy":'')+(ga?' '+"_4oe5":'')+(ha?' '+"_1zcs":'')+(fa?' '+"direction_rtl":'')+(!fa?' '+"direction_ltr":'')),ja=new Date(ca.timestamp);return (t.createElement(h,Object.assign({},this.props,{authorID:ca.author,className:z(this.props.className,ia),hideName:!da||!ea,hidePhoto:!da,timestamp:ca.timestamp,title:da?null:x(ja,'g:ia')}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){if(this.props.message.is_filtered_content)return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderFilteredContent()));return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (t.createElement(t.DOM.div,{className:"_3ry4",ref:"undertext"},t.createElement(r,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?t.createElement(s,{authorID:this.props.message.author,className:"_5wdb"}):null);},_renderFilteredContent:function(){return t.createElement(t.DOM.div,{className:"_5wdc uiBoxYellow clearfix"},"This message is no longer available because it was identified as abusive or marked as spam.");},_renderAttachments:function(ca){var da=this.props.message,ea=ca=='inside'?'attachmentsInside':'attachmentsOutside',fa=m.get(da).filter(function(ga){var ha=o.isBubblePreferred(ga);return (ha&&ca==='inside')||(!ha&&ca==='outside');});if(fa.length>0)return t.createElement(n,{className:"_5wdd clearfix",isChat:true,message:da,attachments:fa,ref:ea,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick});},_renderBubble:function(){var ca=this.props.message,da=ca.body,ea=this._renderAttachments('inside');if(g.shouldHideBody(ca))da='';if(da||ea)return (t.createElement(t.DOM.div,{className:"_5wde"},t.createElement(i,{attachments:ea,body:da,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ref:"bubble"})));}});e.exports=ba;},null);
__d("ChatVideoCallLink.react",["Arbiter","ChatVisibility","MercuryParticipants","PresencePrivacy","React","ReactPropTypes","SubscriptionsHandler","VideoCallCore","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=k.createClass({displayName:'ChatVideoCallLink',propTypes:{message:l.object.isRequired,onClick:l.func.isRequired},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(g.subscribe(['buddylist/availability-changed'],this.availabilityChanged),j.subscribe(['privacy-changed','privacy-availability-changed'],this.availabilityChanged));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){return (k.createElement(k.DOM.a,{className:(("callBackLink")+(this.shouldHideLink()?' '+"hidden_elem":'')),'data-gt':JSON.stringify({videochat:'clicked_callback_link'}),href:"#",onClick:this.linkClicked},this.renderLinkText()));},renderLinkText:function(){if(this.props.message.log_message_data.event_name=='install_canceled'){return ("\u0e25\u0e2d\u0e07\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32\u0e41\u0e25\u0e49\u0e27\u0e42\u0e17\u0e23\u0e01\u0e25\u0e31\u0e1a\u0e21\u0e32\u0e43\u0e2b\u0e21\u0e48");}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)return ("\u0e42\u0e17\u0e23\u0e01\u0e25\u0e31\u0e1a");},shouldHideLink:function(){return !h.isOnline()||!n.availableForCall(this.props.message.log_message_data.to);},linkClicked:function(){var r;if(this.props.message.log_message_data.event_name=='install_canceled'){r='callback_cancelinstall_link';}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)r='callback_link';this.props.onClick(this.props.message.log_message_data.to,this.props.message.thread_id,r);},availabilityChanged:function(){this.forceUpdate();}});e.exports=q;},null);
__d("MercuryLogMessageRenderer",["MercuryAttachmentRenderer","CSS","DOM","HovercardLink","MercuryLogMessageType","MercuryParticipants","React","Image.react","TooltipLink.react","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s={renderText:function(la,ma){switch(la.log_message_type){case k.SUBSCRIBE:u(la,ma);break;case k.UNSUBSCRIBE:z(la,ma);break;case k.VIDEO_CALL:aa(la,ma);break;case k.PHONE_CALL:ca(la,ma);break;case k.THREAD_NAME:da(la,ma);break;case k.THREAD_IMAGE:ea(la,ma);break;case k.WALLPAPER:fa(la,ma);break;case k.SERVER_ERROR:ga(la,ma);break;}},renderIcon:function(la){return (m.createElement(n,{className:t(la),src:r('images/spacer.gif')}));},renderLegacy:function(la,ma,na,oa){t(oa).split(' ').forEach(function(pa){return pa&&h.addClass(la,pa);});this.renderText(oa,function(pa){m.renderComponent(m.createElement(m.DOM.span,null,pa),ma);});this.renderAttachmentLegacy(na,oa);},renderAttachmentLegacy:function(la,ma){if(ma.log_message_type==k.THREAD_IMAGE){var na=ma.log_message_data.image;if(na){var oa=g.renderPreview(na.preview_url?na:null);i.setContent(la,oa);h.addClass(oa,"_z6a");h.show(la);}}}};e.exports=s;function t(la){var ma=la.log_message_type,na=la.log_message_data;return (("_5wzu")+(ma==k.SUBSCRIBE?' '+"_5wzj":'')+(ma==k.UNSUBSCRIBE?' '+"_5wzk":'')+(ma==k.THREAD_NAME?' '+"_5wzl":'')+(ma==k.THREAD_IMAGE?' '+"_5wzm":'')+(ma==k.VIDEO_CALL&&(na.answered||ka(la))?' '+"_5wzn":'')+(ma==k.VIDEO_CALL&&!(na.answered||ka(la))?' '+"_5wzo":'')+(ma==k.PHONE_CALL&&na.answered?' '+"_5wzp":'')+(ma==k.PHONE_CALL&&!na.answered?' '+"_5wzq":'')+(ma==k.SERVER_ERROR?' '+"_5wzr":''));}function u(la,ma){var na=ja(la.log_message_data.added_participants);switch(na.length){case 1:v(la,ma,na);break;case 2:w(la,ma,na);break;case 3:x(la,ma,na);break;default:y(la,ma,na);break;}}function v(la,ma,na){var oa=[la.author,na[0]];l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("\u0e04\u0e38\u0e13\u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1} \u0e41\u0e25\u0e49\u0e27",[q.param("subscriber1",ia(pa[na[0]]))]));}else if(na[0]==l.user){ma(q._("{actor} \u0e44\u0e14\u0e49\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e04\u0e38\u0e13",[q.param("actor",ia(pa[la.author]))]));}else ma(q._("{actor} \u0e40\u0e1e\u0e34\u0e48\u0e21\u0e41\u0e25\u0e49\u0e27 {subscriber1}",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]]))]));});}function w(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("\u0e04\u0e38\u0e13\u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1} \u0e41\u0e25\u0e30 {subscriber2}",[q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]]))]));}else if(na[0]==l.user){ma(q._("{actor} \u0e44\u0e14\u0e49\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e04\u0e38\u0e13\u0e41\u0e25\u0e30 {subscriber2}",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(pa[na[1]]))]));}else ma(q._("{actor} \u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1} \u0e41\u0e25\u0e30 {subscriber2} \u0e41\u0e25\u0e49\u0e27",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]]))]));});}function x(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("\u0e04\u0e38\u0e13\u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1}, {subscriber2} \u0e41\u0e25\u0e30 {subscriber3} \u0e41\u0e25\u0e49\u0e27",[q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));}else if(na[0]==l.user){ma(q._("{actor} \u0e44\u0e14\u0e49\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e04\u0e38\u0e13 {subscriber2} \u0e41\u0e25\u0e30 {subscriber3}",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));}else ma(q._("{actor} \u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1}, {subscriber2} \u0e41\u0e25\u0e30 {subscriber3} \u0e41\u0e25\u0e49\u0e27",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));});}function y(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){function qa(sa){var ta=m.createElement(m.DOM.div,null,sa.map(function(ua){return m.createElement(m.DOM.div,null,ua.name);}));return (m.createElement(o,{alignH:"center",position:"above",tooltip:ta},q._("\u0e2d\u0e35\u0e01 {num}",[q.param("num",sa.length)])));}var ra=na.map(function(sa){return pa[sa];});if(la.author==l.user){ma(q._("\u0e04\u0e38\u0e13\u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1}, {subscriber2} \u0e41\u0e25\u0e30 {more_people} \u0e41\u0e25\u0e49\u0e27",[q.param("subscriber1",ia(ra[0])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));}else if(na[0]==l.user){ma(q._("{actor} \u0e44\u0e14\u0e49\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e04\u0e38\u0e13, {subscriber2} \u0e41\u0e25\u0e30{more_people}",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));}else ma(q._("{actor} \u0e40\u0e1e\u0e34\u0e48\u0e21 {subscriber1}, {subscriber2} \u0e41\u0e25\u0e30 {more_people} \u0e41\u0e25\u0e49\u0e27",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(ra[0])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));});}function z(la,ma){var na=[la.author],oa=la.log_message_data.removed_participants,pa;if(oa.length===1){pa=oa[0];na.push(pa);}l.getMulti(na,function(qa){var ra=qa[la.author],sa=qa[pa];if(la.author==l.user){if(!pa||pa==la.author){ma("\u0e04\u0e38\u0e13\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e41\u0e25\u0e49\u0e27");}else ma(q._("\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e25\u0e1a {name} \u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e19\u0e35\u0e49\u0e41\u0e25\u0e49\u0e27",[q.param("name",ia(sa))]));}else if(!pa||pa==la.author){ma(q._("{actor} \u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32",[q.param("actor",ia(ra))]));}else if(pa==l.user){ma(q._("{actor} \u0e44\u0e14\u0e49\u0e25\u0e1a\u0e04\u0e38\u0e13\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e19\u0e35\u0e49\u0e41\u0e25\u0e49\u0e27",[q.param("actor",ia(ra))]));}else ma(q._("{actor} \u0e44\u0e14\u0e49\u0e25\u0e1a {name} \u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e19\u0e35\u0e49",[q.param("actor",ia(ra)),q.param("name",ia(sa))]));});}function aa(la,ma){if(ka(la)){ba(la,ma);return;}var na=la.log_message_data.caller,oa=la.log_message_data.callee,pa=[na,oa];l.getMulti(pa,function(qa){var ra=ha(qa[oa]);if(na==l.user){if(la.log_message_data.answered){ma(q._("\u0e04\u0e38\u0e13\u0e42\u0e17\u0e23\u0e2b\u0e32 {firstname}",[q.param("firstname",ra)]));}else ma(q._("{firstname} \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a\u0e2a\u0e32\u0e22\u0e08\u0e32\u0e01\u0e04\u0e38\u0e13",[q.param("firstname",ra)]));}else{var sa=ha(qa[na]);if(la.log_message_data.answered){ma(q._("{firstname} \u0e42\u0e17\u0e23\u0e2b\u0e32\u0e04\u0e38\u0e13",[q.param("firstname",sa)]));}else ma(q._("\u0e04\u0e38\u0e13\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a\u0e2a\u0e32\u0e22\u0e08\u0e32\u0e01 {firstname}",[q.param("firstname",sa)]));}});}function ba(la,ma){l.get(la.log_message_data.callee,function(na){var oa=ha(na);switch(la.log_message_data.event_name){case 'installing':ma(q._("{firstname} \u0e01\u0e33\u0e25\u0e31\u0e07\u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32\u0e01\u0e32\u0e23\u0e04\u0e38\u0e22\u0e41\u0e1a\u0e1a\u0e40\u0e2b\u0e47\u0e19\u0e2b\u0e19\u0e49\u0e32...",[q.param("firstname",oa)]));break;case 'installed':ma(q._("{firstname} \u0e15\u0e31\u0e49\u0e07\u0e04\u0e48\u0e32\u0e01\u0e32\u0e23\u0e04\u0e38\u0e22\u0e41\u0e1a\u0e1a\u0e40\u0e2b\u0e47\u0e19\u0e2b\u0e19\u0e49\u0e32\u0e40\u0e2a\u0e23\u0e47\u0e08\u0e41\u0e25\u0e49\u0e27",[q.param("firstname",oa)]));break;case 'install_canceled':ma("\u0e04\u0e38\u0e13\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01\u0e01\u0e32\u0e23\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e01\u0e32\u0e23\u0e04\u0e38\u0e22\u0e41\u0e1a\u0e1a\u0e40\u0e2b\u0e47\u0e19\u0e2b\u0e19\u0e49\u0e32");break;}});}function ca(la,ma){var na=la.log_message_data.caller,oa=la.log_message_data.callee,pa=[na,oa];l.getMulti(pa,function(qa){if(na==l.user){var ra=ha(qa[oa]);if(la.log_message_data.answered){ma(q._("\u0e04\u0e38\u0e13\u0e42\u0e17\u0e23\u0e2b\u0e32 {firstname}",[q.param("firstname",ra)]));}else ma(q._("{firstname} \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a\u0e2a\u0e32\u0e22\u0e08\u0e32\u0e01\u0e04\u0e38\u0e13",[q.param("firstname",ra)]));}else{var sa=ha(qa[na]);if(la.log_message_data.answered){ma(q._("{firstname} \u0e42\u0e17\u0e23\u0e2b\u0e32\u0e04\u0e38\u0e13",[q.param("firstname",sa)]));}else ma(q._("\u0e04\u0e38\u0e13\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a\u0e2a\u0e32\u0e22\u0e08\u0e32\u0e01 {firstname}",[q.param("firstname",sa)]));}});}function da(la,ma){var na=la.log_message_data.name;if(la.author==l.user){if(na){ma(q._("\u0e04\u0e38\u0e13\u0e15\u0e31\u0e49\u0e07\u0e0a\u0e37\u0e48\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32: {name}",[q.param("name",m.createElement(m.DOM.span,{className:"_5wzs"},na))]));}else ma("\u0e04\u0e38\u0e13\u0e25\u0e1a\u0e0a\u0e37\u0e48\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32");}else l.get(la.author,function(oa){var pa=ia(oa);if(na){ma(q._("{actor} \u0e15\u0e31\u0e49\u0e07\u0e0a\u0e37\u0e48\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32: {name}",[q.param("actor",pa),q.param("name",m.createElement(m.DOM.span,{className:"_5wzs"},na))]));}else ma(q._("{actor} \u0e25\u0e1a\u0e0a\u0e37\u0e48\u0e2d\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32",[q.param("actor",pa)]));});}function ea(la,ma){if(la.author==l.user){if(la.log_message_data.image){ma("\u0e04\u0e38\u0e13\u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32");}else ma("\u0e04\u0e38\u0e13\u0e25\u0e1a\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32");}else l.get(la.author,function(na){var oa=ia(na);if(la.log_message_data.image){ma(q._("{actor} \u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32",[q.param("actor",oa)]));}else ma(q._("{actor} \u0e25\u0e1a\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32",[q.param("actor",oa)]));});}function fa(la,ma){if(la.author==l.user){ma("\u0e04\u0e38\u0e13\u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e27\u0e2d\u0e25\u0e40\u0e1b\u0e40\u0e1b\u0e2d\u0e23\u0e4c");}else l.get(la.author,function(na){var oa=ia(na);ma(q._("{actor} \u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e27\u0e2d\u0e25\u0e40\u0e1b\u0e40\u0e1b\u0e2d\u0e23\u0e4c",[q.param("actor",oa)]));});}function ga(la,ma){ma("\u0e40\u0e23\u0e32\u0e44\u0e21\u0e48\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e14\u0e36\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e01\u0e48\u0e2d\u0e19\u0e2b\u0e19\u0e49\u0e32\u0e43\u0e19\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e19\u0e35\u0e49\u0e44\u0e14\u0e49");}function ha(la){return ia(la,true);}function ia(la,ma){var na=la.fbid,oa=j.constructEndpoint({id:na});if(la.href)return (m.createElement(m.DOM.a,{className:"_5wzt",href:la.href,'data-hovercard':oa},ma?la.short_name:la.name));return la.name;}function ja(la){var ma=la.indexOf(l.user);if(ma>0){var na=la.filter(function(oa){return oa!==l.user;});return [l.user].concat(na);}return la;}function ka(la){return la.log_message_data.event_name==='installing'||la.log_message_data.event_name==='installed'||la.log_message_data.event_name==='install_canceled';}},null);
__d("MercuryLogMessage.react",["DOM","Event","ChatVideoCallLink.react","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","React","ReactPropTypes","VideoCallSupport","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';var t=m.createClass({displayName:'MercuryLogMessage',propTypes:{message:n.instanceOf(j).isRequired,onImageLoad:n.func,onVideoCallLinkClick:n.func},getDefaultProps:function(){return {onImageLoad:q};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(u){k.renderText(u.message,function(v){this.setState({messageText:v});}.bind(this));},shouldComponentUpdate:function(u,v){return this.state.messageText!=v.messageText;},componentDidUpdate:function(){var u=this.refs.attachment.getDOMNode();k.renderAttachmentLegacy(u,this.props.message);g.scry(u,'img').forEach(function(v){var w=h.listen(v,'load',function(){this.props.onImageLoad(v);w.remove();}.bind(this));}.bind(this));},render:function(){return (m.createElement(m.DOM.div,Object.assign({},this.props,{className:s(this.props.className,"_5ye6"),title:r(new Date(this.props.message.timestamp),'g:ia')}),k.renderIcon(this.props.message),m.createElement(m.DOM.div,{className:"_5ye7"},this.state.messageText,this.renderVideoCallLink()),m.createElement(m.DOM.div,{className:"_5ye8",ref:"attachment"})));},renderVideoCallLink:function(){if(this.props.message.log_message_type!==l.VIDEO_CALL||!this.props.onVideoCallLinkClick||!o.isVideoCallSupported())return null;return (m.createElement(i,{message:this.props.message,onClick:this.props.onVideoCallLinkClick}));}});e.exports=t;},null);
__d("ChatConversation.react",["ChatDateBreak.react","ChatMessage.react","ImmutableObject","MercuryActionTypeConstants","MercuryLogMessage.react","React","cx","invariant","OrionMercuryReceiverNUX"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';var o=b('OrionMercuryReceiverNUX').module,p=1000*60*60,q=l.createClass({displayName:'ChatConversation',propTypes:{maxBubbleWidth:l.PropTypes.number.isRequired,messages:l.PropTypes.arrayOf(l.PropTypes.instanceOf(i)).isRequired,onCallLinkClick:l.PropTypes.func,onImageLoad:l.PropTypes.func,onStickerClick:l.PropTypes.func},componentWillReceiveProps:function(r){n(r.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){var r=this.props.messages,s=[];for(var t=0;t<r.length;t++){var u=r[t],v=(t>0)?r[t-1]:null;if(u.is_cleared)continue;if(!v||v.is_cleared||u.timestamp-v.timestamp>p)s.push(l.createElement(g,{date:new Date(u.timestamp),key:'db:'+u.message_id}));if(u.action_type==j.LOG_MESSAGE){s.push(l.createElement(k,{className:"_5w0o",key:u.message_id,message:u,onImageLoad:this.props.onImageLoad,onCallLinkClick:this.props.onCallLinkClick}));}else s.push(l.createElement(h,{key:u.message_id,message:u,maxBubbleWidth:this.props.maxBubbleWidth,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick}));if(o&&o.isValidOrionNUXMessage(u)){var w=u.attachments[0],x=w.metadata;s.push(l.createElement(o,Object.assign({className:"_3-8r",key:'omrn:'+u.message_id,onImageLoad:this.props.onImageLoad},x)));}}return l.createElement(l.DOM.div,null,s);}});e.exports=q;},null);
__d("MercuryTypingReceiver",["Arbiter","ChannelConstants","MercuryActionTypeConstants","MercuryIDs","MercuryParticipants","MercuryPayloadSource","TypingStates","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryServerRequests"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=b('MercuryServerRequests').get(),q,r={},s=30000,t={};n(t,{'state-changed':true});function u(aa){var ba=r[aa]||{},ca=Object.keys(ba);ca.sort(function(da,ea){return ba[da]-ba[ea];});return ca;}function v(){q=null;var aa=Date.now(),ba={},ca=false;for(var da in r){var ea=false;for(var fa in r[da]||{})if(r[da][fa]<aa-s){delete r[da][fa];ea=true;}else ca=true;if(ea)ba[da]=u(da);}for(var ga in ba){x(ba);break;}if(ca)q=o(v,3000);}function w(aa,ba){if(aa in r)if(ba in r[aa]){delete r[aa][ba];y(aa);}}function x(aa){t.releaseHeldEventType('state-changed');t.emitAndHold('state-changed',aa);}function y(aa){var ba={};ba[aa]=u(aa);x(ba);}function z(aa){if(aa.thread_fbid)return p.getClientThreadIDNow(aa.thread_fbid);if(aa.type==='typ')return j.getThreadIDFromUserID(aa.from);return null;}g.subscribe([h.getArbiterType('typ'),h.getArbiterType('ttyp')],function(aa,ba){var ca=ba.obj,da=z(ca);if(da){var ea=j.getParticipantIDFromUserID(ca.from);if(ca.st==m.TYPING){r[da]=r[da]||{};var fa=r[da][ea];r[da][ea]=Date.now();if(!q)q=o(v,3000);!fa&&y(da);}else if(ca.st==m.INACTIVE)w(da,ea);}});p.subscribe('update-typing-state',function(aa,ba){var ca=ba.payload_source;if(ca!=l.CLIENT_CHANNEL_MESSAGE)return;var da=ba.actions;if(!da||!da.length)return;var ea=i.USER_GENERATED_MESSAGE;da.forEach(function(fa){if(fa.action_type==ea&&fa.author!=k.user)w(fa.thread_id,fa.author);});});e.exports=t;},null);
__d("ChatTypingIndicators.react",["ChatAuthorPhotoBlock.react","DOM","MercuryIDs","MercuryParticipants","ReactPropTypes","React","SubscriptionsHandler","Tooltip","MercuryTypingReceiver","arraySort","createObjectFrom","cx","emptyFunction","fbt","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b('MercuryThreadInformer').get(),v=l.createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorsWillShow:k.func,indicatorsDidShow:k.func,threadID:k.string.isRequired},getDefaultProps:function(){return {indicatorsWillShow:s,indicatorsDidShow:s};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(o.addRetroactiveListener('state-changed',this.typingStateChanged),u.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(w){if(w.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(w,x){if(x.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();j.getMulti(this.state.typingUserIDs,function(w){if(this.isMounted())this.state.typingUserIDs.forEach(function(x){var y=w[x];n.set(this.refs[x].getDOMNode(),this.renderTooltip(y.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var w=i.isMultichat(this.props.threadID);return (l.createElement(l.DOM.div,{className:"_2fsr"},this.state.typingUserIDs.map(function(x){return l.createElement(g,{authorID:x,className:(("_gfq")+(w?' '+"_52fu":'')),hideName:!w,key:x},l.createElement(l.DOM.div,{className:"_52ft"},l.createElement(l.DOM.div,{className:"_gfp",ref:x})));})));},renderTooltip:function(w){var x=h.create('span');l.renderComponent(l.createElement(l.DOM.span,null,t._("{name} \u0e01\u0e33\u0e25\u0e31\u0e07\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e2d\u0e22\u0e39\u0e48...",[t.param("name",w)])),x);return x;},typingStateChanged:function(w){if(this.props.threadID in w)this.setState({typingUserIDs:p(w[this.props.threadID])});},messagesReceived:function(w,x){if(this.props.threadID in x){var y=x[this.props.threadID],z=q(y.map(function(aa){return aa.author;}));this.setState({typingUserIDs:p(this.state.typingUserIDs.filter(function(aa){return !z[aa];}))});}}});e.exports=v;},null);
__d("MercuryIndicatorController",["ArbiterMixin","DOM","MercuryActionTypeConstants","MercuryDelayedRoger","MercuryMessageSourceTags","MercuryParticipants","MercuryRoger","MercuryTypingReceiver","arrayContains","copyProperties","formatDate","removeFromArray","tx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=b('MercuryThreads').get(),u=[];function v(w){this._threadID=w;this._canonicalUser=t.getCanonicalUserInThread(w);u.push(this);}p(v.prototype,g,{destroy:function(){r(u,this);},setLastMessage:function(w){this._lastMsg=w;this._handleStateChange();},_informStateChanged:function(w){if(w.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&l.isAuthor(this._lastMsg.author))w.self_authored=true;this._currentActivity=w.activity;this.inform('state-changed',w);},_notifySentFrom:function(){var w,x,y=this._lastMsg.location_text,z=this._lastMsg.source_tags||[];if(y){w=s._("\u0e2a\u0e48\u0e07\u0e08\u0e32\u0e01 {location}",{location:y});x='sentFromMobile';}else if(o(z,k.MESSENGER)){w=h.create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},"\u0e2a\u0e48\u0e07\u0e21\u0e32\u0e08\u0e32\u0e01 Messenger");x='sentFromMobile';}else if(o(z,k.MOBILE)){w=h.create('a',{href:'/mobile','class':'fcg',target:'_blank'},"\u0e2a\u0e48\u0e07\u0e08\u0e32\u0e01\u0e21\u0e37\u0e2d\u0e16\u0e37\u0e2d");x='sentFromMobile';}else if(o(z,k.EMAIL)){w="\u0e2a\u0e48\u0e07\u0e08\u0e32\u0e01\u0e2d\u0e35\u0e40\u0e21\u0e25";x='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:x,text:w});},_notifySeenTimestamp:function(w){var x=m.getSeenTimestamp(this._threadID,w[0])*.001,y=Date.now()*.001,z;if(x<y-518400){z='M j';}else if(x<y-86400){z='D g:ia';}else z='g:ia';this._informStateChanged({activity:'seen-timestamp',text:s._("\u0e2d\u0e48\u0e32\u0e19\u0e40\u0e21\u0e37\u0e48\u0e2d {timestamp}",{timestamp:q(x,z)})});},_checkNamesForCollision:function(w,x){var y=false;l.getMulti(w,function(z){function aa(da){if(typeof z[da]!=="undefined"){return z[da].short_name.toLowerCase();}else return da;}var ba=x.map(aa),ca=w.map(aa);y=ba.some(function(da){return ca.indexOf(da)!==ca.lastIndexOf(da);});});return y;},_notifySeenBy:function(w){var x=this._lastMsg,y=true;l.getMulti(w,function(z){y=false;if(this._lastMsg!=x)return;var aa=t.getThreadMetaNow(this._threadID),ba=aa?aa.participants.length:0,ca=w.length+(x.author!=l.user),da,ea=false,fa=false,ga=ba>2&&ca>=ba-1;if(!(ga)&&ba>0)fa=this._checkNamesForCollision(aa.participants,w);if(ga){da="\u0e17\u0e38\u0e01\u0e04\u0e19\u0e40\u0e2b\u0e47\u0e19\u0e41\u0e25\u0e49\u0e27";}else if(w.length==1){da=s._("{user} \u0e44\u0e14\u0e49\u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e49\u0e27",{user:z[w[0]].short_name});}else if(w.length==2){da=s._("{user1}, {user2} \u0e44\u0e14\u0e49\u0e2d\u0e48\u0e32\u0e19\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e19\u0e35\u0e49",{user1:z[w[0]].short_name,user2:z[w[1]].short_name});}else if(w.length==3){da=s._("{user1}, {user2}, {user3} \u0e44\u0e14\u0e49\u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e49\u0e27",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,user3:z[w[2]].short_name});}else if(w.length>3){var ha=Object.keys(z).length-2,ia=s._("\u0e04\u0e19\u0e2d\u0e37\u0e48\u0e19\u0e46 \u0e2d\u0e35\u0e01 {num} \u0e04\u0e19",{num:ha}),ja=h.create('span',{className:'more'},ia);da=h.tx._("{user1}, {user2}, {=num more link} \u0e44\u0e14\u0e49\u0e2d\u0e48\u0e32\u0e19\u0e41\u0e25\u0e49\u0e27",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,'=num more link':ja});ea=true;}ea=ea||fa;this._informStateChanged({activity:'seen-by',text:da,seenBy:w,hasNameCollision:fa,tooltip:ea});}.bind(this));y&&this._informStateChanged({activity:'none'});},_notifyTyping:function(w){var x=this._lastMsg,y=true;l.getMulti(w,function(z){y=false;if(this._lastMsg!=x)return;var aa=t.getThreadMetaNow(this._threadID),ba=aa?aa.participants.length:0,ca,da=false;if(ba>2&&w.length>=ba-1){ca="Everyone is typing...";}else if(w.length==1){ca=s._("{name} \u0e01\u0e33\u0e25\u0e31\u0e07\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e2d\u0e22\u0e39\u0e48...",{name:z[w[0]].short_name});}else if(w.length==2){ca=s._("{user1} and {user2} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name});}else if(w.length==3){ca=s._("{user1}, {user2}, and {user3} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,user3:z[w[2]].short_name});}else if(w.length>3){var ea=Object.keys(z).length-2,fa=s._("\u0e14\u0e39\u0e40\u0e1e\u0e34\u0e48\u0e21 {num} \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23",{num:ea}),ga=h.create('a',{href:'#'},fa);ca=h.tx._("{user1}, {user2}, and {=num more link} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,'=num more link':ga});da=true;}this._informStateChanged({activity:'typing',text:ca,typing:w,tooltip:da});}.bind(this));y&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var w=i.LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==w){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=l.user){this._notifySentFrom();return;}var x=j.getSeenBy(this._threadID,true);if(x.length)if(this._canonicalUser){this._notifySeenTimestamp(x);return;}else{this._notifySeenBy(x);return;}this._informStateChanged({activity:'none'});}});n.addRetroactiveListener('state-changed',function(w){u.forEach(function(x){var y=w[x._threadID];if(y!==undefined){x._typing=y;x._handleStateChange();}});});j.subscribe('state-changed',function(w,x){u.forEach(function(y){x[y._threadID]&&y._handleStateChange();});});e.exports=v;},null);
__d("MercuryLastMessageIndicator.react",["DOM","MercuryIndicatorController","MercuryParticipants","ReactPropTypes","React","Tooltip","cx","emptyFunction","joinClasses","startsWith"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=k.createClass({displayName:'MercuryLastMessageIndicator',propTypes:{hideTyping:j.bool,indicatorWillShow:j.func,indicatorDidShow:j.func,lastMessage:j.object,threadID:j.string.isRequired},getDefaultProps:function(){return {indicatorWillShow:n,indicatorDidShow:n};},getInitialState:function(){return {data:{}};},componentDidMount:function(){this._setup(this.props);},componentWillReceiveProps:function(r){if(r.threadID!=this.props.threadID){this._destroy();this._setup(r);}else if(r.lastMessage!=this.props.lastMessage)this._controller.setLastMessage(r.lastMessage);},componentWillUpdate:function(r,s){if(this.isVisible(r,s))this.props.indicatorWillShow();},componentDidUpdate:function(){if(!this.isVisible())return;this.setText();this.setTooltip();this.props.indicatorDidShow();},componentWillUnmount:function(){this._destroy();},render:function(){return (k.createElement(k.DOM.div,{className:this.getRootClass()},k.createElement(k.DOM.div,{className:"_510h"}),k.createElement(k.DOM.span,{className:"_510f",ref:"text"},"")));},getRootClass:function(){var r=(("_510g")+(this.state.data.self_authored?' '+"_510e":'')),s=this.state.data.activity,t=null;if(p(s,'seen')){t='seen';}else if(s=='typing'){t=this.props.hideTyping?null:s;}else t=s;return o(r,t,this.props.className);},isVisible:function(r,s){r=r||this.props;s=s||this.state;return (s.data&&s.data.activity!='none'&&!(r.hideTyping&&s.data.activity=='typing'));},setText:function(){if(this.state.data.text)g.setContent(this.refs.text.getDOMNode(),this.state.data.text);},setTooltip:function(){if(this.state.data.activity=='seen-by'&&this.state.data.tooltip)i.getMulti(this.state.data.seenBy,function(r){var s=g.create('div',null,this.state.data.seenBy.map(function(t){return g.create('div',null,r[t].name);}));l.set(this.state.data.hasNameCollision?this.getDOMNode():g.find(this.getDOMNode(),'span.more'),s,'above','center');}.bind(this));},_setup:function(r){this._controller=new h(r.threadID);this._subscription=this._controller.subscribe('state-changed',function(s,t){return this.setState({data:t});}.bind(this));r.lastMessage&&this._controller.setLastMessage(r.lastMessage);},_destroy:function(){this._subscription.unsubscribe();this._controller.destroy();},setLastMessage:function(r){this.setProps({lastMessage:r});}});e.exports=q;},null);
__d("MercuryTypingIndicator",["Animation","ChatConfig","CSS","DOM","MercuryTypingAnimation.react","MercuryTypingReceiver","MercuryParticipants","React","Style","ChatTabTemplates","Tooltip","copyProperties","cx","csx","tx","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=b('MercuryThreadInformer').get(),w=[];v.subscribe('messages-received',function(z,aa){w.forEach(function(ba){var ca=aa[ba._threadID];ca&&ba.receivedMessages(ca);});});l.addRetroactiveListener('state-changed',function(z){w.forEach(function(aa){var ba=z[aa._threadID];ba&&aa._handleStateChanged(ba);});});function x(z){var aa=p[':fb:chat:conversation:message-group'].build(),ba=p[':fb:mercury:typing-indicator:typing'].build();i.addClass(aa.getRoot(),"_50kd");var ca=aa.getNode('profileLink');q.set(ca,z.name,'left');ca.href=z.href;aa.setNodeContent('profileName',z.name);aa.setNodeProperty('profilePhoto','src',z.image_src);var da=u._("{name} \u0e01\u0e33\u0e25\u0e31\u0e07\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e2d\u0e22\u0e39\u0e48...",{name:z.short_name});q.set(ba.getRoot(),da,'above');j.appendContent(aa.getNode('messages'),ba.getRoot());return aa;}function y(z,aa,ba){this._animations={};this._activeUsers={};this._typingIndicator=aa;this._messagesView=ba;this._threadID=z;this._subscription=l.addRetroactiveListener('state-changed',function(ca){var da=ca[this._threadID];da&&this._handleStateChanged(da);}.bind(this));w.push(this);}r(y.prototype,{destroy:function(){Object.keys(this._activeUsers).forEach(this._removeUserBubble.bind(this));this._controller.destroy();w.remove(this);},receivedMessages:function(z){z.forEach(function(aa){if(!m.isAuthor(aa.author))this._removeUserBubble(aa.author);}.bind(this));},_handleStateChanged:function(z){for(var aa in this._activeUsers)if(z.indexOf(aa)===-1){this._slideOutUserBubble(aa);delete this._activeUsers[aa];}if(z.length)m.getMulti(z,function(ba){var ca=this._messagesView.isScrolledToBottom(),da={};for(var ea in ba){var fa=this._activeUsers[ea];da[ea]=fa||x(ba[ea]).getRoot();if(!fa){j.appendContent(this._typingIndicator,da[ea]);if(h.get('chat_thread_typing_indicator_animated')){var ga=j.scry(this._typingIndicator,"._510u");for(var ha=0,ia=ga.length;ha<ia;ha++)n.renderComponent(n.createElement(k,{className:"_3e2s"}),ga[ha]);}}}var ja=Object.keys(da).length>0;ca&&this._messagesView.scrollToBottom(ja);this._activeUsers=da;}.bind(this));},_removeUserBubble:function(z,aa){var ba=this._getCurrentAnimation(z,aa);if(ba){ba.animation.stop();j.remove(ba.elem);delete this._animations[z];}if(z in this._activeUsers){j.remove(this._activeUsers[z]);delete this._activeUsers[z];}if(aa&&h.get('chat_thread_typing_indicator_animated')){var ca=j.scry(aa,"._510u");for(var da=0,ea=ca.length;da<ea;da++)n.unmountComponentAtNode(ca[da]);}aa&&j.remove(aa);},_slideOutUserBubble:function(z){var aa=this._activeUsers[z];if(this._getCurrentAnimation(z,aa)){return;}else if(aa){o.set(aa,'overflow','hidden');var ba=(new g(aa)).from('opacity',1).from('height',aa.offsetHeight).to('height',0).to('opacity',0).ease(g.ease.end).duration(250).ondone(this._removeUserBubble.bind(this,z,aa)).go();this._animations[z]={animation:ba,elem:aa};}},_getCurrentAnimation:function(z,aa){if(this._animations[z]&&(!aa||this._animations[z].elem===aa))return this._animations[z];}});e.exports=y;},null);
__d("MercuryMessageList",["ImmutableObject","LogHistory","OrderedMap","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=h.getInstance('mercury_message_list');function l(q){this.$MercuryMessageList0=n(q?m(q):[]);}l.prototype.append=function(q){this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(q)));p('append',q);};l.prototype.prepend=function(q){this.$MercuryMessageList0=n(m(q)).merge(this.$MercuryMessageList0);p('prepend',q);};l.prototype.update=function(q){var r=q.filter(function(s){return this.contains(s);}.bind(this));if(r.length===0)return;this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(r)));p('update',q);};l.prototype.reorder=function(q){this.$MercuryMessageList0=n(q.map(function(r){var s=this.$MercuryMessageList0.get(r.message_id);if(!s||s.timestamp!=r.timestamp||s.is_cleared!=r.is_cleared)return new g(r);return s;}.bind(this)));p('reorder',q);};l.prototype.hasReachedClearedMessages=function(){var q=this.messageAt(0);return !!(q&&q.is_cleared);};l.prototype.messageAt=function(q){var r=this.$MercuryMessageList0.keyAtIndex(q);return r?this.$MercuryMessageList0.get(r):undefined;};l.prototype.contains=function(q){return this.$MercuryMessageList0.indexOfKey(o(q))!==undefined;};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toOrderedMap=function(){return this.$MercuryMessageList0;};function m(q){return q.map(function(r){return new g(r);});}function n(q){return i.fromArray(q,o);}function o(q){return q.message_id;}function p(event,q){j(function(){k.debug(event,{messageIDs:q.map(function(r){return r.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryMessageList","MercuryParticipants","SubscriptionsHandler","MercuryThreadlistConstants","copyProperties","merge","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreads","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=b('MercuryMessages').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadInformer').get(),t=h.getInstance('mercury_message_store');function u(w){this.$MercuryMessageStore0=w;this.$MercuryMessageStore1=new i();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=new k();this.$MercuryMessageStore5.addSubscriptions(s.subscribe('messages-received',function(x,y){return this.$MercuryMessageStore7(y);}.bind(this)),s.subscribe('messages-updated',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore8(y[this.$MercuryMessageStore0]);}.bind(this)),s.subscribe('messages-reordered',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9();}.bind(this)));t.debug('constructed',{threadID:this.$MercuryMessageStore0});this.$MercuryMessageStorea();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStoreb=w;};u.prototype.destroy=function(){this.$MercuryMessageStore5&&this.$MercuryMessageStore5.release();t.debug('destroyed',{threadID:this.$MercuryMessageStore0});};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(q.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&q.hasLoadedAllMessages(this.$MercuryMessageStore0))return false;if(r.isNewEmptyLocalThread(this.$MercuryMessageStore0))return false;if(this.$MercuryMessageStore1.hasReachedClearedMessages())return false;return this.$MercuryMessageStorea();};u.prototype.$MercuryMessageStorea=function(){var w=this.$MercuryMessageStore4+l.RECENT_MESSAGES_LIMIT*this.$MercuryMessageStore2;t.debug('fetching',{threadID:this.$MercuryMessageStore0,limit:w});q.getThreadMessagesRange(this.$MercuryMessageStore0,0,w,this.$MercuryMessageStorec.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(q.hasLoadedNMessages(this.$MercuryMessageStore0,w)){this.$MercuryMessageStore9();return false;}return true;};u.prototype.$MercuryMessageStorec=function(w){if(w&&w.length){this.$MercuryMessageStore3=w[0].timestamp;this.$MercuryMessageStore4=w.length;t.debug('fetched',{threadID:this.$MercuryMessageStore0,earliestMessageTimestamp:this.$MercuryMessageStore3,count:this.$MercuryMessageStore4});}};u.prototype.$MercuryMessageStore7=function(w){var x=[],y=w[this.$MercuryMessageStore0];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStoreb){var z=w[this.$MercuryMessageStoreb];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStoreb=null;}}if(x.length){this.$MercuryMessageStore1.append(x);this.$MercuryMessageStore4+=x.length;var aa=x.every(function(ba){return ba.author!=j.user;});this.$MercuryMessageStored(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore8=function(w){this.$MercuryMessageStore1.update(q.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStore9=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(q.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStored=function(w,x){var y=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',n({messages:y,eventType:w},x));v(this.$MercuryMessageStore0,w,y);};u.prototype.$MercuryMessageStoree=function(){var w=this.$MercuryMessageStore1.messageAt(0);if(w)this.$MercuryMessageStore3=w.timestamp;};function v(w,x,y){p(function(){t.debug('update:'+x,{threadID:w,messageIDs:y.map(function(z){return z.message_id;})});},0);}m(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered'});o(u,{updated:true});e.exports=u;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","ArbiterMixin","BanzaiLogger","ChatConfig","ChatConversation.react","ChatTypingIndicators.react","CSS","DOM","Event","MercuryLastMessageIndicator.react","LiveTimer","MercuryTypingIndicator","MercuryMessageStore","MercuryParticipants","React","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","copyProperties","getElementPosition","throttle","ChatWelcomeMessage"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){'use strict';var ia=70,ja=null,ka=20;function la(na){if(ja===null){var oa=na.childNodes[0];aa.set(na,'overflow','scroll');ja=oa.clientWidth-ia;aa.set(na,'overflow','');}return ja;}function ma(na,oa,pa,qa,ra,sa,ta,ua){this.loadingIcon=ra;this.threadID=na;this.sheetController=oa;this.scrollContainer=pa;this.conversationElem=qa;this.tabView=ua;r.restart(w.get()/1000);this._loadingMoreMessages=false;function va(){ma.inform('interaction-with-tab',na);}this._subscriptions=new ba();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),p.listen(this.scrollContainer,'mousedown',va));if(ca.firefox()){var wa=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(wa,va,false);}else this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'mousewheel',va));this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'scroll',ga(this.scrolling,50,this)));if(k.get('chat_react')){var xa;v.renderComponent(v.createElement(m,{threadID:this.threadID,indicatorsWillShow:function(){return xa=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return xa&&this.scrollToBottom(true);}.bind(this)}),ta);}else this.typingIndicator=new s(this.threadID,ta,this);var ya;this.lastMessageIndicatorNode=sa;this.lastMessageIndicator=v.renderComponent(v.createElement(q,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return ya=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return ya&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}ea(ma,i);ea(ma.prototype,{initializeConversation:function(){this._store=new t(this.threadID);this._conversation=v.renderComponent(v.createElement(l,{maxBubbleWidth:la(this.scrollContainer),messages:[],onImageLoad:function(na){var oa=this.scrollContainer,pa=oa.scrollTop+oa.clientHeight;if(pa+na.offsetHeight>=oa.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this),onCallLinkClick:function(na,oa,pa){ma.inform('video-call-clicked',{userID:na,threadID:oa,clickSource:pa});}}),this.conversationElem);this._subscriptions.addSubscriptions(this._store.subscribe(function(na){if(na.eventType==t.MESSAGES_RECEIVED&&na.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(na.eventType==t.MESSAGES_REORDERED){this._loadingMoreMessages=false;n.hide(this.loadingIcon);}var oa=this.isScrolledToBottom(),pa=this._getLoadingHeight(),qa=this.scrollContainer.scrollHeight,ra=this.scrollContainer.scrollTop,sa=na.messages,ta=ha.getWelcomeMessage(this.threadID);if(ta)sa.push(ta);this._conversation.setProps({messages:sa},function(){if(oa||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(na.eventType==t.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-qa-pa+ra);}.bind(this));this.lastMessageIndicator.setProps({lastMessage:sa.length>0?sa[sa.length-1]:null});if(na.eventType==t.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(sa)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();}.bind(this)));},setShouldScrollToBottom:function(na){this._shouldScrollToBottom=na;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){n.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&this.scrollContainer.scrollTop;},destroy:function(){o.scry(this.conversationElem,'.stickerContainer').forEach(function(na){return v.unmountComponentAtNode(na);});v.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();v.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(na){if(!y.shouldShowStickerReplyNUX()||!na.length)return false;var oa=na[na.length-1];if(oa.author===u.user)return false;if(oa.has_attachment)return oa.attachments.some(function(pa){return pa.attach_type==='sticker';});return false;},isScrolledToBottom:function(na){var oa=this.scrollContainer;na=na||ka;return oa.scrollTop+oa.clientHeight>=oa.scrollHeight-na;},isScrolledNearTop:function(){return this.scrollContainer.scrollTop<this.scrollContainer.clientHeight;},scrollToBottom:function(na){this.scrollToPosition(this.scrollContainer.scrollHeight,na);},scrollToPosition:function(na,oa){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(oa===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',na).ease(g.ease.end).duration(400).go();}else this.scrollContainer.scrollTop=na;},_onStickerClick:function(na,oa){if(!na)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:na,stickerid:oa});var pa=this.tabView;y.onTrayDataReady(function(){if(da(y.getPackIDsInTray(),na)){var qa=y.getPack(na);if(qa&&qa.isPromoted)x.addPack(na);pa.setStickersFlyoutPackID(na);}else z.showStore(na);});},_checkToAnimateSticker:function(){var na=fa(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:this.scrollContainer.scrollTop,top:na.y,viewHeight:na.height});},setNewThreadID:function(na){this._store.setNewThreadID(na);}});e.exports=ma;},null);
__d("GroupThreadTypeaheadRenderer",["MercuryConstants","DOM","CompactTypeaheadRenderer","formatDate","MercuryThreadMetadataRawRenderer","TypeaheadFacepile"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(o,p){switch(o.type){case g.MercuryTypeaheadConstants.HEADER_TYPE:break;case g.MercuryTypeaheadConstants.USER_TYPE:case g.MercuryTypeaheadConstants.PAGE_TYPE:return i(o,p);case g.MercuryTypeaheadConstants.THREAD_TYPE:return n(o,p);default:return h.create('div');}}function n(o,p){var q=[],r=o.mercury_thread,s=o.participants_to_render.map(function(v){return v.big_image_src||v.image_src;});if(s){if(s instanceof Array){s=l.render(s);}else s=h.create('img',{alt:'',src:s});q.push(s);}var t=r.name,u=k.renderRawParticipantList(r.thread_id,o.participants_to_render,r.participants.length,{names_renderer:k.renderShortNames});q.push(h.create('span',{className:'timestamp'},j(new Date(r.timestamp),'g:ia')));q.push(h.create('span',{className:'text'},t));q.push(h.create('span',{className:'subtext'},u));return h.create('li',{className:'node'},q);}m.className='compact';e.exports=m;},null);
__d("MercuryTypeahead",["Event","ArbiterMixin","DOM","DOMDimensions","Input","Keys","MercuryTypeaheadTemplates","Tokenizer","Typeahead","TypeaheadCore","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=function(t,u){this._domElement=null;this._typeahead=null;this._tokenizer=null;this._placeholder='';this._exclusions=[];this._viewNodeOrID=null;this._viewOptions={renderer:'compact',autoSelect:true};this._tokenizerBehaviors=[];this._heightPrev=null;this._dataSource=t;this._view=u;};q(s.prototype,h);q(s.prototype,{setPlaceholder:function(t){this._placeholder=t;return this;},setExcludedParticipantsFromThreadMeta:function(t){if(!t)return;if(!t.former_participants){this.setExcludedParticipants(t.participants);return;}var u=t.former_participants.filter(function(v){return v.is_friend===false;}).map(function(v){return v.id;});this.setExcludedParticipants(u.concat(t.participants));},setExcludedParticipants:function(t){this._exclusions=[];t.forEach(function(u){var v=u.indexOf(':');if(u.substr(0,v)=='fbid')this._exclusions.push(u.substr(v+1));}.bind(this));return this;},setViewNodeID:function(t){this._viewNodeOrID=t;},setViewNode:function(t){this._viewNodeOrID=t;},setFullWidthView:function(t){var u=i.create('div',{className:"_4ck uiTypeaheadView"});i.setContent(t,u);this.setViewNode(u);},setViewOption:function(t,u){this._viewOptions[t]=u;},addTokenizerBehavior:function(t){this._tokenizerBehaviors.push(t);},build:function(t){if(this._domElement)return;var u=m[':fb:mercury:tokenizer'].build(),v=m[':fb:mercury:typeahead'].build();this._domElement=u.getRoot();i.appendContent(this._domElement,v.getRoot());var w=v.getNode('textfield');k.setPlaceholder(w,this._placeholder);w.setAttribute('data-placeholder',this._placeholder);this._input=w;var x={node_id:this._viewNodeOrID,ctor:this._view,options:this._viewOptions},y={ctor:p,options:{setValueOnSelect:true}};this._typeahead=new o(this._dataSource,x,y,v.getRoot());this._typeahead.init();var z={inline:true,behaviors:this._tokenizerBehaviors};this._tokenizer=new n(this._domElement,this._typeahead);this._tokenizer.init(u.getNode('tokenarea'),'participants',[],z);this._tokenizer.subscribe(['addToken','removeToken','removeAllTokens'],this._tokensChanged.bind(this));this._tokenizer.subscribe('resize',function(){this.inform('resize');}.bind(this));g.listen(w,'focus',function(){this._resetDataSource();this._typeahead.init();}.bind(this));g.listen(this._domElement,'click',this.focus.bind(this));g.listen(w,'keydown',this.keydown.bind(this));this._heightPrev=j.getElementDimensions(this._domElement).height;},getElement:function(){return this._domElement;},getSelectedParticipantIDs:function(){var t=[];if(this._tokenizer)(this._tokenizer.getTokenValues()||[]).forEach(function(u){t.push('fbid:'+u);});return t;},getTokens:function(){var t=[];if(this._tokenizer)t=this._tokenizer.getTokens();return t;},getTokenizer:function(){return this._tokenizer;},keydown:function(event){if(this._tokenizer.inline&&event.keyCode==l.ESC){if(k.isEmpty(this._input)){var t=this._tokenizer.getLastToken();if(t&&t.isRemovable())this._tokenizer.removeToken(t);}else this._typeahead.getCore().reset();return false;}if(k.isEmpty(this._input)&&this._tokenizer.inline&&event.keyCode===l.RETURN){event.preventDefault();return this.inform('tokens-return');}},reset:function(){this._tokenizer&&this._tokenizer.removeAllTokens();this._typeahead&&this._typeahead.getCore().reset();},focus:function(){this._tokenizer&&this._tokenizer.focusInput();},getTypeahead:function(){return this._typeahead;},_resetDataSource:function(){this._dataSource.setExclusions(this._exclusions);},_tokensChanged:function(){this.inform('tokens-changed');}});e.exports=s;},null);
__d("ChatAddFriendsTabSheetRawRenderer",["ContextualTypeaheadView","WebMessengerDataSources","DOM","Event","MercuryConfig","GroupThreadTypeaheadRenderer","MercuryDataSourceWrapper","MercuryTypeahead","ChatTabTemplates","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r={render:function(s,t,u,v,w,x){var y=x?o[':fb:mercury:chat:tab-sheet:add-friends-empty-tab'].build():o[':fb:mercury:chat:tab-sheet:add-friends'].build(),z={};if(k.GroupThreadNewMessageGK){z=h.ChatTabComposerDataSource;z.showThreads=true;}else z=x?m.source:m.add_people_source;var aa=new n(z,g);aa.setExcludedParticipantsFromThreadMeta(v);if(!x)aa.setPlaceholder("\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e43\u0e19\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e19\u0e35\u0e49");if(k.GroupThreadNewMessageGK&&x&&s!=null){aa.setViewOption('renderer',l);aa.subscribe('tokens-changed',function(){z.showThreads=aa.getTokens().length===0;});}aa.build();i.replace(y.getNode('participantsTypeahead'),aa.getElement());i.setContent(u,y.getRoot());aa.getTokenizer().adjustWidth();var ba=y.getNode('participantsTypeahead').getAttribute('data-labelid'),ca=i.scry(aa.getElement(),'input[type="text"]')[0];if(ca)if(ba){ca.setAttribute('aria-labelledby',ba);}else ca.setAttribute('aria-label',"\u0e16\u0e36\u0e07");aa.focus();if(!x){var da=function(){var ea=aa.getSelectedParticipantIDs();if(ea.length)w(ea);t.close(s);};j.listen(y.getNode('doneButton'),'click',da);aa.subscribe('tokens-return',function(){if(aa.getTokens().length)da();});}return aa;}};e.exports=r;},null);
__d("MultiChatController",["AsyncSignal","ChatOpenTab","copyProperties","Form","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MercuryMessages').get(),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get();function n(){}i(n,{subscribe:function(o,p){o.subscribe('confirm',function(){this.createGroupThreadFromChooserDialog(o,p);}.bind(this));},createGroupThreadFromChooserDialog:function(o,p){var q=j.serialize(o.getRoot()),r=JSON.parse(q.profileChooserItems),s=[];for(var t in r)if(r[t])s.push(t);var u=n.createThreadForFBIDs(s);l.subscribe('update-thread-ids',function(v,w){for(var x in w)if(w[x]==u)new g('/ajax/groups/chat/log',{group_id:p,message_id:x}).send();});o.hide();},createThreadForTokens:function(o){if(!o.length)return;var p;if(o.length==1){p='user:'+o[0].split(':')[1];}else p='root:'+k.generateNewClientMessageID(Date.now());m.createNewLocalThread(p,o);h.openThread(p,'MultiChatController');},createThreadForFBIDs:function(o){var p=[];for(var q=0;q<o.length;q++)p.push("fbid:"+o[q]);return n.createThreadForTokens(p);}});e.exports=n;},null);
__d("ChatAddFriendsTabSheet",["Arbiter","ArbiterMixin","ChatAddFriendsTabSheetRawRenderer","ChatOpenTab","MercuryConstants","MercuryConfig","MercuryLogMessageType","MercurySourceType","MultiChatController","Style","copyProperties","MercuryMessages","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryMessages').get(),s=b('MercuryThreads').get();function t(x,y,z){this._threadID=x;this._rootElement=y;this._sheetView=z;this._typeahead=null;}q(t.prototype,h,{render:function(){s.getThreadMeta(this._threadID,function(x){var y=x.is_canonical_user?u:v;this._typeahead=i.render(this,this._sheetView,this._rootElement,x,y.bind(null,x),s.isNewEmptyLocalThread(this._threadID));this._typeahead.subscribe('tokens-changed',function(){if(l.GroupThreadNewMessageGK)w(this._typeahead,this._threadID);this.inform('chat/tokens-changed',{token_count:this._typeahead.getTokens().length});}.bind(this));this._typeahead.subscribe('resize',function(){this._sheetView.resize();}.bind(this));}.bind(this));},getParticipants:function(){if(!this._typeahead)return null;return this._typeahead.getSelectedParticipantIDs();},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'add_friends_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);},getHeight:function(){return p.get(this._rootElement,'height');}});function u(x,y){var z=x.participants;o.createThreadForTokens(z.concat(y));}function v(x,y){var z=x.thread_id;if(s.isEmptyLocalThread(z)){s.addParticipantsToThreadLocally(z,y);}else r.sendMessage(r.constructLogMessageObject(n.CHAT_WEB,z,m.SUBSCRIBE,{added_participants:y}));j.openThread(z,'ChatAddFriendsTabSheet');}function w(x,y){var z=x.getTokens();if(z.length===1&&z[0].getInfo().render_type===k.MercuryTypeaheadConstants.THREAD_TYPE){j.openThread(z[0].getValue(),'openGroupChat','');g.inform('chat/close-chat-tab',y);}}e.exports=t;},null);
__d("ChatNameConversationTabSheetRawRenderer",["DOM","Event","Input","Keys","ChatTabTemplates","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m={render:function(n,o,p,q,r,s){var t=k[':fb:mercury:chat:tab-sheet:name-conversation'].build(),u=t.getNode('nameInput'),v=t.getNode('doneButton'),w="\u0e40\u0e23\u0e35\u0e22\u0e1a\u0e23\u0e49\u0e2d\u0e22",x="\u0e0b\u0e48\u0e2d\u0e19",y=q.name;if(y){i.setValue(u,y);}else g.setContent(v,x);var z=function(){var aa=i.getValue(u);if(aa)r(aa);s();o.close(n);};h.listen(u,'input',function(){g.setContent(v,i.getValue(u).length===0?x:w);});h.listen(v,'click',z);h.listen(u,'keyup',function(aa){if(aa.keyCode===j.RETURN){z();return false;}});g.setContent(p,t.getRoot());!n.isAutomatic()&&u.focus();}};e.exports=m;},null);
__d("ChatNameConversationTabSheet",["AsyncRequest","ChatNameConversationTabSheetRawRenderer","MercuryAPIArgsSource","MercuryLogMessageType","MercurySourceType","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryMessages').get(),m=b('MercuryServerRequests').get(),n=b('MercuryThreads').get(),o='/ajax/chat/multichat/name_conversation/dismiss.php',p={};function q(r,s,t){"use strict";this.$ChatNameConversationTabSheet0=r;this.$ChatNameConversationTabSheet1=s;this.$ChatNameConversationTabSheet2=t;this.$ChatNameConversationTabSheet3=false;}q.prototype.render=function(){"use strict";n.getThreadMeta(this.$ChatNameConversationTabSheet0,function(r){h.render(this,this.$ChatNameConversationTabSheet2,this.$ChatNameConversationTabSheet1,r,this.$ChatNameConversationTabSheet4.bind(null,r),this.$ChatNameConversationTabSheet5.bind(this,r));this.$ChatNameConversationTabSheet2.resize();}.bind(this));};q.prototype.isPermanent=function(){"use strict";return true;};q.prototype.isSheetWithInput=function(){"use strict";return true;};q.prototype.getType=function(){"use strict";return 'name_conversation_type';};q.prototype.open=function(r){"use strict";this.$ChatNameConversationTabSheet3=r;if(!(this.$ChatNameConversationTabSheet3&&this.$ChatNameConversationTabSheet6()))this.$ChatNameConversationTabSheet2.open(this);};q.prototype.close=function(){"use strict";this.$ChatNameConversationTabSheet2.close(this);};q.prototype.isAutomatic=function(){"use strict";return this.$ChatNameConversationTabSheet3;};q.prototype.$ChatNameConversationTabSheet6=function(){"use strict";return !!p[this.$ChatNameConversationTabSheet0];};q.prototype.$ChatNameConversationTabSheet7=function(){"use strict";p[this.$ChatNameConversationTabSheet0]=true;};q.prototype.$ChatNameConversationTabSheet5=function(r){"use strict";if(!r.name_conversation_sheet_dismissed||!this.$ChatNameConversationTabSheet6()){this.$ChatNameConversationTabSheet7();m.getServerThreadID(r.thread_id,function(s){new g(o).setData({thread_id:s}).send();});}};q.prototype.$ChatNameConversationTabSheet4=function(r,s){"use strict";var t=r.name;if((s||t)&&(s!=t))l.sendMessage(l.constructLogMessageObject(k.CHAT_WEB,r.thread_id,j.THREAD_NAME,{name:s}),null,i.CHAT);};e.exports=q;},null);
__d("ChatNewMessagesTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:clickable-message-icon-sheet'].build();i.setContent(m.getNode('text'),i.tx._("\u0e40\u0e25\u0e37\u0e48\u0e2d\u0e19\u0e25\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e14\u0e39\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e43\u0e2b\u0e21\u0e48"));i.setContent(this._rootElement,m.getRoot());g.listen(m.getRoot(),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'new_messages_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatNoRecipientsTabSheet",["DOM","fbt","MercuryParticipants","ChatTabTemplates","copyProperties","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryThreadInformer').get(),m=b('MercuryThreads').get();function n(o,p,q){this._threadID=o;this._rootElement=p;this._sheetView=q;l.subscribe('threads-updated',this._handleThreadsUpdated.bind(this));}k(n.prototype,{render:function(){var o=j[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(o.getNode('text'),"Everyone has left the conversation.");g.setContent(this._rootElement,o.getRoot());},isPermanent:function(){return true;},getType:function(){return 'no_recipients_type';},_handleThreadsUpdated:function(){m.getThreadMeta(this._threadID,function(o){var p=i.user,q=o.participants.filter(function(r){return r!=p;});if(q.length<1&&!m.isNewEmptyLocalThread(this._threadID)){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));}});e.exports=n;},null);
__d("ChatOfflineTabSheet",["ChatPrivacyActionController","ChatVisibility","CSS","DOM","Event","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreads').get();function r(s,t,u){this._rootElement=t;this._sheetView=u;this._logger=l.create('blackbird');this._canonicalUser=q.getCanonicalUserInThread(s);if(this._canonicalUser)this._privacyActionController=new g(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(r.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('offline_sheet_open_with_non_friend');return;}var s=n[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build(),t='fbid:'+this._canonicalUser;m.get(t,function(u){var v='fbChatGoOnlineLink',w=j.tx._("\u0e40\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17"),x=j.create('a',{href:'#',className:v},w),y=j.tx._("\u0e2b\u0e32\u0e01\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e01\u0e31\u0e1a {name} \u0e41\u0e25\u0e30\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e04\u0e19\u0e2d\u0e37\u0e48\u0e19\u0e46 {link}",{name:u.short_name,link:x});j.setContent(s.getNode('text'),y);i.addClass(s.getRoot(),"_1sk1");j.setContent(this._rootElement,s.getRoot());k.listen(this._rootElement,'click',function(event){if(i.hasClass(event.getTarget(),v)){if(h.isOnline())this._logger.error('tab_sheet_already_online');this._privacyActionController.togglePrivacy();this._logger.log('tab_sheet_go_online',{tab_id:this._canonicalUser});return false;}}.bind(this));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(s){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');switch(s){case g.OFFLINE:this._sheetView.open(this);break;case g.NORMAL:case g.BLOCKED:this._sheetView.close(this);break;}},isPermanent:function(){return true;},getType:function(){return 'offline_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=r;},null);
__d("ChatUploadWarningTabSheet",["DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i){function j(k,l,m){this._threadID=k;this._rootElement=l;this._sheetView=m;}i(j.prototype,{render:function(){var k=h[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(k.getNode('text'),g.tx._("\u0e01\u0e48\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e04\u0e38\u0e13\u0e08\u0e30\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21 \u0e42\u0e1b\u0e23\u0e14\u0e23\u0e2d\u0e08\u0e19\u0e01\u0e27\u0e48\u0e32\u0e01\u0e32\u0e23\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e08\u0e30\u0e40\u0e2a\u0e23\u0e47\u0e08\u0e2a\u0e21\u0e1a\u0e39\u0e23\u0e13\u0e4c"));g.setContent(this._rootElement,k.getRoot());},isPermanent:function(){return false;},getType:function(){return 'upload_warning_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=j;},null);
__d("ChatReadOnlyTabSheet",["React","MercuryReadOnlyReason","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){var j=b('MercuryThreads').get();function k(l,m,n){"use strict";this.$ChatReadOnlyTabSheet0=l;this.$ChatReadOnlyTabSheet1=m;this.$ChatReadOnlyTabSheet2=n;}k.prototype.render=function(){"use strict";var l=h.getReason(j.getThreadMetaNow(this.$ChatReadOnlyTabSheet0));g.renderComponent(g.createElement(g.DOM.div,{className:"_87-"},l),this.$ChatReadOnlyTabSheet1);};k.prototype.isPermanent=function(){"use strict";return false;};k.prototype.getType=function(){"use strict";return 'chat-thread-is-read-only';};k.prototype.open=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};k.prototype.close=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};e.exports=k;},null);
__d("ChatThreadIsMutedTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:message-mute-sheet'].build();i.setContent(m.getNode('text'),i.tx._("This conversation is muted. Chat tabs will not pop up for it and push notifications are off."));i.setContent(this._rootElement,m.getRoot());g.listen(m.getNode('unmuteButton'),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return false;},getType:function(){return 'chat-thread-is-muted';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatUserBlockedTabSheet",["CSS","ChatPrivacyActionController","DOM","Event","GenderConst","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","tx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get();function s(t,u,v){this._rootElement=u;this._sheetView=v;this._logger=l.create('blackbird');this._canonicalUser=r.getCanonicalUserInThread(t);if(this._canonicalUser)this._privacyActionController=new h(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(s.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('user_blocked_sheet_open_with_non_friend');return;}var t=n[':fb:mercury:chat:tab-sheet:user-blocked'].build(),u='fbid:'+this._canonicalUser;m.get(u,function(v){var w=null;switch(v.gender){case k.FEMALE_SINGULAR:case k.FEMALE_SINGULAR_GUESS:w=q._("\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name} \u0e41\u0e15\u0e48\u0e04\u0e38\u0e13\u0e08\u0e30\u0e22\u0e31\u0e07\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e16\u0e36\u0e07\u0e40\u0e18\u0e2d\u0e44\u0e14\u0e49",{name:v.short_name});break;case k.MALE_SINGULAR:case k.MALE_SINGULAR_GUESS:w=q._("\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name} \u0e41\u0e15\u0e48\u0e04\u0e38\u0e13\u0e08\u0e30\u0e22\u0e31\u0e07\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e16\u0e36\u0e07\u0e40\u0e02\u0e32\u0e44\u0e14\u0e49",{name:v.short_name});break;default:w=q._("\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name} \u0e41\u0e15\u0e48\u0e04\u0e38\u0e13\u0e08\u0e30\u0e22\u0e31\u0e07\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e16\u0e36\u0e07\u0e1e\u0e27\u0e01\u0e40\u0e02\u0e32\u0e44\u0e14\u0e49",{name:v.short_name});}i.setContent(t.getNode('text'),w);var x=q._("\u0e40\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name} \u0e43\u0e0a\u0e48\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48",{name:v.short_name});i.setContent(t.getNode('actionLink'),x);g.addClass(t.getRoot(),"_1sk0");i.setContent(this._rootElement,t.getRoot());j.listen(t.getNode('actionLink'),'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(t){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');if(t==h.BLOCKED){var u='fbid:'+this._canonicalUser;m.get(u,function(v){if(v.is_friend){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));return;}this._sheetView.close(this);},isPermanent:function(){return true;},getType:function(){return 'user_blocked_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=s;},null);
__d("MercurySheetPolicy",[],function(a,b,c,d,e,f){var g={canReplaceOpenSheet:function(h,i){if(h.isSheetWithInput&&h.isSheetWithInput())return i.getType()!=h.getType()&&i.isSheetWithInput&&i.isSheetWithInput();if(h.getType()==i.getType())return false;if(h.isPermanent()&&!i.isPermanent())return false;return true;}};e.exports=g;},null);
__d("MercurySheetView",["Animation","ArbiterMixin","MercurySheetPolicy","CSS","DOM","Style","MercurySheetTemplates","Vector","copyProperties","cx","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=5000,s=function(t,u,v){this._threadID=t;this._rootElement=u;this._tabMainElement=v;this._openSheet=null;};o(s.prototype,h,{destroy:function(){k.empty(this._rootElement);},_openCommon:function(t,u){if(this._openSheet&&!i.canReplaceOpenSheet(this._openSheet,t)){if(t.couldNotReplace)t.couldNotReplace();return;}this.clear(function(){this._openSheet=t;var v=m[':fb:mercury:tab-sheet:loading'].build().getRoot();k.setContent(this._rootElement,v);j.show(v);j.show(this._rootElement);t.render();if(u){j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var w=n.getElementDimensions(this._rootElement).y;l.set(this._rootElement,'bottom',w+'px');this.resize();this._animation=new g(this._rootElement).to('bottom',0).duration(150).ease(g.ease.both).ondone(function(){j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this.resize();}.bind(this)).go();}else this.resize();if(!t.isPermanent()){var x=r;if(t.getCloseTimeout)x=t.getCloseTimeout();var y=this.getAutoCloseCallback(t);this._sheetCloseHandler=q(this.close.bind(this,t,y),x);if(t.timeoutCanBeReset)t.setResetTimeoutCallback(this.resetTimeout.bind(this));}}.bind(this));},getAutoCloseCallback:function(t){if(!t.autoCloseCallback)return null;return t.autoCloseCallback.bind(t);},resetTimeout:function(t,u){clearTimeout(this._sheetCloseHandler);var v=this.getAutoCloseCallback(t);this._sheetCloseHandler=q(this.close.bind(this,t,v),u);},set:function(t){return this._openCommon(t,false);},open:function(t){return this._openCommon(t,true);},close:function(t,u){if(this._openSheet!=t)return;if(!this._openSheet){u&&u();return;}if(this._animation)this._animation.stop();if(this._sheetCloseHandler){clearTimeout(this._sheetCloseHandler);this._sheetCloseHandler=null;}j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var v=n.getElementDimensions(this._rootElement).y;this.resize();this._animation=new g(this._rootElement).to('bottom',v+'px').duration(100).ease(g.ease.begin).ondone(function(){k.empty(this._rootElement);j.hide(this._rootElement);j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this._openSheet=null;this.resize();u&&u();}.bind(this)).go();},clear:function(t){this.close(this._openSheet,t);},resize:function(){this.inform('resize');}});e.exports=s;},null);
__d("ChatTabSheetController",["ChatAddFriendsTabSheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatUploadWarningTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMutedTabSheet","ChatUserBlockedTabSheet","copyProperties","MercurySheetView","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get(),s=function(t,u,v){this._sheetView=new q(t,u,v);this._addFriendsTabSheet=new g(t,u,this._sheetView);this._nameConversationTabSheet=new h(t,u,this._sheetView);this._userBlockedTabSheet=new o(t,u,this._sheetView);this._offlineTabSheet=new k(t,u,this._sheetView);this._newMessagesTabSheet=new i(t,u,this._sheetView);this._uploadWarningTabSheet=new l(t,u,this._sheetView);this._threadIsMutedTabSheet=new n(t,u,this._sheetView);this._readOnlyTabSheet=new m(t,u,this._sheetView);if(!r.getCanonicalUserInThread(t))this._noRecipientsTabSheet=new j(t,u,this._sheetView);};p(s.prototype,{openAddFriendsSheet:function(){this._addFriendsTabSheet.open();},getAddFriendsTabSheet:function(){return this._addFriendsTabSheet;},getAddFriendsParticipants:function(){var t=this._addFriendsTabSheet.getParticipants();this._addFriendsTabSheet.close();return t;},openNameConversationSheet:function(t){this._nameConversationTabSheet.open(t);},openReadOnlySheet:function(){this._readOnlyTabSheet.open();},openNewMessagesSheet:function(){this._newMessagesTabSheet.open();},openUploadWarningTabSheet:function(){this._uploadWarningTabSheet.open();},openThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.open();},closeAutomaticNameConversationSheet:function(){if(this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();},closeThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.close();},closeNewMessagesSheet:function(){this._newMessagesTabSheet.close();},closeUploadWarningTabSheet:function(){this._uploadWarningTabSheet.close();},onClickNewMessagesSheet:function(t){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',t);},onClickThreadIsMutedSheet:function(t){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',t);},onResize:function(t){this._sheetView.subscribe('resize',t);},onTokensChanged:function(t){this._addFriendsTabSheet.subscribe('chat/tokens-changed',t);},destroy:function(){this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();}});e.exports=s;},null);
__d("ChatVideoCallButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=i.createClass({displayName:'ChatVideoCallButton',mixins:[h],propTypes:{onClick:i.PropTypes.func,shown:i.PropTypes.bool,tooltipLabel:i.PropTypes.string},getDefaultProps:function(){return {tooltipLabel:("\u0e40\u0e23\u0e34\u0e48\u0e21\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e17\u0e32\u0e07\u0e27\u0e34\u0e14\u0e35\u0e42\u0e2d")};},render:function(){var n=j.getTrackingInfo(j.types.VIDEOCHAT),o=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (i.createElement(g,{'aria-label':this.props.tooltipLabel,className:(("videoicon")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),'data-ft':n,'data-gt':o,'data-hover':"tooltip",'data-tooltip-position':"above",onClick:this.props.onClick}));}});e.exports=m;},null);
__d("EmoticonUtils",["EmoticonsList","Parent","endsWith","startsWith"],function(a,b,c,d,e,f,g,h,i,j){var k='emoticon_',l=g.symbols,m={getEmoteFromTarget:function(n){var o=h.byClass(n,'emoticon');if(!o)return null;var p=null;o.className.split(' ').forEach(function(q){if(j(q,k))p=q.substring(k.length);});return l[p]||null;},insertEmoticon:function(n,o,p){var q=o.substring(0,p.start),r=o.substring(p.end);if(p.start>0&&!i(q,' '))n=' '+n;if(!j(r,' '))n+=' ';var s=q+n+r;p.start+=n.length;p.end=p.start;return {result:s,start:p.start,end:p.end};}};e.exports=m;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler","merge"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this.$SelectionPosition0=l;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}k.prototype.getPos=function(){"use strict";return j(this.$SelectionPosition1);};k.prototype.setPos=function(l,m){"use strict";this.$SelectionPosition1={start:l,end:m};this.restore();};k.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};k.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};k.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};k.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=k;},null);
__d("StickerTrigger",["StickerConfig","StickerSearch","StickerServerRequests"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=g.StickerTriggerThreshold,k={findTriggerForInput:function(l,m){h.prepareTagsData().then(function(){return this.findTagForInput(l,function(n,o){return m(n,o);});}.bind(this));},findTagForInput:function(l,m){var n=this.findTriggeredWord(l);if(n){i.getStickersForQuery(n,function(o){return m(o.getPayload(),n);});}else m([],null);},_getRegex:function(){var l=null;if(g.TriggerConfidence==='emoji_only'){l=g.EmoticonRegex;}else if(g.TriggerConfidence==='high')l='^\\w+$';return new RegExp(l);},findTriggeredWord:function(l){var m=h.getTagsIndex();if(!m)return null;l=l.toLowerCase();var n=l.match(this._getRegex()),o=j,p=null;for(var q=0;n!==null&&q<n.length;q++)if(m[n[q]]&&m[n[q]].sticker_count>o){o=m[n[q]].sticker_count;p=n[q];}return p;}};e.exports=k;},null);
__d("StickersFlyoutTriggerSelector.react",["BanzaiLogger","React","Sticker.react","StickerTrigger","StickerUtils","XUIContextualDialog.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=84,o=h.createClass({displayName:'StickersFlyoutTriggerSelector',propTypes:{context:h.PropTypes.object.isRequired,input:h.PropTypes.string,onStickerSelect:h.PropTypes.func.isRequired,onTriggerChanged:h.PropTypes.func.isRequired},getDefaultProps:function(){return {input:null};},getInitialState:function(){return {stickers:[],triggeredWord:null};},componentWillReceiveProps:function(p){if(!p.input){this._resetFlyout();}else if(p.input!==this.props.input)j.findTriggerForInput(p.input,this._onTriggerChanged);},shouldComponentUpdate:function(p,q){return this.state.triggeredWord!==q.triggeredWord;},_resetFlyout:function(){this.setState(this.getInitialState());},_onTriggerChanged:function(p,q){if(this.props.input&&this.props.input.indexOf(q)===-1){this._resetFlyout();return;}if(q)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:p.length,triggeredword:q,triggerused:false});this.props.onTriggerChanged(q);this.setState({stickers:p,triggeredWord:q});},_onStickerSelect:function(p){g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',stickerid:p,triggeredword:this.state.triggeredWord,triggerused:true});this.props.onStickerSelect(p);this._resetFlyout();},_renderStickers:function(){if(!this.state.stickers||this.state.stickers.length===0)return null;var p=Math.floor(Math.random()*Math.min(this.state.stickers.length,5)),q=this.state.stickers[p],r=k.getScaledDimensions(q.height,q.width);return (h.createElement(h.DOM.div,{className:"_5r8h _onc",'data-id':q.id,onClick:function(){return this._onStickerSelect(q.id);}.bind(this)},h.createElement(i,{animationTrigger:"hover",className:"_5r8i",frameCount:q.frameCount,frameRate:q.frameRate||83,framesPerCol:q.framesPerCol,framesPerRow:q.framesPerRow,sourceHeight:r.height,sourceURI:q.sourceURI,sourceWidth:r.width,spriteURI:q.spriteURI,paddedSpriteURI:q.paddedSpriteURI,stickerID:q.id,style:{cursor:'pointer'}})));},render:function(){return (h.createElement(l,{alignment:"left",autoFocus:false,context:this.props.context,onBlur:this._resetFlyout,offsetX:4,position:"above",shown:this.state.stickers&&this.state.stickers.length>0,width:n},this._renderStickers()));}});e.exports=o;},null);
__d("StickerSearchNUX.react",["React","ReactLayeredComponentMixin","StickerServerRequests","XUIAmbientNUX.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'StickerSearchNUX',mixins:[h],getInitialState:function(){return {nuxShown:true};},componentDidMount:function(){i.markSeenSearchTooltipNUX();},hideNUX:function(){this.setState({nuxShown:false});},onCloseButtonClicked:function(){this.hideNUX();this.props.showIndicatorFunc();},renderLayers:function(){return {stickerSearchNUX:g.createElement(j,{ref:"NUX",contextRef:"container",shown:this.state.nuxShown,position:"above",width:"auto",onCloseButtonClick:this.onCloseButtonClicked},"\u0e02\u0e13\u0e30\u0e19\u0e35\u0e49\u0e04\u0e38\u0e13\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e2a\u0e15\u0e34\u0e01\u0e40\u0e01\u0e2d\u0e23\u0e4c\u0e44\u0e14\u0e49\u0e41\u0e25\u0e49\u0e27!")};},render:function(){return (g.createElement(g.DOM.span,{ref:"container"}));}});e.exports=l;},null);
__d("StickerTriggerIndicator.react",["BanzaiLogger","React","StickerTrigger","cx"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=h.createClass({displayName:'StickerTriggerIndicator',propTypes:{input:h.PropTypes.string,onTriggerChanged:h.PropTypes.func.isRequired},getDefaultProps:function(){return {input:null};},getInitialState:function(){return {shown:false};},componentWillReceiveProps:function(l){if(!l.input){this.setState({shown:false});}else if(l.input!==this.props.input)i.findTriggerForInput(l.input,this._onTriggerChanged);},_onTriggerChanged:function(l,m){if(m)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:l.length,triggeredword:m,triggerused:false});this.props.onTriggerChanged(m);this.setState({shown:l&&l.length>0});},render:function(){return h.createElement(h.DOM.span,{className:((this.state.shown?"emoticonIndicator":''))});}});e.exports=k;},null);
__d("XStickerReplyNUXControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AsyncSignal","AvailableListConstants","BanzaiLogger","BanzaiODS","ChatAddToThreadButton.react","ChatArchiveWarning.react","ChatBehavior","ChatConfig","ChatContextualDialogController","ChatInput.react","ChatOpenTab","ChatPhotoUploader.react","ChatPrivacyActionController","ChatQuietLinks","ChatShareLinkUploader","ChatStickerButton.react","ChatTabMenu.react","ChatTabMessagesView","ChatTabSheetController","ChatVisibility","ChatVideoCallButton.react","MercuryConstants","ContentRollFlyout.react","CurrentUser","CSS","CurrentLocale","Dialog","Dock","DOM","DOMEvent","DOMQuery","DragDropTarget","EmoticonsList","EmoticonUtils","Event","Focus","Input","Keys","Locale","MercuryConfig","MercuryIDs","MercuryFileUploader","MercuryLogMessageType","MercuryParticipants","MercurySourceType","MercuryThreadMetadataRawRenderer","MercuryThreadMuter","MercuryTypingAnimation.react","MercuryTypingReceiver","NubController","Parent","PhotosUploadWaterfall","PresencePrivacy","PresenceStatus","React","Run","SelectionPosition","StickerActions","StickerConfig","StickerConstants","StickersFlyout.react","StickersFlyoutTriggerSelector.react","StickerState","StickerSearchNUX.react","StickerTriggerIndicator.react","Style","SubscriptionsHandler","ChatTabTemplates","TextAreaControl","Toggler","Tooltip","TypingDetectorController","URI","UserAgent_DEPRECATED","VideoCallCore","WaterfallIDGenerator","WebMessengerThreadPermalinks","XStickerReplyNUXControllerURIBuilder","copyProperties","cx","csx","fbt","getActiveElement","isEmpty","setIntervalAcrossTransitions","tx","OrionTrigger","MercuryMessages","MercuryServerRequests","MercuryThreadInformer","MercuryThreadMetadataRenderer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc){"use strict";var sc=b('OrionTrigger').module,tc=b('MercuryMessages').get(),uc=b('MercuryServerRequests').get(),vc=b('MercuryThreadInformer').get(),wc=b('MercuryThreadMetadataRenderer').get(),xc=b('MercuryThreadActions').get(),yc=b('MercuryThreads').get(),zc=/^\s*$/,ad={},bd=null,cd,dd=10;function ed(zd,ae){var be=ma.create('div');ae=ae&&ae.filter(function(ee){return ee!=bb.user;});if(pc(ae))return cc.remove(zd);var ce=ae.length,de=ce-dd;if(de>1)ae=ae.slice(0,dd);bb.getMulti(ae,function(ee){for(var fe in ee){var ge=ee[fe],he=zb[':fb:mercury:chat:multichat-tooltip-item'].build();ma.setContent(he.getNode('name'),ge.name);var ie=ya.getUserIDFromParticipantID(fe),je=ie&&lb.get(ie)==l.ACTIVE;ia.conditionShow(he.getNode('icon'),je);ia.conditionClass(he.getNode('name'),'tooltipItemWithIcon',je);ma.appendContent(be,he.getRoot());}if(de>1){var ke=nc._("and {number of hidden chat participants} more.",[nc.param("number of hidden chat participants",de)]);ma.appendContent(be,ma.create('div',{},ke));}cc.set(zd,be,'above');});}var fd={},gd=null,hd=false;function id(zd,ae,be){if(be){fd[zd]=ae;if(!gd)gd=qc(jd,600);}else{ia.removeClass(ae,'highlightTitle');delete fd[zd];}}function jd(){for(var zd in fd){var ae=fd[zd];if(ae.parentNode){ia.conditionClass(ae,'highlightTitle',hd);}else delete fd[zd];}hd=!hd;if(!Object.keys(fd).length){clearInterval(gd);gd=null;}}function kd(zd){var ae=ya.tokenize(zd);switch(ae.type){case 'user':return zb[':fb:mercury:chat:user-tab'].build();}return zb[':fb:mercury:chat:multichat-tab'].build();}function ld(zd){var ae=zd._getInputValue(),be=zd._fileUploader.getAttachments();if(rd(zd))nd(zd,ae,be,function(ce){var de=zd._fileUploader.getImageFiles();if(de.length>0){ce.image_ids=de;ce.has_attachment=true;}var ee=zd._fileUploader.getVideoFiles();if(ee.length>0){ce.video_ids=ee;ce.has_attachment=true;}var fe=zd._fileUploader.getAudioFiles();if(fe.length>0){ce.audio_ids=fe;ce.has_attachment=true;}var ge=zd._fileUploader.getFiles();if(ge.length>0){ce.file_ids=ge;ce.has_attachment=true;}tc.sendMessage(ce);zd._fileUploader.removeAttachments();zd._shareLinkUploader.clear();if(!r.get('chat_react_input'))zd._getNode('input').value='';zd._typingDetector&&zd._typingDetector.resetState();zd._messagesView&&zd._messagesView.setShouldScrollToBottom(true);});}function md(zd,ae){if(ae===0)return;ud(zd,jb.POST_PUBLISHED,{count:ae});zd._waterfallID=hc.generate();}function nd(zd,ae,be,ce){yc.getThreadMeta(zd._threadID,function(de){var ee=tc.constructUserGeneratedMessageObject(ae,cb.CHAT_WEB,zd._threadID);if(be.length>0){ee.has_attachment=true;ee.raw_attachments=be;}var fe=zd._shareLinkUploader.getAttachData();if(fe){ee.has_attachment=true;ee.content_attachment=fe;}if(yc.isNewEmptyLocalThread(zd._threadID)){var ge=zd._sheetController.getAddFriendsParticipants();if(ge===null||ge.length===0)return;ge=ge.filter(function(ie){return ie!=bb.user;});if(ge.length===0){ee.thread_id=ya.getThreadIDFromUserID(ha.getID());}else if(ge.length===1){ee.thread_id=ya.getThreadIDFromParticipantID(ge[0]);}else yc.addParticipantsToThreadLocally(zd._threadID,ge);}if(yc.isEmptyLocalThread(zd._threadID)){var he=ya.tokenize(zd._threadID);ee.message_id=he.value;ee.specific_to_list=de.participants;}if(typeof ee!='undefined')ee.signatureID=zd._signatureID;ee.ui_push_phase=fa.UIPushPhase;ce(ee);if(zd._threadID!==ee.thread_id&&!zd._photoUploader.isUploading()){vd.inform('closed-tab',zd._threadID);u.openThread(ee.thread_id,'ChatTabView');}});}function od(zd){zd._blocked=true;zd._sheetController.openUploadWarningTabSheet();}function pd(zd){return (zd._fileUploader.isUploading()||zd._photoUploader.isUploading());}function qd(zd){return zd._fileUploader.isUploading();}function rd(zd){var ae=zd._getInputValue();if(!zc.test(ae))return true;if(zd._fileUploader.getAttachments().length>0||zd._fileUploader.getImageFiles().length>0||zd._fileUploader.getVideoFiles().length>0||zd._fileUploader.getAudioFiles().length>0||zd._fileUploader.getFiles().length>0)return true;if(zd._shareLinkUploader.getAttachData())return true;return false;}function sd(zd){if(zd._blocked){if(qd(zd))return;zd._blocked=false;ld(zd);zd._sheetController.closeUploadWarningTabSheet();}}function td(zd){zd._nubController.flyoutContentChanged();zd._attachmentsDiv.scrollTop=zd._attachmentsDiv.scrollHeight;}function ud(zd,ae,be){jb.sendSignal(kc({qn:zd._waterfallID,step:ae,uploader:jb.APP_CHAT},be||{}));}function vd(zd,ae,be,ce,de){if(ae)uc.ensureThreadIsFetched(ae);this._threadID=zd;this._signatureID=be;this._eventListeners=[];this._isDragDropActive=false;this._tabTemplate=kd(zd);this._tabElem=this._tabTemplate.getRoot();if(de){this.insertBefore(de);}else this.appendTo(ce);this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._waterfallID=hc.generate();this._subscriptionsHandler=new yb();this._initializeAutoSendPhotoUploader();this._stickersFlyoutShown=false;var ee=oa.scry(this._tabElem,"._1ia");if(ee&&ee.length>0){this._dropTarget=new pa(ee[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}this._attachmentsDiv=this._getNode('attachmentShelf');this._sheetController=new ca(this._threadID,this._getNode('sheet'),this._tabElem);if(r.get('chat_react_option_menu')){this._initializeReactMenu(this._tabTemplate.getNode('attachmentShelf'));}else{this._fileUploader=new za(this._tabTemplate.getNode('attachmentShelf'),this._tabTemplate.getNode('attachButtonForm'),this._tabTemplate.getNode('fileInput'),this._tabTemplate.getNode('attachID'));this._initializeUploader(this._fileUploader);}this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();vd.inform('read',this._threadID);}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){xc.unmute(this._threadID);this.focus();}.bind(this));this._nubController=new hb().init(this._tabElem);this._sheetController.onResize(this._nubController.flyoutContentChanged.bind(this._nubController));this._sheetController.onTokensChanged(function(oe,pe){yc.getThreadMeta(this._threadID,function(qe){this._updateControls(qe,pe.token_count);}.bind(this));}.bind(this));if(bd===null)bd=!r.get('seen_autosend_photo_nux');this._messagesView=null;var fe=this._getNode('titlebarText'),ge=function(oe){fe.setAttribute('href',oe);fe.removeAttribute('rel');ia.removeClass(fe,'noLink');};if(r.get('chat_react_option_menu')){ic.getThreadURI(zd,function(oe){return ge(oe);});}else{var he=this._getNode('conversationLink');ia.hide(he);wc.renderWebMessengerLink(zd,he,function(){ia.show(he);ge(he.href);});}if(!yc.getCanonicalUserInThread(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var ie=this._getCanonicalUserID();if(this._getCanonicalUserID()){bb.get(ya.getParticipantIDFromUserID(ie),function(oe){if(oe.href)ge(oe.href);});}else if(r.get('chat_react_option_menu')&&this._reactChatTabMenu.props.fullURL){ge(this._reactChatTabMenu.props.fullURL);}else if(he&&he.href)ge(he.href);this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));this._setNameConversationLink();this._listen('closeButton','click',this._closeClicked);this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('addFriendLink','click',this._addFriendLinkClicked,true);this._listen('nameConversationLink','click',this._nameConversationLinkClicked,true);this._listen('clearWindowLink','click',this._clearHistory,true);this._listen('unsubscribeLink','click',this._unsubscribeLinkClicked,true);this._listen('reportSpamLink','click',this._reportSpamClicked,true);this._listen('createGroupLink','click',this._createGroupClicked,true);this._listen('enableDesktopNotif','click',this._enableDesktopNotif,true);this._listen('muteThreadLink','click',eb.showMuteChangeDialog.bind(null,this._threadID),true);this._listen('unmuteThreadLink','click',function(){xc.unmute(this._threadID);bc.hide();}.bind(this),true);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===va.TAB){this._focusInput();event.kill();}}.bind(this));this._stickersFlyoutToggler=this._getNode('emoticons');this._initializeInput();if(qb.WebStickerTrigger){this._triggeredWord=null;this._stickerTrigger=null;this._stickerTriggerNode=null;if(qb.TriggerInterface==='one_tap'){this._stickerTrigger=mb.renderComponent(mb.createElement(tb,{context:this._stickersFlyoutToggler,onStickerSelect:this._stickerSelected.bind(this),onTriggerChanged:this._onTriggerChanged.bind(this)}),this._getNode('stickersTriggerFlyoutContainer'));this._stickerTriggerNode=this._getNode('stickersTriggerFlyoutContainer');}else if(qb.TriggerInterface==='hyperlink'){this._stickerTrigger=mb.renderComponent(mb.createElement(wb,{onTriggerChanged:this._onTriggerChanged.bind(this)}),this._getNode('emoticonIndicator'));this._stickerTriggerNode=this._getNode('emoticonIndicator');}}if(ub.shouldShowStickerSearchNUXIndicator()){this._addStickerSearchNUXIndicator();this._listen('emoticons','click',function(){if(ub.shouldShowStickerSearchNUXIndicator()){pb.selectPack(rb.SEARCH_PACK_ID);ub.clearShowStickerSearchNUXIndicator();}g.inform('stickerSearchNUXIndicator/hide');},true);g.subscribeOnce('stickerSearchNUXIndicator/hide',function(){this._clearStickerSearchNUXIndicator();this._clearStickerSearchNUXTooltip();}.bind(this));vd.subscribe('lower-activated',function(oe,pe){if(pe===this._threadID&&ub.shouldShowStickerSearchNUXIndicator()){this._clearStickerSearchNUXTooltip();this._addStickerSearchNUXIndicator();}}.bind(this));}if(r.get('chat_react_sticker_button')){this._stickerButton=mb.renderComponent(mb.createElement(z,{onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this)}),this._getNode('stickerButtonContainer'));n.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var je=this._getNode('stickers');if(je)this._stickersFlyout=mb.renderComponent(mb.createElement(sb,{onStickerSelect:function(oe){this._stickerSelected(oe);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)}),je);this._eventListeners.push(ub.addListener(ub.PACK_SELECTED,function(oe){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:oe});}.bind(this)));}if(sc){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=mb.renderComponent(mb.createElement(sc,{onTrigger:this._orionTriggered.bind(this)}),this._orionTriggerContainer);}var ke=this._getNode('contentRoll');if(ke)mb.renderComponent(mb.createElement(ga,{onSelection:function(oe){this._shareLinkUploader&&this._shareLinkUploader.loadShare(oe.url,{content_roll_entry:oe});this.focus();}.bind(this),userID:ha.getID()}),ke);this._privacyLink=this._getNode('privacyLink');if(this._privacyLink){this._privacyActionController=new w(ie,this._updatePrivacyLink.bind(this));this._eventListeners.push(sa.listen(this._privacyLink,'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController)));}yc.getThreadMeta(this._threadID,function(oe){this._setUpMutingSettings(oe);}.bind(this));var le=this._getNode('muteGroupLink');if(le){var me=yc.getCanonicalGroupInThread(this._threadID);if(me)le.setAttribute('ajaxify',ec(le.getAttribute('ajaxify')).addQueryData({id:me}));}x.removeEmptyHrefs(this._tabElem);ad[zd]=this;this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);var ne={threadID:zd,userID:ie,signatureID:this._signatureID};new k('/ajax/chat/opentab_tracking.php',ne).send();nb.onBeforeUnload(function(){if(this._hasUnfinishedPost())return "You haven't sent your message yet. Do you want to leave without sending?";if(tc.getNumberLocalMessages(this._threadID))return "Your message is still being sent. Are you sure you want to leave?";return null;}.bind(this),false);nb.onUnload(function(){wd(this);}.bind(this));}function wd(zd){if(zd._photoUploader.isUploading())ud(zd,jb.CANCEL_DURING_UPLOAD);}function xd(){for(var zd in ad){ad[zd].updateAvailableStatus();ad[zd].updateMultichatTooltip();}}g.subscribe(['buddylist/availability-changed'],xd);kb.subscribe(['privacy-changed','privacy-availability-changed'],xd);q.subscribe(q.ON_CHANGED,function(){for(var zd in ad)yc.getThreadMeta(zd,function(ae){ad[zd]._updateUnreadCount(ae);});});gb.addRetroactiveListener('state-changed',function(zd){for(var ae in zd){var be=zd[ae]&&zd[ae].length,ce=ad[ae];ce&&ce.showTypingIndicator(be);}});vc.subscribe('threads-updated',function(zd,ae){for(var be in ad){var ce=ad[be];ae[be]&&ce.updateTab();if(ce._newThreadIDFromPhotoUpload&&!ce._photoUploader.isUploading()&&ae[ce._newThreadIDFromPhotoUpload]){vd.inform('closed-tab',ce._threadID);u.openThread(ce._newThreadIDFromPhotoUpload,'ChatTabView');ce._newThreadIDFromPhotoUpload=null;}}});vc.subscribe('threads-deleted',function(zd,ae){for(var be in ad)ae[be]&&vd.inform('thread-deleted',be);});kc(vd,h,{get:function(zd){return ad[zd];}});kc(vd.prototype,{getThreadID:function(){return this._threadID;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(zd){setTimeout((function(){this._sheetController.openNameConversationSheet(zd);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return ia.shown(this._tabElem);},setVisibleState:function(zd,ae){var be=ia.shown(this._tabElem),ce=ia.hasClass(this._tabElem,'opened');ia.conditionShow(this._tabElem,zd);ia.conditionClass(this._tabElem,'opened',ae);if(!(be&&ce)&&zd&&ae){if(!this._messagesView)this._messagesView=new ba(this._threadID,this._sheetController,this._getNode('chatConv'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}if(be&&ce&&!(zd&&ae))this._contextualDialogController&&this._contextualDialogController.tabNotActive();},focus:function(){if(ia.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var zd=oc();return ib.byClass(zd,"_50mz")===this._tabElem;},hasEmptyInput:function(){var zd;if(r.get('chat_react_input')){zd=this._chatInput.getValue();}else zd=this._getNode('input').value;return zc.test(zd);},getInputElem:function(){if(r.get('chat_react_input')){return this._chatInput.getDOMNode();}else return this._getNode('input');},setStickersFlyoutPackID:function(zd){if(this._stickerButton){this._setPackIDReact(zd);}else this._setPackIDLegacy(zd);},_linkDropped:function(zd){this._shareLinkUploader.loadShare(zd);},_filesDropped:function(zd){if(this._fileUploader)this._fileUploader.addDroppedFiles(zd);},showStickerSearchNUXTooltip:function(){if(cd)return;cd=true;this._clearStickerSearchNUXIndicator();this._stickerSearchNUXTooltip=mb.renderComponent(mb.createElement(vb,{showIndicatorFunc:this._addStickerSearchNUXIndicator.bind(this)}),this._getNode('tooltipNUXContainer'));},_setPackIDLegacy:function(zd){var ae=this._stickersFlyout;if(!this._stickersFlyoutToggler||!ae||!ae.isMounted())return;pb.selectPack(zd);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(zd){if(!this._stickerButton.isMounted())return;pb.selectPack(zd);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(zd){this._stickerButton.showFlyout();this._stickersFlyoutShown=zd;},_toggleStickersFlyoutShownLegacy:function(zd){if(zd){bc.show(this._stickersFlyoutToggler);}else bc.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=zd;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(cd)return;var zd=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new j(new jc().getURI()).setRelativeTo(zd).setData({thread_id:this._threadID}).setHandler(function(ae){ub.clearShowStickerReplyNUX();}).send();},insertBefore:function(zd){ma.insertBefore(zd._tabElem,this._tabElem);},appendTo:function(zd){ma.appendContent(zd,this._tabElem);},nextTabIs:function(zd){var ae=zd&&zd._tabElem;return this._tabElem.nextSibling==ae;},getScrollTop:function(){return ma.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop;},setScrollTop:function(zd){ma.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop=zd;},destroy:function(){ma.remove(this._tabElem);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();if(r.get('chat_react_option_menu')){mb.unmountComponentAtNode(this._getNode('menuContainer'));}else this._fileUploader&&this._fileUploader.destroy();mb.unmountComponentAtNode(this._getNode('photoUploaderContainer'));if(r.get('chat_react_sticker_button')){mb.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else mb.unmountComponentAtNode(this._getNode('stickers'));if(this._stickerTriggerNode){mb.unmountComponentAtNode(this._stickerTriggerNode);clearTimeout(this._triggerTimeoutID);}this._subscriptionsHandler&&this._subscriptionsHandler.release();this._contextualDialogController&&this._contextualDialogController.destroy();this._privacyActionController&&this._privacyActionController.destroy();delete ad[this._threadID];la.unregisterNubController(this._nubController);if(r.get('chat_react_input')){mb.unmountComponentAtNode(this._getNode('inputContainer'));}else ua.reset(this._getNode('input'));},updateAvailableStatus:function(){yc.getThreadMeta(this._threadID,function(zd){var ae=l.OFFLINE,be=this._getCanonicalUserID();if(be){ae=lb.get(be);}else{var ce=zd.participants.map(function(ee){return ya.getUserIDFromParticipantID(ee);});ae=lb.getGroup(ce);}if(!da.isOnline())ae=l.OFFLINE;if(be)this._updateCallLink(ae);ia.conditionClass(this._tabElem,"_5238",ae===l.ACTIVE);ia.conditionClass(this._tabElem,"_42nw",ae===l.IDLE);ia.conditionClass(this._tabElem,"_5239",ae===l.MOBILE);var de=this._getNode('presenceIndicator');switch(ae){case l.ACTIVE:de.setAttribute('alt',"\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c");break;case l.MOBILE:de.setAttribute('alt',"\u0e21\u0e37\u0e2d\u0e16\u0e37\u0e2d");break;default:de.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){this._setNameConversationLink();yc.getThreadMeta(this._threadID,function(zd){wc.renderAndSeparatedParticipantList(this._threadID,[this._getNode('name'),this._getNode('titlebarText')],{names_renderer:db.renderShortNames,check_length:true});this._updateControls(zd);this._updateMutingSettings(zd);this._updateUnreadCount(zd);this.updateMultichatTooltip();this._updateArchiveWarning(zd);this._updateNewThread(zd);this._updateNameConversationSheet(zd);this._updateReadOnlySheet(zd);}.bind(this));},_setNameConversationLink:function(){var zd=this._getNode('nameConversationLink');if(zd)yc.isEmptyLocalThread(this._threadID)?ia.hide(zd):ia.show(zd);},_updateNameConversationSheet:function(zd){if(yc.canReply(zd.thread_id)&&!zd.name&&!zd.is_canonical&&!zd.name_conversation_sheet_dismissed&&!zd.has_email_participant&&!zd.read_only&&!yc.isEmptyLocalThread(zd.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(zd){var ae=yc.canReply(zd.thread_id),be=yc.isEmptyLocalThread(zd.thread_id);if(!ae&&!be)this._sheetController.openReadOnlySheet();},updateSignatureID:function(zd){this._signatureID=zd;},_showPhotoNUXIfNecessary:function(){if(bd){bd=false;new j('/ajax/chat/photo_nux.php').setRelativeTo(this._getNode('photoUploaderContainer')).setData({threadID:this._threadID}).send();return true;}},_setUpMutingSettings:function(zd){var ae=eb.isThreadMuted(zd);if(ae)this._sheetController.openThreadIsMutedTabSheet();this._updateActionMenu(ae);},_updateMutingSettings:function(zd){var ae=eb.isThreadMuted(zd),be;if(r.get('chat_react_option_menu')){be=this._reactChatTabMenu.props.isMuted;}else be=ia.shown(this._getNode('unmuteThreadLink').parentNode);if(ae&&!be){this._sheetController.openThreadIsMutedTabSheet();}else if(!ae&&be)this._sheetController.closeThreadIsMutedTabSheet();this._updateActionMenu(ae);},_updateActionMenu:function(zd){if(r.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({isMuted:zd});}else{ia.conditionShow(this._getNode('muteThreadLink').parentNode,!zd);ia.conditionShow(this._getNode('unmuteThreadLink').parentNode,zd);}},_updateArchiveWarning:function(zd){var ae=false;bb.get(bb.user,function(be){ae=be.employee;if(ae)bb.getMulti(zd.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));}.bind(this));},_updateControls:function(zd,ae){var be=false;if(zd&&zd.thread_id){var ce=ya.tokenize(zd.thread_id);if(ce.type==='user'){var de=ce.value;be=!uc.isUser(de);}}var ee=yc.canReply(zd.thread_id)&&(!pc(zd.participants)||ae);ia.conditionShow(this._inputContainerNode,ee);ia.conditionShow(this._iconsContainerNode,ee);if(!r.get('chat_react_option_menu')){ia.conditionShow(this._getNode('dropdown'),ee);}else if(this._reactChatTabMenu.isMounted()){this._reactChatTabMenu.setProps({isEmptyChat:yc.isNewEmptyLocalThread(zd.thread_id),show:ee});if(be)this._reactChatTabMenu.setProps({showAddFriend:null});}var fe=ee&&!be;if(r.get('chat_react_header')){this._addToThreadButton.isMounted()&&this._addToThreadButton.setProps({shown:fe});}else ia.conditionShow(this._getNode('addToThreadLink'),fe);this._resizeInputContainer();this._updateOrionTrigger(ee);},_updateOrionTrigger:function(zd){if(this._orionTrigger&&zd){var ae=this.getParticipantIDForOrionNUX();ia.conditionShow(this._orionTriggerContainer,ae);if(ae){bb.get(ae,function(be){be.userId=ya.getUserIDFromParticipantID(ae);this._orionTrigger.setProps({receiver:be,disabled:!be.orion_eligible});if(be.orion_eligible&&this.isOrionNUXEligible())this.showOrionNUXTooltip();}.bind(this));}else this._orionTrigger.setProps({receiver:{}});}},getParticipantIDForOrionNUX:function(){var zd=this._sheetController.getAddFriendsTabSheet(),ae=zd.getParticipants(),be=this._getCanonicalUserID(),ce=null;if(be){ce=ya.getParticipantIDFromUserID(be);}else if(ae&&ae.length===1)ce=ae[0];return ce;},showOrionNUXTooltip:function(){if(this._orionTrigger&&xa.ShowOrionNUXTooltip)this._orionTrigger.setShouldShowNUXTooltip();},isOrionNUXEligible:function(){var zd=this.getParticipantIDForOrionNUX();return zd&&this.isVisible()&&ia.hasClass(this._tabElem,'opened');},_resizeInputContainer:function(){var zd=this._tabElem.clientWidth,ae=2,be=zd-(this._inputContainerNode.clientWidth+ae),ce=wa.isRTL()?'left':'right';xb.set(this._iconsContainerNode,ce,be+'px');if(!r.get('chat_react_input'))ac.getInstance(this._getNode('input')).update();},_updateNewThread:function(zd){if(yc.isNewEmptyLocalThread(zd.thread_id))this.showAddFriend();},_showArchiveWarningIfAllParticipantsAreEmployees:function(zd){var ae=true,be=r.get('chat_react_header');for(var ce in zd)ae=ae&&zd[ce].employee;var de=be?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(de){if(this._titlebarTooltipAnchor)ia.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',ae);if(be){this._archiveWarning.isMounted()&&this._archiveWarning.setProps({shown:ae});}else ia.conditionShow(de,ae);}},updateMultichatTooltip:function(){yc.getThreadMeta(this._threadID,function(zd){if(!zd.is_canonical)ed(this._titlebarTooltipAnchor,zd.participants);}.bind(this));},_getNode:function(zd){return this._tabTemplate.getNode(zd);},_getCanonicalUserID:function(){return yc.getCanonicalUserInThread(this._threadID);},_listen:function(zd,event,ae,be){var ce=this._getNode(zd);if(ce){this._eventListeners.push(sa.listen(ce,event,ae.bind(this)));}else if(!be)throw new Error('Could not find node "'+zd+'"');},_closePreClicked:function(zd){this._closeMouseDown=true;},_closeClicked:function(zd){wd(this);vd.inform('closed-tab',this._threadID);zd.kill();},_closeEnter:function(zd){if(zd.keyCode===va.RETURN)this._closeClicked(zd);},_nubClicked:function(zd){if(!this._isDragDropActive){zd.kill();return vd.inform('nub-activated',this._threadID);}},_dockKeyDown:function(event){if(event.keyCode===va.RETURN||event.keyCode===va.SPACE){vd.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===va.ESC){this._handleEscape();if(r.get('chat_react_input'))event=new na(event);event.kill();}else if(event.keyCode===va.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var zd=vd.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(r.get('chat_react_input'))event=new na(event);!zd&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}wd(this);if(this.hasEmptyInput()){vd.inform('esc-pressed',this._threadID);}else{var zd="Are you sure you want to close this chat window?",ae="\u0e04\u0e38\u0e13\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13",be=new ka().setTitle(zd).setBody(ae).setButtons([ka.CLOSE,ka.CANCEL]).setHandler(vd.inform.bind(vd,'esc-pressed',this._threadID,null)).setModal(true).show(),ce=be.getButtonElement('yes');ce&&ta.set(ce);}},_titleClicked:function(event){var zd=event.getTarget();if(!ib.byClass(zd,'titlebarText')&&!ib.byClass(zd,'uiSelector')&&!ib.byClass(zd,'addToThread')&&!ib.byClass(zd,'optionMenu')&&!ib.byClass(zd,'videoicon')&&!this._isDragDropActive){vd.inform('lower-activated',this._threadID);event.kill();}},_callClicked:function(zd){var ae=this._getCanonicalUserID();if(gc.availableForCall(ae)){var be='chat_tab_icon';if(zd.target&&ia.hasClass(zd.target,'video_call_tour'))be='chat_tab_icon_tour';vd.inform('video-call-clicked',{threadID:this._threadID,userID:ae,clickSource:be});}if(r.get('chat_react_header')){zd.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_nameConversationLinkClicked:function(){this.showNameConversation();},_showParticipantsClicked:function(){uc.getServerThreadID(this._threadID,function(zd){i.send(new j(ec('/ajax/browser/dialog/multichat_members/').addQueryData({id:zd})));});},_clearHistory:function(){var zd=yc.getThreadMetaNow(this._threadID);if(zd){var ae=this._getCanonicalUserID();uc.clearChat(this._threadID,ae,zd.timestamp);}},_unsubscribeLinkClicked:function(){var zd=[];zd.push({name:'unsubscribe',label:"\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32",handler:this._unsubscribeToThread.bind(this)});zd.push(ka.CANCEL);new ka().setTitle("\u0e2d\u0e2d\u0e01\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e43\u0e0a\u0e48\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48").setBody("\u0e04\u0e38\u0e13\u0e08\u0e30\u0e2b\u0e22\u0e38\u0e14\u0e23\u0e31\u0e1a\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e19\u0e17\u0e19\u0e32\u0e19\u0e35\u0e49 \u0e41\u0e25\u0e30\u0e04\u0e19\u0e2d\u0e37\u0e48\u0e19\u0e08\u0e30\u0e40\u0e2b\u0e47\u0e19\u0e27\u0e48\u0e32\u0e04\u0e38\u0e13\u0e2d\u0e2d\u0e01").setButtons(zd).show();},_getUserParticipants:function(zd){var ae=[];zd.forEach(function(be){var ce=ya.getUserIDFromParticipantID(be);ce&&ae.push(ce);});return ae;},_createGroupClicked:function(){yc.getThreadMeta(this._threadID,function(zd){if(!zd.is_canonical){var ae=ec('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),be=this._getUserParticipants(zd.participants);ae.addQueryData({members:be});if(zd.name)ae.addQueryData({name:zd.name});i.send(new j(ae));}}.bind(this));},_enableDesktopNotif:function(){Notification.requestPermission();},_reportSpamClicked:function(){var zd=this._getCanonicalUserID(),ae=ec('/ajax/chat/report.php').addQueryData({id:zd}).addQueryData({src:'top_report_link'});i.send(new j(ae));},_inputPasted:function(event){if(fc.chrome()){var zd=event.clipboardData||event.originalEvent.clipboardData;if(!zd||!zd.items||zd.items.length<1)return;var ae=zd.items[0].type;if(ae!=='image/png')return;if(zd.items[0].getAsFile){var be=zd.items[0].getAsFile();this._photoUploader.uploadFile(be);}}},_focusInput:function(){if(r.get('chat_react_input')){this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){ia.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._contextualDialogController&&this._contextualDialogController.tabFocused();if(!cd&&this._showPhotoNUXIfNecessary())g.subscribe(['ChatNUX/show','ChatNUX/hide'],function(event){cd=event==='ChatNUX/show';});this._closeMouseDown=false;this._setCloseTooltip(true);vd.inform('focus-tab',this._threadID);},_blurTab:function(){ia.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(zd){var ae=this._getNode('titlebarCloseButton'),be=zd?"\u0e01\u0e14 Esc \u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e1b\u0e34\u0e14":"\u0e1b\u0e34\u0e14\u0e41\u0e17\u0e47\u0e1a";cc.set(ae,be,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===va.RETURN&&!event.shiftKey){if(qd(this)){od(this);event.kill&&event.kill();return;}ld(this);if(qb.WebStickerTrigger)this._activateStickerTriggerAfterparty();event.kill&&event.kill();return;}if(event.keyCode===va.DOWN&&event.shiftKey&&this.hasEmptyInput()){vd.inform('lower-activated',this._threadID);event.kill&&event.kill();return;}this._handleHotkeyPressed(event);},_activateStickerTriggerAfterparty:function(){this._persistTrigger=true;clearTimeout(this._triggerTimeoutID);this._triggerTimeoutID=setTimeout(this._deactivateStickerTriggerAfterparty.bind(this),5000);},_deactivateStickerTriggerAfterparty:function(){clearTimeout(this._triggerTimeoutID);this._persistTrigger=false;this._userUsedTrigger=false;this._triggeredWord=null;this._setStickerTrigger(null);},_setStickerTrigger:function(zd){if(this._stickerTrigger&&this._stickerTrigger.isMounted())this._stickerTrigger.setProps({input:zd});},getTriggeredWord:function(){return this._triggeredWord;},isTriggerValid:function(){return !this._userUsedTrigger;},_inputChanged:function(zd){if(this._persistTrigger)this._deactivateStickerTriggerAfterparty();if(this.isTriggerValid())this._setStickerTrigger(zd);},_initializeInput:function(){if(!r.get('chat_react_input')){var zd=this._inputContainerNode.clientHeight;ac.getInstance(this._getNode('input')).subscribe('resize',function(){var ae=this._inputContainerNode.clientHeight;if(ae!=zd)this._nubController.flyoutContentChanged();zd=ae;}.bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(fc.firefox()&&ja.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else this._chatInput=mb.renderComponent(mb.createElement(t,{getTriggeredWordFn:this.getTriggeredWord.bind(this),initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputChanged:this._inputChanged.bind(this),inputKeyDown:this._inputKeyDown.bind(this),isTriggerValid:this.isTriggerValid.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),stickersFlyoutToggler:this._stickersFlyoutToggler,searchStickersFn:this._searchStickers.bind(this),resizeFn:this._nubController.flyoutContentChanged.bind(this._nubController),uploadPhotoFn:this._photoUploader.uploadFile}),this._getNode('chatInputContainer'));},_initializeThingsWithInputFn:function(zd,ae){this._shareLinkUploader=new y(this._tabTemplate.getNode('attachmentShelf'),zd,this.focus.bind(this),ae);this._initializeUploader(this._shareLinkUploader);yc.getThreadMeta(this._threadID,function(be){uc.getServerThreadID(this._threadID,function(ce){this._typingDetector=new dc(this._getCanonicalUserID(),zd,'mercury-chat',null,ce,ae);}.bind(this));}.bind(this));},_getInputValue:function(){if(r.get('chat_react_input')){return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},_hasUnfinishedPost:function(){return rd(this)||pd(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){vd.inform('read',this._threadID);return true;}return false;},_chatConvClicked:function(zd){this.tryMarkAsRead();if(ib.byTag(zd.getTarget(),'a')||ma.getSelection())return;this.focus();},_inputContainerClicked:function(zd){this.tryMarkAsRead();this.focus();},showTypingIndicator:function(zd){if(r.get('chat_closed_tab_typing_indicator_animated')){var ae=ma.find(this._tabElem,"._54m9");if(zd){this._animatedTypingIndicator=mb.renderComponent(mb.createElement(fb,null),ae);this._updateAnimatedIndicatorColor();ia.addClass(this._tabElem,"_54m8");ia.show(ae);}else{ia.removeClass(this._tabElem,"_54m8");ia.hide(ae);mb.unmountComponentAtNode(ae);this._animatedTypingIndicator=null;}}else ia.conditionClass(this._tabElem,'typing',zd);},_updateAnimatedIndicatorColor:function(){if(this._animatedTypingIndicator){var zd=ia.hasClass(this._tabElem,'highlightTab')?'light':'dark';this._animatedTypingIndicator.setProps({color:zd});}},_updateUnreadCount:function(zd){var ae=zd.unread_count;if(typeof ae!='undefined'){var be=!!ae&&(!q.showsTabUnreadUI||q.showsTabUnreadUI()),ce=this._getNode('numMessages');ia.conditionShow(ce,be);ia.conditionClass(this._tabElem,'highlightTab',be);this._updateAnimatedIndicatorColor();id(this._threadID,this._tabElem,be);ma.setContent(ce,ae);}},_updateCallLink:function(zd){var ae=this._getCanonicalUserID();if(ae===ha.getID()){this._hideVideoCallouts();if(r.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({shown:false});}else ia.hide(this._getNode('videoCallLink'));return;}if(da.isOnline()){var be='fbid:'+ae;bb.get(be,function(ce){var de=null;if(gc.availableForCall(ae)){de=rc._("\u0e40\u0e23\u0e34\u0e48\u0e21\u0e04\u0e38\u0e22\u0e41\u0e1a\u0e1a\u0e40\u0e2b\u0e47\u0e19\u0e2b\u0e19\u0e49\u0e32\u0e01\u0e31\u0e1a {firstname}",{firstname:ce.short_name});}else{de=rc._("{firstname} \u0e44\u0e21\u0e48\u0e1e\u0e23\u0e49\u0e2d\u0e21\u0e43\u0e0a\u0e49\u0e01\u0e32\u0e23\u0e04\u0e38\u0e22\u0e41\u0e1a\u0e1a\u0e40\u0e2b\u0e47\u0e19\u0e2b\u0e19\u0e49\u0e32\u0e43\u0e19\u0e02\u0e13\u0e30\u0e19\u0e35\u0e49",{firstname:ce.short_name});this._hideVideoCallouts();}this._setVideoCallTooltip(de);}.bind(this));}else{this._setVideoCallTooltip("\u0e04\u0e38\u0e13\u0e15\u0e49\u0e2d\u0e07\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e42\u0e17\u0e23");this._hideVideoCallouts();}},_setVideoCallTooltip:function(zd){if(r.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({tooltipLabel:zd});}else cc.set(this._getNode('videoCallLink'),zd);},_hideVideoCallouts:function(){this._contextualDialogController.hideVideoCallouts();},_updatePrivacyLink:function(zd){var ae;if(zd==w.OFFLINE){ae="\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c";if(r.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({privacyText:ae});}else ma.setContent(this._privacyLink,ae);return;}var be=this._getCanonicalUserID();if(!be)return;var ce='fbid:'+be;bb.get(ce,function(de){if(zd==w.BLOCKED){ae=rc._("\u0e40\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name}",{name:de.short_name});}else ae=rc._("\u0e1b\u0e34\u0e14\u0e01\u0e32\u0e23\u0e41\u0e0a\u0e17\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a {name}",{name:de.short_name});if(r.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({privacyText:ae});}else ma.setContent(this._privacyLink,ae);}.bind(this));},_unsubscribeToThread:function(){if(!yc.isEmptyLocalThread(this._threadID)){var zd=tc.constructLogMessageObject(cb.CHAT_WEB,this._threadID,ab.UNSUBSCRIBE,{removed_participants:[bb.user]});tc.sendMessage(zd);}vd.inform('unsubscribed',this._threadID);return true;},_initializeUploader:function(zd){this._subscriptionsHandler.addSubscriptions(zd.subscribe(['all-uploads-completed','upload-canceled'],function(){sd(this);}.bind(this)),zd.subscribe('dom-updated',function(){td(this);}.bind(this)),zd.subscribe('submit',function(){this._focusInput();}.bind(this)));},_initializeReactMenu:function(zd){var ae=this._getNode('menuContainer'),be=ya.isMultichat(this._threadID),ce=yc.isNewEmptyLocalThread(this._threadID),de=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(ae)this._reactChatTabMenu=mb.renderComponent(mb.createElement(aa,{onFileUploaderMounted:this.setFileUploader.bind(this),updatePrivacyLinkFunc:this._updatePrivacyLink.bind(this),nameConversationFunc:this._nameConversationLinkClicked.bind(this),showParticipantsFunc:this._showParticipantsClicked.bind(this),leaveConversationFunc:this._unsubscribeLinkClicked.bind(this),clearHistoryFunc:this._clearHistory.bind(this),reportSpamFunc:this._reportSpamClicked.bind(this),createGroupFunc:this._createGroupClicked.bind(this),isMultichat:be,isEmptyChat:ce,showAddFriend:de,threadID:this._threadID,attachmentsShelf:zd,onUploadFinished:sd.bind(this,this),onUpdateAttachmentsShelf:td.bind(this,this),onSubmit:this._focusInput.bind(this),enableDesktopNotif:function(){this._enableDesktopNotif();}.bind(this)}),ae);},_initializeArchiveWarning:function(){if(r.get('chat_react_header'))this._archiveWarning=mb.renderComponent(mb.createElement(p,{isFBAtWork:r.IsWorkUser,shown:true}),this._getNode('archiveContainer'));},_initializeAddToThreadButton:function(){if(r.get('chat_react_header')){this._addToThreadButton=mb.renderComponent(mb.createElement(o,{onClick:this._addFriendLinkClicked.bind(this),shown:true}),this._getNode('addToThreadContainer'));}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){if(!yc.getCanonicalUserInThread(this._threadID))return;var zd=null;if(r.get('chat_react_header')){this._videoCallButton=mb.renderComponent(mb.createElement(ea,{shown:true,onClick:this._callClicked.bind(this)}),this._getNode('videoCallButtonContainer'));zd=this._videoCallButton.getDOMNode();}else{zd=this._getNode('videoCallLink');this._listen('videoCallLink','click',this._callClicked,true);}this._contextualDialogController=new s(this._threadID,zd);},setFileUploader:function(zd){this._fileUploader=zd;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=mb.renderComponent(mb.createElement(v,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_handlePUSubmit:function(zd,ae){ud(this,jb.UPLOAD_START,ae);nd(this,'',[],function(be){if(this._threadID!==be.thread_id){this._newThreadIDFromPhotoUpload=be.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(be.thread_id);}be.content_attachment=null;tc.updateNewMessage(be,ae.upload_id,ae);tc.sendMessage(be);}.bind(this));this._focusInput();},_handlePULastUploadFailed:function(zd,ae){ud(this,jb.CLIENT_ERROR,ae);yd(ae);var be="\u0e01\u0e32\u0e23\u0e2d\u0e31\u0e1f\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e25\u0e49\u0e21\u0e40\u0e2b\u0e25\u0e27",ce="Please try again. Make sure you are uploading a valid photo.";new ka().setTitle(be).setBody(ce).setButtons(ka.OK).show();},_handlePULastUploadCanceled:function(zd,ae){ud(this,jb.CANCEL_DURING_UPLOAD,ae);yd(ae);},_handlePUAllUploadsCompleted:function(zd,ae){ud(this,jb.ALL_UPLOADS_DONE,ae);var be=tc.updateMessageAfterUpload(ae.upload_id,ae);tc.clearUploadedMessage(ae.upload_id);tc.sendMessage(be);var ce=ae.image_ids.length||ae.attachments.length;md(this,ce);},_stickerSelected:function(zd){nd(this,'',[],function(ae){ae.has_attachment=true;ae.sticker_id=zd;tc.sendMessage(ae);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(zd){var ae=qa.symbols[zd];if(!ae)return;if(r.get('chat_react_input')){this._chatInput.insertEmoticon(ae);return;}this._selectionPosition=this._selectionPosition||new ob(this._getNode('input'));var be=ac.getInstance(this._getNode('input')),ce=be.getValue(),de=ra.insertEmoticon(ae,ce,this._selectionPosition.getPos());be.setValue(de.result);this._selectionPosition.setPos(de.start,de.end);},_clearStickerSearchNUXIndicator:function(){ia.removeClass(this._getNode('emoticonIndicator'),'nux');},_orionTriggered:function(){nd(this,'',[],function(zd){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){ia.addClass(this._getNode('emoticonIndicator'),'nux');cd=false;},_clearStickerSearchNUXTooltip:function(){this._stickerSearchNUXTooltip&&this._stickerSearchNUXTooltip.hideNUX();},_onFlyoutShown:function(zd){if(r.get('chat_react_sticker_button')){var ae=this._stickersFlyout.props.packID;if(ae!==rb.SEARCH_PACK_ID)this.focus();}if(qb.WebStickerTrigger&&this._triggeredWord&&!this._userUsedTrigger){m.log('StickersLoggerConfig',{event:'sticker_trigger_activated',triggeredword:this._triggeredWord,triggerused:true});this._userUsedTrigger=true;this._searchStickers(this._triggeredWord,zd);this._setStickerTrigger(null);}else zd();this._stickersFlyoutShown=true;},_searchStickers:function(zd,ae){this._stickersFlyout.setProps({packID:rb.SEARCH_PACK_ID,trigger:zd},ae);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_onTriggerChanged:function(zd){this._triggeredWord=zd;this._chatInput.setProps({triggeredWord:zd});}});function yd(zd){var ae=tc.updateMessageAfterUpload(zd.upload_id,zd);tc.clearUploadedMessage(zd.upload_id);tc.deleteMessages(ae.thread_id,[ae.message_id]);tc.deleteLocalMessage(ae.thread_id);}e.exports=vd;},null);
__d("MercuryNotificationRenderer",["MercuryAssert","MercuryParticipants","tx","MercuryMessages","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){var j=b('MercuryMessages').get(),k=b('MercuryThreads').get();function l(m,n){g.isThreadID(m);k.getThreadMeta(m,function(o){j.getThreadMessagesRange(m,0,1,function(p){var q=p.length&&p[p.length-1];if(q&&q.author!=h.user){h.get(q.author,function(r){if(o.name){n(i._("{senderName} \u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e16\u0e36\u0e07 {groupName}",{senderName:r.short_name,groupName:o.name}));}else n(i._("{name} \u0e2a\u0e48\u0e07\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e16\u0e36\u0e07\u0e04\u0e38\u0e13",{name:r.short_name}));});}else n("\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e43\u0e2b\u0e21\u0e48");});});}e.exports={renderDocumentTitle:l};},null);
__d("ChatTitleBarBlinker",["ChatActivity","DocumentTitle","JSLogger","MercuryNotificationRenderer","PresenceState","MercuryThreadInformer","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryThreadInformer').get(),m=b('MercuryTimestampTracker').get(),n=i.create('chat_title'),o=null,p=0,q=false;function r(){if(o){o.stop();o=null;return true;}return false;}function s(x){var y=x||m.getLastUserMessageTimestamp();if(p<=y){p=y;if(r()||q)k.doSync();}}var t={blink:function(x,y){if(!o&&p<y)j.renderDocumentTitle(x,function(z){if(!o)o=h.blink(z);});},stopBlinking:function(){s();},blinkingElsewhere:function(){q=true;}};function u(x){var y=k.verifyNumber(x.sb2);if(!y||y<=p)return null;return y;}function v(x){var y=x&&u(x);if(y){p=y;n.debug('load',p);r();q=false;}}function w(x){var y=u(x);if(!y){n.debug('store',p);x.sb2=p;q=false;}return x;}k.registerStateStorer(w);k.registerStateLoader(v);l.subscribe('thread-read-changed',function(x,y){var z=m.getLastUserMessageTimestamp(),aa=0;for(var ba in y)if(y[ba].mark_as_read&&y[ba].timestamp>=z&&y[ba].timestamp>aa)aa=y[ba].timestamp;aa&&s(aa);});g.subscribe('activity',function(){s();});(function(){var x=k.getInitial();if(x)p=u(x)||0;})();e.exports=t;},null);
__d("ChatNewMessageHandler",["ArbiterMixin","ChatActivity","ChatMentionsNotifications","ChatTabModel","ChatTabView","JSLogger","MercuryAssert","MercuryBrowserAlerts","UserActivity","MercuryConfig","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=l.create('chat_new_message'),s={_raiseNewMessageTab:function(t,u){var v=j.getTab(t),w=false;if(v){w=v.raised;}else w=true;s.inform('chat/new-message-from-server',{thread_id:t});u.to_new_tab=!v;u.to_raised_tab=!!w;},_notify:function(t,u,v){if(p.DesktopNotificationsGK)i.notifyIfMessageToMe(u);var w=k.get(t);v.view_is_visible=w&&w.isVisible();v.view_is_focused=w&&w.isFocused();if(!v.view_is_visible)r.log('message_to_hidden');v.is_active=h.isActive();n.messageReceived(u);},newMessage:function(t,u,v){m.isThreadID(t);var w={thread_id:t,message_id:u.message_id};this._raiseNewMessageTab(t,w);this._notify(t,u,w);r.log('message',w);}};q(s,g);n.subscribe('before-alert',function(t,event){var u=event.threadID,v=k.get(u),w=j.getTab(u);if(w&&w.raised&&v&&v.isVisible()&&v.isFocused()&&o.isActive()){v.tryMarkAsRead();event.cancelAlert();}});e.exports=s;},null);
__d("ChatTabLRUManager",["ChatTabView","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={getLRUVisibleTab:function(k){if(k.hasRoomForRaisedTab())return undefined;var l=Object.keys(k.getTabsToShow()||{}),m=1*60,n=null,o=Infinity;for(var p=0;p<l.length;p++){var q=l[p],r=i.getThreadMetaNow(q);if(h.isTabPromoted(q))continue;if(!g.get(q).hasEmptyInput()||!r)continue;var s=(h.getServerTime()-r.timestamp)/1000;if(!r.timestamp||(r.timestamp&&r.timestamp<o&&s>m)){n=r.thread_id;o=r.timestamp;}}return n;}};e.exports=j;},null);
__d("ChatTabPolicy",["ChatBehavior","JSLogger","MercuryActionTypeConstants","MercuryLogMessageType","MercuryAssert","MercuryIDs","MercuryParticipants","MercuryParticipantTypes","MercurySourceType","MercuryThreadMode","MercuryThreadMuter","MessagingTag","PresencePrivacy","ShortProfiles","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b('MercuryUnseenState').get(),v=h.create('tab_policy');function w(x,y){u.markThreadSeen(x,y);}e.exports={messageIsAllowed:function(x,y,z){var aa=x.thread_id,ba=y.message_id;k.isThreadID(aa);k.isParticipantID(y.author);var ca;if(q.isThreadMuted(x)){ca={thread_id:aa,message_id:ba,mute_settings:x.mute_settings};v.log('message_thread_muted',ca);return;}if(x.mode==p.OBJECT_ORIGINATED){ca={thread_id:aa,message_id:ba,mode:x.mode};v.log('message_object_originated',ca);return;}if(y.source==o.EMAIL||y.source==o.TITAN_EMAIL_REPLY){ca={thread_id:aa,message_id:ba,source:y.source};v.log('message_source_not_allowed',ca);return;}var da=l.getUserIDFromParticipantID(y.author);if(!da){v.log('message_bad_author',{thread_id:aa,message_id:ba,user:da});return;}if(y.action_type!=i.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(y,x)){ca={thread_id:aa,message_id:ba,type:y.action_type};v.log('message_non_user_generated',ca);return;}if(x.is_canonical_user&&!g.notifiesUserMessages()){v.log('message_jabber',{thread_id:aa,message_id:ba});w(aa,true);return;}if(x.is_canonical&&!x.canonical_fbid){v.log('message_canonical_contact',{thread_id:aa,message_id:ba});return;}if(x.folder!=r.INBOX){v.log('message_folder',{thread_id:aa,message_id:ba,folder:x.folder});return;}var ea=l.getUserIDFromParticipantID(m.user);t.getMulti([da,ea],function(fa){if(!s.allows(da)){v.log('message_privacy',{thread_id:aa,message_id:ba,user:da});return;}var ga=fa[da].employee&&fa[ea].employee;if(!ga&&fa[da].type!==n.FRIEND){v.log('message_non_friend',{thread_id:aa,message_id:ba,user:da});return;}z();});},_messageIsNewlyCreatedGroup:function(x,y){return x.action_type===i.LOG_MESSAGE&&x.log_message_type===j.THREAD_NAME&&y.message_count===1;}};},null);
__d("ChatTabViewSelector",["Event","Arbiter","CSS","DataStore","DOM","MenuDeprecated","NubController","ChatTabTemplates","Toggler","copyProperties","MercuryThreadInformer","MercuryThreads","MercuryThreadMetadataRenderer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreadInformer').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadMetadataRenderer').get();function t(u){var v=n[':fb:chat:tab:selector'].build(),w=v.getRoot(),x=v.getNode('menu'),y=k.find(x,'.uiMenuInner'),z={},aa=new m().init(w);i.hide(w);k.insertBefore(u,w);function ba(ea){var fa=0;for(var ga in z){var ha=z[ga],ia=r.getThreadMetaNow(ga),ja=ha.getNode('unreadCount'),ka=(ia&&ia.unread_count)||0;fa+=ka;if(ka>9)ka='+';i.conditionClass(ja,'invisible_elem',!ka);k.setContent(ja,ka);}var la=v.getNode('numMessages');i.conditionShow(la,fa);k.setContent(la,fa);}this.setTabData=function(ea){z={};if(ea.length<1){i.hide(w);return;}i.show(w);k.empty(y);ea.forEach(function(fa){var ga=n[':fb:chat:tab:selector:item'].build();z[fa.id]=ga;var ha=ga.getNode('content');s.renderAndSeparatedParticipantList(fa.id,ha);k.prependContent(y,ga.getRoot());j.set(ga.getRoot(),'threadID',fa.id);var ia=ga.getNode('closeButton');g.listen(ia,'click',function(event){t.inform('selector/close-tab',fa.id);event.kill();});});aa.flyoutContentChanged();k.setContent(v.getNode('numTabs'),ea.length);ba();};function ca(event,ea){if(ea.menu!=x)return;var fa=j.get(ea.item,'threadID');t.inform('selected',fa);o.hide(w);}function da(event,ea){l.register(x);}l.subscribe('select',ca.bind(this));o.listen('show',w,function(){h.inform('layer_shown',{type:'ChatTabSelector'});da();});o.listen('hide',w,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});q.subscribe('threads-updated',ba);}p(t,new h());e.exports=t;},null);
__d("ChatTabController",["Arbiter","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabLRUManager","ChatTabMessagesView","ChatTabModel","ChatTabPolicy","ChatTabView","ChatTabViewSelector","JSLogger","MercuryConfig","MercuryIDs","MercuryParticipants","StickerState","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreads","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b('ChatTabPresence');b('ChatTypeaheadBehavior');var y=b('MercuryThreadInformer').get(),z=b('MercuryThreads').get(),aa=b('MercuryUnseenState').get(),ba=i.get('tab_auto_close_timeout')||7200000,ca=q.create('tab_controller');function da(ra){z.changeThreadReadStatus(ra,true);ea(ra);}function ea(ra){aa.markThreadSeen(ra);}function fa(ra,sa,ta){var ua=m.get().tabs;ra+=sa?1:-1;while(ra>=0&&ra<ua.length){var va=ua[ra],wa=o.get(va.id);if(wa&&wa.isVisible()&&(!ta||va.raised)){wa.focus();return true;}ra+=sa?1:-1;}return false;}function ga(ra,sa){var ta=sa&&sa.getRightmostHiddenTab();if(ta===ra)return null;return ta;}function ha(){return Math.floor(Math.random()*2147483648).toString(16);}function ia(ra,sa,ta,ua){m.raiseTab(ra,true,ta);var va=sa&&sa.getLeftmostVisibleTab(),wa=sa&&sa.getTabsToShow();if(wa&&!wa[ra]&&va){m.promoteThreadInPlaceOfThread(ra,va,ga(ra,sa),true);}else m.setPromotedTab(ra);g.inform('chat/open-tab',ra);var xa=o.get(ra);xa&&xa.focus();}function ja(ra,sa,ta){var ua=ta.forceDrop();if(!m.getTab(ra))m.raiseTab(ra,false);if(ua)return;var va=sa&&k.getLRUVisibleTab(sa),wa=sa&&sa.getTabsToShow();if(wa&&!wa[ra]&&va)m.promoteThreadInPlaceOfThread(ra,va,ga(ra,sa));}function ka(ra,sa){var ta=m.indexOf(ra);m.closeTab(ra,sa);return ta;}function la(ra,sa){j.subscribe('chat/new-message-from-server',function(bb,cb){ja(cb.thread_id,ra,sa);});p.subscribe('selected',function(bb,cb){ia(cb,ra);});g.subscribe('chat/tabs-order-changed',function(bb,cb){m.changeShowingTabs(cb);});g.subscribe('page_transition',function(bb,cb){m.closeFragileTabs();});g.subscribe('chat/close-all-tabs',function(){m.closeAllTabs();});g.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});g.subscribe('chat/close-chat-tab',function(bb,cb){m.closeTab(cb,'opened_group_thread');});o.subscribe('read',function(event,bb){da(bb);});h.subscribe('idle',function(bb,cb){if(cb>ba){var db=m.get().tabs;db.forEach(function(eb){var fb=eb.id;z.getThreadMeta(fb,function(gb){if(!gb.unread_count){ca.log('autoclose_idle_seen',{thread_id:fb,idleness:cb});m.closeTab(fb,'autoclose_idle_seen');}});});}});o.subscribe('nub-activated',function(bb,cb){ia(cb,ra);});o.subscribe('lower-activated',function(bb,cb){m.lowerTab(cb);var db=o.get(cb);db&&db.focus();});o.subscribe('focus-tab',function(bb,cb){var db=m.getTab(cb);if(db&&db.raised)ia(cb,ra,db.signatureID,true);});function ta(bb,cb){x.showOutgoingCallDialog(cb.userID,cb.clickSource);m.lowerTab(cb.threadID);}o.subscribe('video-call-clicked',ta);l.subscribe('video-call-clicked',ta);l.subscribe('interaction-with-tab',function(bb,cb){var db=m.getTab(cb);db&&db.raised&&ea(cb);});o.subscribe('closed-tab',function(bb,cb){ca.log('close_view',{thread_id:cb});ka(cb,'close_view');return false;});o.subscribe('thread-deleted',function(bb,cb){ca.log('close_thread_deleted',{thread_id:cb});ka(cb,'close_thread_deleted');return false;});o.subscribe('unsubscribed',function(bb,cb){ca.log('close_view_unsubscribed',{thread_id:cb});ka(cb,'close_view_unsubscribed');return false;});o.subscribe('esc-pressed',function(bb,cb){ca.log('close_esc',{thread_id:cb});var db=ka(cb,'close_esc');setTimeout(function(){fa(db-1,true,true)||fa(db,false,true);},0);});p.subscribe('selector/close-tab',function(bb,cb){ca.log('close_chat_from_selector',{thread_id:cb});ka(cb,'close_chat_from_selector');});y.subscribe('messages-received',function(bb,cb){for(var db in cb){var eb=cb[db];for(var fb=0;fb<eb.length;fb++){var gb=eb[fb];if(gb.author!=t.user){if(!gb.is_unread){ca.log('message_already_read',{action_id:gb.action_id,thread_id:gb.thread_id});continue;}z.getThreadMeta(db,function(hb){n.messageIsAllowed(hb,gb,function(){j.newMessage(db,gb,ra);});});}}}});y.subscribe('thread-read-changed',function(bb,cb){for(var db in cb)if(!cb[db].mark_as_read){ca.log('autoclose_marked_unread',{thread_id:db});m.closeTab(db,'autoclose_marked_unread');}});o.subscribe('tab-pressed',function(bb,cb){return !fa(m.indexOf(cb.id),cb.shiftPressed);});g.subscribe(q.DUMP_EVENT,function(bb,cb){cb.chat_controller={auto_close_timeout:ba};});this.openTab=function(bb,cb){ia(bb,cb,ha());};var ua,va,wa=[],xa=[],ya=[],za;if(u.shouldShowStickerSearchNUXTooltip()){ua=ra.getRightmostRaisedTab();if(ua){za=o.get(ua);za.showStickerSearchNUXTooltip();}else g.subscribeOnce('chat/open-tab',function(bb,cb){za=o.get(cb);za.showStickerSearchNUXTooltip();});}else if(r.ShowOrionNUXTooltip){wa=ra.getRaisedVisibleTabs();for(var ab=0;ab<wa.length;ab++){va=o.get(wa[ab]);if(va.isOrionNUXEligible())xa.push(va);}if(xa.length){ya=xa.map(function(bb){return bb.getParticipantIDForOrionNUX();});t.getMulti(ya,function(bb){for(var cb in bb)if(bb[cb].orion_eligible){za=xa.filter(function(db){return db._getCanonicalUserID()===s.getUserIDFromParticipantID(bb[cb].id);})[0];break;}if(za)za.showOrionNUXTooltip();});}}}if(w.firefox()){var ma=function(){return v.get(document.body,'overflowX')+' '+v.get(document.body,'overflowY');},na=ma(),oa=function(){var ra=ma();if(ra!==na){na=ra;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var pa=new MutationObserver(oa),qa={attributes:true,attributeFilter:['class','style']};pa.observe(document.documentElement,qa);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))oa();},false);}e.exports=la;},null);
__d("ChatTabViewCoordinator",["Arbiter","BanzaiODS","Bootloader","ChatTabModel","ChatTabView","ChatTabViewSelector","CSS","JSLogger","Style","Rect","VideoCallSupport","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=n.create('chat_tab_coordinator'),t,u;function v(w,x){var y=new l(w),z={},aa={},ba=false;function ca(){var oa=j.get(),pa={};oa.tabs.forEach(function(ra){pa[ra.id]=1;});s.log('process_tab_changed',{model_tabs:Object.keys(pa),view_tabs:Object.keys(z)});for(var qa in z)if(!pa[qa]){s.log('remove_tab',{tab_id:qa});z[qa].destroy();delete(z[qa]);}da(oa);ma(oa);if(oa.tabNeedsFocus&&!oa.tabNeedsFocus.isFocused())oa.tabNeedsFocus.focus();}function da(oa){var pa=null;oa.tabs.forEach(function(qa){var ra=qa.id,sa=false;if(!z[ra]){s.log('add_tab',{tab_id:ra});z[ra]=new k(ra,qa.server_id,qa.signatureID,w,pa);sa=true;}else z[ra].updateSignatureID(qa.signatureID);if(z[ra].isFocused())oa.tabNeedsFocus=z[ra];if(!sa&&!z[ra].nextTabIs(pa)){var ta=z[ra].getScrollTop();if(pa){z[ra].insertBefore(pa);}else z[ra].appendTo(w);if(ta)z[ra].setScrollTop(ta);}pa=z[ra];});}function ea(){var oa=x.getShowingTabsOrder();if(!oa||!oa.length)return;var pa=z[oa[0].id]._tabElem,qa=z[oa[oa.length-1].id]._tabElem,ra=parseInt(o.get(qa,'margin-left'),10)||0,sa=p.getElementBounds(qa).l-2*ra;sa=sa>0?sa:0;t&&t.setBoundingBox(new p(0,p.getElementBounds(pa).r,0,sa));}function fa(oa,pa){var qa=false;pa.forEach(function(ta){if(ta.raised){if(aa[ta.id]){qa=true;delete aa[ta.id];}}else if(!aa[ta.id]){qa=true;aa[ta.id]=true;}});if(qa)return true;if(!t)return true;var ra=ga()||[];if(ra.length!==oa.length)return true;for(var sa=0;sa<oa.length;sa++)if(ra[sa]!==oa[sa].id)return true;return false;}function ga(){var oa=t&&t.getOrder();oa&&oa.reverse();return oa;}function ha(){var oa=ga();if(oa){h.bumpEntityKey('chat.web','tab.drag_order_changed');g.inform('chat/tabs-order-changed',oa);}}function ia(oa,pa,qa){if(z[qa]._scrollTop!=null)z[qa].setScrollTop(z[qa]._scrollTop);}function ja(oa,pa){u=pa;z[pa]._isDragDropActive=true;z[pa]._scrollTop=z[pa].getScrollTop();o.set(z[pa]._tabElem,'z-index',1);ea();h.bumpEntityKey('chat.web','tab.drag_started');}function ka(oa){o.set(z[oa]._tabElem,'z-index','');if(z[oa]._scrollTop!=null)z[oa].setScrollTop(z[oa]._scrollTop);z[oa]._scrollTop=null;u=null;setTimeout(function(){z[oa]._isDragDropActive=false;},0);}function la(oa){i.loadModules(["SortableGroup"],function(pa){var qa=x.getShowingTabsOrder(),ra=fa(qa,oa);if(qa.length<=1){t&&t.removeAllSortables();return;}if(ra){if(t){t.removeAllSortables();}else t=new pa().setBeforeGrabCallback(ja).setDragOverCallback(ia).setDropCallback(ka).setOrderChangeHandler(ha).setUseScroller(false).setDragOverHorizontally();for(var sa=0;sa<qa.length;sa++){var ta=qa[sa];t.addSortable(ta.id,z[ta.id]._tabElem,aa[ta.id]?null:z[ta.id]._titlebar);}}});}function ma(oa){var pa=x.getTabsToShow(oa),qa=[],ra=false;oa.tabs.forEach(function(sa){if(!pa[sa.id]){z[sa.id].setVisibleState(false,sa.raised);qa.push(sa);}});oa.tabs.forEach(function(sa){if(pa[sa.id]){z[sa.id].setVisibleState(true,sa.raised);ra|=sa.raised;}});y.setTabData(qa);na(ra);la(oa.tabs);}function na(oa){if(!oa&&ba){g.inform('layer_hidden',{type:'ChatTab'});ba=false;}else if(oa&&!ba){g.inform('layer_shown',{type:'ChatTab'});ba=true;}}if(q.isVideoCallSupported())m.addClass(w,'videoCallEnabled');x.subscribe('tabs-changed',ca);ca();}r(v.prototype,{forceDrop:function(){if(t&&u){t.forceDrop(u);u=null;return true;}return false;}});e.exports=v;},null);
__d("MercuryStateCheck",["Arbiter","ChannelConstants","MercuryFolders","MessagingTag","URI","copyProperties","MercuryServerRequests"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=b('MercuryServerRequests').get(),n=l(new g(),{initialize:function(){g.subscribe(h.ON_INVALID_HISTORY,o);d(['ChannelConnection'],function(p){p.subscribe(p.CONNECTED,function(q,r){if(!r.init)o();});});}});function o(){var p;if(k.getRequestURI().getPath().search(/messages/)!==-1){p=i.getSupportedFolders();}else p=[j.INBOX];m.fetchMissedMessages(p);}n.initialize();e.exports=n;},null);
__d("ChatApp",["CSS","JSLogger"],function(a,b,c,d,e,f,g,h){var i={init:function(j,k,l){if(this._isInitialized){h.create('chat_app').error('repeated_init');return;}this._rootElem=j;d(['TabsViewport','ChatTabController','ChatTabViewCoordinator','MercuryServerRequests','MercuryChannelHandler','MercuryStateCheck'],function(m,n,o,p,q,r){q=q.get();q.turnOn();p.get().handleUpdate(l);this.tabsViewport=new m(k);this.tabViewCoordinator=new o(k,this.tabsViewport);this.tabController=new n(this.tabsViewport,this.tabViewCoordinator);this._isInitialized=this._isLoaded=true;}.bind(this));},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;g.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){g.show(this._rootElem);this.tabsViewport.checkWidth();d(['Dock'],function(j){j.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){d(['UIPagelet'],function(j){j.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');j.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};e.exports=i;},null);